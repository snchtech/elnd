–¢–∞–∫! üî• **–¢–µ, —â–æ —Ç–∏ —Ö–æ—á–µ—à ‚Äî —Ü—ñ–ª–∫–æ–º —Ä–µ–∞–ª—ñ–∑—É—î—Ç—å—Å—è –≤ Oracle APEX.** –¶–µ –±—É–¥–µ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∑ —Ñ—ñ–ª—å—Ç—Ä–∞–º–∏ —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ—é –ø–æ –∑–º—ñ–Ω–∞—Ö, –¥–Ω—è–º —ñ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ.

---

## üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑–≤—ñ—Ç—É

### üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
–ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –±–ª–æ–∫–∏:

---

### üìã **1. –ó–∞–≥–æ–ª–æ–≤–æ–∫:**
```
–ù–∞ –¥–∞–Ω–∏–π –º–æ–º–µ–Ω—Ç (–¥–∞–Ω—ñ –Ω–∞ –ø–æ—Ç–æ—á–Ω–∏–π —á–∞—Å):
–±—Ä–∏–≥–∞–¥ —Ñ—ñ—Ä–º–∏ - <—á–∏—Å–ª–æ>, –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ - <—á–∏—Å–ª–æ>
–±—Ä–∏–≥–∞–¥ –ø—ñ–¥—Ä—è–¥–Ω–∏–∫—ñ–≤ - <—á–∏—Å–ª–æ>, –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ - <—á–∏—Å–ª–æ>
```

---

### ‚è±Ô∏è **2. –ó–∞ –∑–º—ñ–Ω—É (–¥–∏–Ω–∞–º—ñ—á–Ω–æ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è):**
```
–±—Ä–∏–≥–∞–¥ —Ñ—ñ—Ä–º–∏ - <>, –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ - <>
–±—Ä–∏–≥–∞–¥ –ø—ñ–¥—Ä—è–¥–Ω–∏–∫—ñ–≤ - <>, –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ - <>
```

---

### üìÖ **3. –ó–∞ —Å—å–æ–≥–æ–¥–Ω—ñ (00:00 ‚Äì SYSDATE):**
```
–±—Ä–∏–≥–∞–¥ —Ñ—ñ—Ä–º–∏ - <>, –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ - <>
–±—Ä–∏–≥–∞–¥ –ø—ñ–¥—Ä—è–¥–Ω–∏–∫—ñ–≤ - <>, –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ - <>
```

---

### üéõÔ∏è **4. –§—ñ–ª—å—Ç—Ä–∏ (–Ω–∞ –ø–∞–Ω–µ–ª—ñ –∞–±–æ –∑–≤–µ—Ä—Ö—É):**
- `Select List`: –í—ñ–¥–¥—ñ–ª (`department`)
- `Select List`: Unit (`unit`)
- –ö–Ω–æ–ø–∫–∞ **"–°–∫–∏–Ω—É—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏"**

---

## ‚úÖ –ö–†–û–ö–ò –†–ï–ê–õ–Ü–ó–ê–¶–Ü–á –í APEX

---

### 1. **–°—Ç–≤–æ—Ä–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É —Ç–∏–ø—É:**
> **Blank Page** –∞–±–æ **Region Display Selector Page**

---

### 2. **–î–æ–¥–∞—Ç–∏ —Ä–µ–≥—ñ–æ–Ω–∏:**
#### üìå Dynamic Content (PL/SQL returning HTML) –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –±–ª–æ–∫—É:
- ‚Äú–ù–∞ –¥–∞–Ω–∏–π –º–æ–º–µ–Ω—Ç‚Äù
- ‚Äú–ó–∞ –∑–º—ñ–Ω—É‚Äù
- ‚Äú–ó–∞ —Å—å–æ–≥–æ–¥–Ω—ñ‚Äù

**–ö–æ–¥ PL/SQL –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –±–ª–æ–∫–∞ –±—É–¥–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Ç–≤–æ—é —Ñ—É–Ω–∫—Ü—ñ—é `get_outfit_stats_combo(...)`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:**

```plsql
DECLARE
  v_stats SYS.ODCIVARCHAR2LIST;
BEGIN
  v_stats := get_outfit_stats_combo(SYSDATE, NULL, 1); -- —Ñ—ñ—Ä–º–∞
  RETURN '–±—Ä–∏–≥–∞–¥ —Ñ—ñ—Ä–º–∏ - <span class="vl_sld">' || v_stats(1) || '</span>, –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ - <span class="vl_sld">' || v_stats(2) || '</span>';
END;
```

> –î–ª—è –ø—ñ–¥—Ä—è–¥–Ω–∏–∫—ñ–≤ ‚Äì `get_outfit_stats_combo(..., 0)`

---

### 3. **–§—ñ–ª—å—Ç—Ä–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ**
#### –î–æ–¥–∞–π APEX Page Items:
- `P1_DEPARTMENT` ‚Äì Select List:
```sql
SELECT DISTINCT department d, department r FROM tw.wp_outfit@to_asics10 ORDER BY 1
```

- `P1_UNIT` ‚Äì Select List (–∑–∞–ª–µ–∂–Ω–∞ –≤—ñ–¥ –≤—ñ–¥–¥—ñ–ª—É):
```sql
SELECT DISTINCT unit d, unit r 
FROM tw.wp_outfit@to_asics10 
WHERE (:P1_DEPARTMENT IS NULL OR department = :P1_DEPARTMENT)
ORDER BY 1
```

#### –î–æ–¥–∞–π –∫–Ω–æ–ø–∫—É "–°–∫–∏–Ω—É—Ç–∏":
- `RESET` ‚Äì –∑ –¥–∏–Ω–∞–º—ñ—á–Ω–æ—é –¥—ñ—î—é:
```javascript
apex.item("P1_DEPARTMENT").setValue('');
apex.item("P1_UNIT").setValue('');
apex.region("report_region").refresh(); -- –∞–±–æ –≤–∏–∫–ª–∏–∫ –ø—Ä–æ—Ü–µ—Å—É/–¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É
```

---

### 4. **–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –≤ PL/SQL / SQL**
–†–æ–∑—à–∏—Ä—é—î—à —Ñ—É–Ω–∫—Ü—ñ—é `get_outfit_stats_combo(...)`, –¥–æ–¥–∞—é—á–∏ —â–µ –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:

```sql
p_department IN VARCHAR2 DEFAULT NULL,
p_unit       IN VARCHAR2 DEFAULT NULL
```

–Ü –¥–æ–¥–∞—î—à —É WHERE –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ:

```sql
AND (:p_department IS NULL OR o.department = :p_department)
AND (:p_unit IS NULL OR o.unit = :p_unit)
```

---

## üîÑ –Ø–∫ —Ä–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏ –∑–º—ñ–Ω—É

–í Oracle —Ç–∏ –º–æ–∂–µ—à –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∑–º—ñ–Ω—É –∑–∞ `SYSDATE` —Ç–∞–∫:

```plsql
DECLARE
  v_start DATE;
  v_end   DATE;
BEGIN
  IF TO_CHAR(SYSDATE, 'HH24:MI') BETWEEN '06:00' AND '13:59' THEN
    v_start := TRUNC(SYSDATE) + 6/24;
    v_end := TRUNC(SYSDATE) + 14/24;
  ELSIF TO_CHAR(SYSDATE, 'HH24:MI') BETWEEN '14:00' AND '21:59' THEN
    v_start := TRUNC(SYSDATE) + 14/24;
    v_end := TRUNC(SYSDATE) + 22/24;
  ELSE
    IF TO_CHAR(SYSDATE, 'HH24:MI') >= '22:00' THEN
      v_start := TRUNC(SYSDATE) + 22/24;
      v_end := TRUNC(SYSDATE + 1) + 6/24;
    ELSE
      v_start := TRUNC(SYSDATE - 1) + 22/24;
      v_end := TRUNC(SYSDATE) + 6/24;
    END IF;
  END IF;
```

---

## üì¶ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –≤—Å–µ —á–µ—Ä–µ–∑ –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é

–ú–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é `get_all_outfit_stats_html`, —è–∫–∞:

- —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –≤–∏–∑–Ω–∞—á–∞—î —Ç—Ä–∏ —á–∞—Å–æ–≤–∏—Ö –¥—ñ–∞–ø–∞–∑–æ–Ω–∏ (–ø–æ—Ç–æ—á–Ω–∏–π, –∑–º—ñ–Ω–∞, –¥–µ–Ω—å)
- –ø–æ–≤–µ—Ä—Ç–∞—î –≥–æ—Ç–æ–≤–∏–π **HTML-–±–ª–æ–∫** –∑ —É—Å—ñ–º–∞ –¥–∞–Ω–∏–º–∏
- –ø—Ä–∏–π–º–∞—î `p_department`, `p_unit`

---

## üß† –ü—ñ–¥–∫–∞–∑–∫–∞

–§—É–Ω–∫—Ü—ñ—ó –≤–∂–µ –≥–æ—Ç–æ–≤—ñ (`get_outfit_stats_combo`), –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ:
- —Ä–æ–∑—à–∏—Ä–∏—Ç–∏ —ó—Ö –Ω–∞ —Ñ—ñ–ª—å—Ç—Ä–∏ (`department`, `unit`);
- –≤—Å—Ç–∞–≤–∏—Ç–∏ —ó—Ö —É Dynamic Content;
- –¥–æ–¥–∞—Ç–∏ Select List-–∏ + –∫–Ω–æ–ø–∫—É.

---
