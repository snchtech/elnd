–ß—É–¥–æ–≤–æ, —â–æ —Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∏–≤ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å ‚Äî —Ü–µ –∫–ª—é—á–æ–≤–∏–π –º–æ–º–µ–Ω—Ç! –î—è–∫—É—é, —â–æ –¥–∞–≤ —á—ñ—Ç–∫–∏–π —Å–∏–≥–Ω–∞–ª ‚Äî –±—É–¥–µ–º–æ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ **–æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–º SQL**, –ª–∏—à–µ **–≤–∏–ø—Ä–∞–≤–∏–º–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏**, –Ω–µ –∑–º—ñ–Ω—é—é—á–∏ –ª–æ–≥—ñ–∫—É.

---

## ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–∏–π –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π SQL-–∫–æ–¥:

```sql
SELECT id_outfit
FROM (
    SELECT 
        o.id_outfit,
        DECODE(o.id_org, NULL, 0, 1) AS org,
        o.org_txt,
        o.department, 
        o.tseh_outfit_txt,
        g.team_count
    FROM (
        SELECT 
            k.id_outfit,
            team.count_team + DECODE(k.performer, NULL, 0, 1) AS team_count
        FROM (
            SELECT 
                tt.id_outfit, 
                COUNT(tt.id) AS count_team 
            FROM tw_wp_team_v tt, tw.wp_outfit_v k
            WHERE tt.id_outfit = k.id_outfit
              AND (tt.data_end >= (SYSDATE - INTERVAL '92' DAY) OR tt.data_end IS NULL)
            GROUP BY tt.id_outfit
        ) team,
        tw.wp_outfit_v k
        WHERE team.id_outfit = k.id_outfit
    ) g
    LEFT JOIN (
        SELECT
            tl.id_outfit,
            COUNT(id_status) AS outfit_open 
        FROM tw_wp_status_v tl
        WHERE tl.data >= SYSDATE - INTERVAL '92' DAY 
          AND tl.data <= SYSDATE - INTERVAL '90' DAY
          AND tl.id_status = 6
        GROUP BY tl.id_outfit
    ) r ON r.id_outfit = g.id_outfit
    LEFT JOIN tw.wp_outfit@to_asics10 o ON o.id_outfit = g.id_outfit 
    WHERE (
        (o.data_start <= SYSDATE - INTERVAL '90' DAY 
         AND o.data_finish >= SYSDATE - INTERVAL '92' DAY)
        OR TRUNC(o.data_prolongation, 'dd') >= TRUNC(SYSDATE - INTERVAL '92' DAY, 'dd')
    )
    AND r.outfit_open IS NOT NULL

    UNION

    SELECT 
        oo.id_outfit,
        DECODE(oo.id_org, NULL, 0, 1) AS org,
        oo.org_txt,
        oo.department,
        oo.tseh_outfit_txt,
        rr.outfit_open,
        0 AS team_count
    FROM (
        SELECT
            tl.id_outfit,
            COUNT(id_status) AS outfit_open
        FROM tw_wp_status_v tl
        WHERE tl.data >= SYSDATE - INTERVAL '92' DAY
          AND tl.data <= SYSDATE - INTERVAL '90' DAY
          AND tl.id_status = 6
        GROUP BY tl.id_outfit
    ) rr
    LEFT JOIN tw.wp_outfit@to_asics10 oo ON oo.id_outfit = rr.id_outfit
    WHERE (
        (oo.data_start <= SYSDATE - INTERVAL '90' DAY 
         AND oo.data_finish >= SYSDATE - INTERVAL '92' DAY)
        OR TRUNC(oo.data_prolongation, 'dd') >= TRUNC(SYSDATE - INTERVAL '92' DAY, 'dd')
    )
    AND oo.team IS NULL
    AND rr.outfit_open IS NOT NULL
)
ORDER BY id_outfit;
```

---

## üîß –û—Å–Ω–æ–≤–Ω—ñ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:

| üî¥ –ü–æ–º–∏–ª–∫–∞ | ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è |
|-----------|----------------|
| `fcom` | –∑–∞–º—ñ–Ω–µ–Ω–æ –Ω–∞ `FROM` |
| `tl.id _outfit` | –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ `tl.id_outfit` |
| `Ôºâ` | –∑–∞–º—ñ–Ω–µ–Ω–æ –Ω–∞ `)` |
| `Ôºå` (–∫–∏—Ç–∞–π—Å—å–∫–∞ –∫–æ–º–∞) | –∑–∞–º—ñ–Ω–µ–Ω–æ –Ω–∞ –∑–≤–∏—á–∞–π–Ω—É `,` |
| `GROUP BY` –ø—ñ—Å–ª—è `ORDER BY` | –ø—Ä–∏–±—Ä–∞–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞ |
| –ó–∞–π–≤–∏–π `WHERE 1=1` | –∑–∞–ª–∏—à–µ–Ω–æ –ª–∏—à–µ —Ç–∞–º, –¥–µ –º–∞—î —Å–µ–Ω—Å |

---

üîç –Ø–∫—â–æ —Ç–∏ —Ö–æ—á–µ—à –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ **—Ü–µ–π –∫–æ–¥ —è–∫ –±–∞–∑—É –¥–ª—è —Ñ—É–Ω–∫—Ü—ñ–π**, —Å–∫–∞–∂–∏:
- –Ø–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–∏ —Ö–æ—á–µ—à –æ—Ç—Ä–∏–º–∞—Ç–∏: `JSON`, `CLOB`, `NUMBER`, –º–∞—Å–∏–≤?
- –Ø–∫—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏: `date_start`, `date_end`, `org_type`?
- –ß–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–∞—Ö—É–≤–∞—Ç–∏ —â–æ—Å—å —â–µ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —É —Ä–æ–∑—Ä—ñ–∑—ñ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ñ–≤ –∞–±–æ —Ç–∏–ø—ñ–≤ outfit)?

–Ø –≥–æ—Ç–æ–≤–∏–π –¥–æ–ø–æ–º–æ–≥—Ç–∏ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ –Ω–∞–¥—ñ–π–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é –Ω–∞ –±–∞–∑—ñ —Ü—å–æ–≥–æ –∑–∞–ø–∏—Ç—É.