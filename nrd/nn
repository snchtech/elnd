Щоб реалізувати такий звіт в Oracle APEX, потрібно буде зробити кілька кроків для налаштування вашої візуалізації та функціональності фільтрації. Ось як можна це організувати:

### Крок 1: Оновлення SQL-запиту
Для того щоб організувати ваш звіт так, як ви описали, потрібно розширити SQL-запит, додавши відповідні підзапити для розрахунку кількості бригад і людей фірм та підрядників, а також додати фільтрацію по відділу. Ось як можна адаптувати ваш запит для такого звіту:

```sql
SELECT
    id_outfit,
    CASE 
        WHEN unit_type = 'Зараз' THEN '1'
        WHEN unit_type = 'З початку доби' THEN '2'
        WHEN unit_type = 'З початку зміни' THEN '3'
    END AS time_period,
    unit_type,
    org_type,
    COUNT(*) AS count
FROM (
    SELECT
        o.id_outfit,
        DECODE(o.id_org, NULL, 0, 1) AS org_type,
        'Зараз' AS unit_type,  -- додано фіксоване значення
        o.department
    FROM
        tw.wp_outfit@to_asics10 o
    WHERE
        o.data_start <= SYSDATE - INTERVAL '90' DAY
        AND o.data_finish >= SYSDATE - INTERVAL '92' DAY
    UNION ALL
    SELECT
        o.id_outfit,
        DECODE(o.id_org, NULL, 0, 1) AS org_type,
        'З початку доби' AS unit_type,  -- додано фіксоване значення
        o.department
    FROM
        tw.wp_outfit@to_asics10 o
    WHERE
        TRUNC(o.data_prolongation, 'dd') >= TRUNC(SYSDATE - INTERVAL '92' DAY, 'dd')
    UNION ALL
    SELECT
        o.id_outfit,
        DECODE(o.id_org, NULL, 0, 1) AS org_type,
        'З початку зміни' AS unit_type,  -- додано фіксоване значення
        o.department
    FROM
        tw.wp_outfit@to_asics10 o
    WHERE
        o.data_prolongation >= (SYSDATE - INTERVAL '92' DAY)
)
GROUP BY
    id_outfit, time_period, unit_type, org_type, department
ORDER BY
    id_outfit, time_period;
```

### Крок 2: Налаштування звіту в Oracle APEX

1. **Створення звіту:**
   - Перейдіть до вашого додатку в Oracle APEX.
   - Додайте новий звіт (Report) та виберіть "Interactive Report" або "Classic Report" в залежності від ваших вимог.
   - В якості джерела даних виберіть SQL-запит, який ви тільки що підготували.

2. **Додавання фільтру по відділу:**
   - В розділі "Attributes" для вашого звіту додайте фільтр для колонки `department`, використовуючи "Dynamic Actions".
   - Налаштуйте динамічні дії так, щоб вони застосовували фільтрацію по обраному значенню відділу.

3. **Створення заголовків і групування даних:**
   - В Oracle APEX, для групування результатів в залежності від періоду часу (Зараз, З початку доби, З початку зміни) і типу організації (фірма/підрядник), вам треба використовувати функціональність групування в інтерактивному звіті або ж налаштувати відповідні розділи в Classic Report.
   - Для кожного "часового періоду" потрібно додати окремі рядки та значення, що виводяться згідно з вашими вимогами (наприклад, "Бригад фірми", "Людей підрядників" тощо).

4. **Інтерактивність звіту:**
   - Для забезпечення фільтрації по відділах через чекбокси, додайте селектори типу "Checkbox" для вибору відділів.
   - Для кожного з цих селекторів налаштуйте фільтрацію таким чином, щоб при виборі певного відділу, звіт автоматично оновлювався з урахуванням вибраного відділу.

### Крок 3: Візуалізація

1. **Налаштування стовпців:**
   - Важливо, щоб ваш звіт мав колонки в такому форматі:
     - Колонка 1: Зараз, З початку доби, З початку зміни
     - Колонка 2: Бригад фірми, Бригад підрядників, Людей фірми, Людей підрядників
     - Колонка 3: Unit 1 (можна додавати дані по кожному підрозділу в колонці)

2. **Персоналізація підрахунків та рядків:**
   - Для кожної групи даних (наприклад, "Бригад фірми", "Бригад підрядників") зробіть підрахунки кількості записів. Ви можете це реалізувати через підзапити або зведення даних безпосередньо в APEX через функції сумування/підрахунку.

### Крок 4: Підсумкові розрахунки

Щоб підраховувати сумарні значення для кожного відділу та підрозділу (наприклад, загальна кількість бригад для фірм та підрядників), можна додати додаткові функції або підсумкові стовпці для агрегації даних на рівні звіту.

### Крок 5: Створення зв'язків

Не забудьте налаштувати зв'язки між таблицями в APEX для відображення всіх даних, щоб можна було здійснити правильну фільтрацію.

### Висновок

Загалом, ваш звіт буде складатися з декількох частин:
- Зміни часу (Зараз, З початку доби, З початку зміни).
- Перелік типів бригад (фірма, підрядники).
- Підсумкові підрахунки по кожному типу.

Користувачі зможуть фільтрувати дані за відділами та переглядати кількість бригад чи людей для кожного підрозділу за обраний час.

Така структура дозволить вам візуалізувати всі необхідні дані за допомогою Oracle APEX та забезпечити зручну фільтрацію та агрегацію.