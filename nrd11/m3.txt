–©–æ–± —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **master-detail –∑–≤—ñ—Ç** —É Oracle APEX, –¥–µ –ø—Ä–∏ –∫–ª—ñ–∫—É –Ω–∞ `department` –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∑–≤—ñ—Ç—ñ (master) –≤–Ω–∏–∑—É –∑‚Äô—è–≤–ª—è—î—Ç—å—Å—è –¥–µ—Ç–∞–ª—å (detail) –ø–æ `performer_department_id`, –≤–∏–∫–æ–Ω–∞–π –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:

---

## üîß **–ö—Ä–æ–∫–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Master-Detail Interactive Report**

### **1. –°—Ç–≤–æ—Ä–∏—Ç–∏ –¥–≤–∞ –∑–≤—ñ—Ç–∏ –Ω–∞ –æ–¥–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ**

* **Master Report** ‚Äì –ø–æ `department` (–æ—Å–Ω–æ–≤–Ω–∏–π –∑–≤—ñ—Ç).
* **Detail Report** ‚Äì –ø–æ `performer_department_id` (–¥–µ—Ç–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç).

---

### **2. SQL-–∑–∞–ø–∏—Ç–∏ –¥–ª—è –∑–≤—ñ—Ç—ñ–≤**

#### ‚úÖ Master Report (IR –∞–±–æ Classic Report):

```sql
SELECT DISTINCT
  department,
  SUM(total_people) AS total_people,
  SUM(total_brigades) AS total_brigades
FROM v_outfit_pivot_base
GROUP BY department
ORDER BY department
```

#### ‚úÖ Detail Report (IR –∞–±–æ Classic Report):

```sql
SELECT
  p.department AS performer_department,
  d.depart_short_name,
  v.unit,
  SUM(v.total_people) AS total_people,
  SUM(v.total_brigades) AS total_brigades
FROM v_outfit_pivot_base v
JOIN users u ON u.id = v.performer_id
JOIN departments d ON d.id = u.performer_department_id
JOIN departments p ON p.id = u.performer_department_id
WHERE v.department = :PXX_SELECTED_DEPARTMENT
GROUP BY p.department, d.depart_short_name, v.unit
ORDER BY p.department, v.unit
```

> üî∏ `:PXX_SELECTED_DEPARTMENT` ‚Äî —Ü–µ **–ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π item** –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ, –≤ —è–∫–∏–π –∑–∞–ø–∏—Å—É—î—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–Ω—è –∑ –º–∞–π—Å—Ç–µ—Ä-–∑–≤—ñ—Ç—É.

---

### **3. –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π item `PXX_SELECTED_DEPARTMENT`**

* –¢–∏–ø: Hidden
* –ó–Ω–∞—á–µ–Ω–Ω—è: –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ —á–µ—Ä–µ–∑ Dynamic Action

---

### **4. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ Dynamic Action –Ω–∞ master-–∑–≤—ñ—Ç**

* **–ü–æ–¥—ñ—è**: `Click` (–∞–±–æ `Selection Change [Interactive Report]`)

* **Selection Type**: `Region`

* **Region**: master-–∑–≤—ñ—Ç

* **True Action 1**: `Set Value`

  * **Set Type**: `Static Assignment` ‚Üí `JavaScript Expression`
  * **Value**:

    ```js
    this.triggeringElement.innerText
    ```

    (–∞–±–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑ –ø–æ—Ç—Ä—ñ–±–Ω–æ—ó –∫–ª—ñ—Ç–∏–Ω–∫–∏ —á–µ—Ä–µ–∑ JS)
  * **Set Item(s)**: `PXX_SELECTED_DEPARTMENT`

* **True Action 2**: `Refresh`

  * **Affected Element**: Detail –∑–≤—ñ—Ç

---

### **5. –û–ø—Ü—ñ–π–Ω–æ: –î–æ–¥–∞—Ç–∏ —É–º–æ–≤–Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è Detail-–∑–≤—ñ—Ç—É**

* –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ `Server Condition` –∞–±–æ —á–µ—Ä–µ–∑ `Client-side Condition`, —â–æ–± –¥–µ—Ç–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç –Ω–µ –ø–æ–∫–∞–∑—É–≤–∞–≤—Å—è –¥–æ –≤–∏–±–æ—Ä—É –∑ master.

---

### **6. UI –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è (–æ–ø—Ü—ñ–π–Ω–æ)**:

* –î–æ–¥–∞—Ç–∏ —ñ–∫–æ–Ω–∫—É ‚ñº —á–∏ –ø–∞–Ω–µ–ª—å —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è/–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –¥–ª—è –≤—ñ–∑—É–∞–ª—å–Ω–æ–≥–æ –µ—Ñ–µ–∫—Ç—É.
* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Cards –∞–±–æ Inline Dialog (—è–∫—â–æ —Ö–æ—á–µ—à –±—ñ–ª—å—à–µ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤—É).

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –Ω–∞ `department` –≤ master-–∑–≤—ñ—Ç—ñ:

* –£ hidden item –∑–∞–ø–∏—Å—É—î—Ç—å—Å—è –æ–±—Ä–∞–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è.
* Detail –∑–≤—ñ—Ç –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è —ñ –ø–æ–∫–∞–∑—É—î –¥–∞–Ω—ñ –ø–æ `performer_department_id`.

---

–•–æ—á–µ—à, —è –∑–≥–µ–Ω–µ—Ä—É—é –ø—Ä–∏–∫–ª–∞–¥ HTML+JS, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–±–æ –∑ –∫–∞—Ä—Ç–∫–∞–º–∏?
