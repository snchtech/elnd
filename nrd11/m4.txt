–û—Å—å —è–∫ **—Ä–æ–∑–±–∏—Ç–∏ master‚Äìdetail –ª–æ–≥—ñ–∫—É –Ω–∞ –¥–≤–∞ –æ–∫—Ä–µ–º—ñ –∑–≤—ñ—Ç–∏** –≤ Oracle APEX:

---

## ‚úÖ **–°—Ü–µ–Ω–∞—Ä—ñ–π**

* ‚úÖ –ü–µ—Ä—à–∏–π –∑–≤—ñ—Ç ("**Master**") –ø–æ–∫–∞–∑—É—î —Å–ø–∏—Å–æ–∫ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—ñ–≤ `department` –∑ —Å—É–º–∞—Ä–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏.
* ‚úÖ –î—Ä—É–≥–∏–π –∑–≤—ñ—Ç ("**Detail**") –ø–æ–∫–∞–∑—É—î `performer_department_id` —Ç—ñ–ª—å–∫–∏ –¥–ª—è –≤–∏–±—Ä–∞–Ω–æ–≥–æ `department`.
* ‚úÖ –í–∑–∞—î–º–æ–¥—ñ—è —á–µ—Ä–µ–∑ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π `item`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `P_DEPARTMENT_SELECTED`.

---

## üîß **1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–∏–ø                 | –Ü–º'—è / ID               |
| --------- | ------------------- | ----------------------- |
| –ó–≤—ñ—Ç 1    | IR / Classic Report | `Master_Report`         |
| –ó–≤—ñ—Ç 2    | IR / Classic Report | `Detail_Report`         |
| Item      | Hidden              | `P_DEPARTMENT_SELECTED` |

---

## üìÑ **SQL –¥–ª—è Master Report** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Classic Report)

```sql
SELECT
  department,
  SUM(total_people) AS total_people,
  SUM(total_brigades) AS total_brigades
FROM v_outfit_pivot_base
GROUP BY department
ORDER BY department
```

> –ú–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∫–æ–ª–æ–Ω–∫—É `department` –∫–ª—ñ–∫–∞–±–µ–ª—å–Ω–æ—é –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º.

---

## üìÑ **SQL –¥–ª—è Detail Report**

```sql
SELECT
  d.depart_short_name AS performer_department_name,
  v.unit,
  SUM(v.total_people) AS total_people,
  SUM(v.total_brigades) AS total_brigades
FROM v_outfit_pivot_base v
JOIN users u ON u.id = v.performer_id
JOIN departments d ON d.id = u.performer_department_id
WHERE v.department = :P_DEPARTMENT_SELECTED
GROUP BY d.depart_short_name, v.unit
ORDER BY d.depart_short_name, v.unit
```

---

## ‚öôÔ∏è **Dynamic Action –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó**

1. **–ü–æ–¥—ñ—è**: `Click` –∞–±–æ `Link Clicked` —É Master-–∑–≤—ñ—Ç—ñ.

2. **True Action #1**:
   **Set Value ‚Üí JavaScript Expression**

   ```js
   this.triggeringElement.innerText
   ```

   –∞–±–æ –∑ –ø–æ—Ç—Ä—ñ–±–Ω–æ—ó `td`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:

   ```js
   $(this.triggeringElement).closest('tr').find('td:eq(0)').text()
   ```

   ‚Üí Set Item = `P_DEPARTMENT_SELECTED`.

3. **True Action #2**:
   **Refresh ‚Üí Detail\_Report**

---

## üí° **–Ø–∫ –∑—Ä–æ–±–∏—Ç–∏ –∫–æ–ª–æ–Ω–∫—É –∫–ª—ñ–∫–∞–±–µ–ª—å–Ω–æ—é (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)**

–Ø–∫—â–æ —Ü–µ Classic Report ‚Üí –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π HTML Expression —É –∫–æ–ª–æ–Ω—Ü—ñ `department`:

```sql
SELECT
  '<a href="javascript:void(0);" class="dep-link">' || department || '</a>' AS department,
  SUM(total_people) AS total_people,
  SUM(total_brigades) AS total_brigades
FROM ...
```

–¢–æ–¥—ñ –≤ DA –ø–æ–¥—ñ—è: `Click` ‚Üí jQuery Selector: `.dep-link`

---

## ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**

* –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∫–ª—ñ–∫–∞—î –Ω–∞ –∑–∞–ø–∏—Å —É Master-–∑–≤—ñ—Ç—ñ.
* –£ hidden item –∑–∞–ø–∏—Å—É—î—Ç—å—Å—è –≤–∏–±—Ä–∞–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è.
* –î–µ—Ç–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è.

---

–•–æ—á–µ—à, —â–æ–± —è –ø–æ–∫–∞–∑–∞–≤ —Ü–µ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–∞—Ä—Ç–æ–∫ (APEX Cards) –∞–±–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è–º –Ω–∏–∂—á–µ –æ–±—Ä–∞–Ω–æ–≥–æ —Ä—è–¥–∫–∞?
