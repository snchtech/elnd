–¢–∞–∫, **–º–æ–∂–µ –±—É—Ç–∏ –∫—ñ–ª—å–∫–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º**, —è–∫—â–æ —Ç–∏ –≤—Å—Ç–∞–≤–∏—à —Ü–µ–π SQL-–∫–æ–¥ **–Ω–∞–ø—Ä—è–º—É —É –∑–≤—ñ—Ç (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Interactive Report –∞–±–æ Classic Report)**:

---

### ‚ö† –ú–æ–∂–ª–∏–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏:

#### 1. **–ü–æ–º–∏–ª–∫–∞ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó SQL**

–Ø–∫—â–æ –±—É–¥—å-—è–∫–∏–π –∑ `:P0_CURRENT_DEPARTMENT`, `:P_TIME_MODE`, `:P_TIME_START`, `:P_TIME_END` **–Ω–µ —ñ—Å–Ω—É—î —è–∫ item –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ**, —Ç–æ –ø—ñ–¥ —á–∞—Å –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∑–≤—ñ—Ç—É –±—É–¥–µ:

> ORA-06502: PL/SQL: numeric or value error
> ORA-01403: no data found

üëâ **–†—ñ—à–µ–Ω–Ω—è**: –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ –≤—Å—ñ —Ü—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ —î –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ.

---

#### 2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–µ –µ–∫—Ä–∞–Ω—É–≤–∞–Ω–Ω—è –ª–∞–ø–æ–∫ —É HTML/JS**

–¶–µ —á–∞—Å—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞, –±–æ Oracle SQL + JavaScript + HTML + APEX —É –∑–≤—ñ—Ç—ñ ‚Äî —Ü–µ –≤–∏–±—É—Ö–æ–≤–∞ —Å—É–º—ñ—à.

**–¶–µ–π —Ä—è–¥–æ–∫:**

```sql
|| NVL(TO_CHAR(:P_TIME_START, 'YYYY-MM-DD"T"HH24:MI:SS'), '')
```

üõë –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **–ø–æ–¥–≤—ñ–π–Ω—ñ –ª–∞–ø–∫–∏ `"` —É —à–∞–±–ª–æ–Ω—ñ –¥–∞—Ç–∏**, —è–∫—ñ –º–æ–∂—É—Ç—å –ø–æ—Ä—É—à–∏—Ç–∏ HTML-–∞—Ç—Ä–∏–±—É—Ç –∞–±–æ JS-–≤–∏–∫–ª–∏–∫.

üëâ **–†—ñ—à–µ–Ω–Ω—è**: –ó–∞–º—ñ–Ω–∏ `"T"` –Ω–∞ `'T'`, –∞–±–æ –≤–∑–∞–≥–∞–ª—ñ –∫—Ä–∞—â–µ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π `"T"` —É —Ñ–æ—Ä–º–∞—Ç—ñ –¥–∞—Ç–∏, –∞–±–æ –∫–æ–¥—É–π –≤—Ä—É—á–Ω—É –≤ JS.

---

#### 3. **NULL-–∑–Ω–∞—á–µ–Ω–Ω—è item'—ñ–≤**

–Ø–∫—â–æ –±—É–¥—å-—è–∫–µ –∑ `:P_TIME_MODE`, `:P_TIME_START`, `:P_TIME_END` —î `NULL`, —Ç–æ —Ä—è–¥–æ–∫ `openDetail(...)` –æ—Ç—Ä–∏–º–∞—î `,,` ‚Üí —â–æ —Ç–µ–∂ **–º–æ–∂–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ JS-–ø–æ–º–∏–ª–∫—É**.

üëâ **–†—ñ—à–µ–Ω–Ω—è**:

* –í JS-—Ñ—É–Ω–∫—Ü—ñ—ó `openDetail(...)` —Ä–æ–±–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É `if (value)` –ø–µ—Ä–µ–¥ –≤–∏–∫–ª–∏–∫–æ–º.
* –ê–±–æ –∑–∞–±–µ–∑–ø–µ—á –∑–Ω–∞—á–µ–Ω–Ω—è —á–µ—Ä–µ–∑ `NVL`.

---

### ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –≤–µ—Ä—Å—ñ—è –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ —É SQL-–∑–≤—ñ—Ç:

```sql
'<a href="javascript:void(0);" onclick="openDetail(''' 
|| REPLACE(NVL(:P0_CURRENT_DEPARTMENT, department), '''', '') || ''','''
|| NVL(:P_TIME_MODE, '') || ''','''
|| NVL(TO_CHAR(:P_TIME_START, 'YYYY-MM-DD HH24:MI:SS'), '') || ''','''
|| NVL(TO_CHAR(:P_TIME_END, 'YYYY-MM-DD HH24:MI:SS'), '') || ''')">'
|| '<span class="fa fa-search-plus" title="–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –¥–µ—Ç–∞–ª—ñ"></span></a>' AS view_icon
```

---

### üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ‚Äî –í–∏–Ω–æ—Å –ª–æ–≥—ñ–∫–∏ –≤ PL/SQL Function:

–î–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ –π –±–µ–∑–ø–µ—á–Ω–æ–≥–æ –µ–∫—Ä–∞–Ω—É–≤–∞–Ω–Ω—è, –º–æ–∂–Ω–∞ –≤–∏–Ω–µ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é HTML –≤ —Ñ—É–Ω–∫—Ü—ñ—é:

```plsql
FUNCTION gen_view_icon(p_department, p_mode, p_start, p_end) RETURN VARCHAR2
```

---

üîß **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**:
‚úÖ –Ø–∫—â–æ —Ç–∏ –≤—Å–µ –∂ —Ö–æ—á–µ—à –≤—Å—Ç–∞–≤–ª—è—Ç–∏ HTML –Ω–∞–ø—Ä—è–º—É –≤ SQL-–∑–≤—ñ—Ç, –¥–æ–¥–∞–π `escape = No` —É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö —Ü—ñ—î—ó –∫–æ–ª–æ–Ω–∫–∏ (–≤ APEX), —ñ –∑–∞–≤–∂–¥–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è–π –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å –µ–∫—Ä–∞–Ω—É–≤–∞–Ω–Ω—è `'` —ñ `"`.

–•–æ—á–µ—à ‚Äî –º–æ–∂—É –ø–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥ —Ç–∞–∫–æ—ó `gen_view_icon` PL/SQL-—Ñ—É–Ω–∫—Ü—ñ—ó.
