–û–∫–µ–π ‚úÖ –ó–≥—ñ–¥–Ω–æ —Ç–≤–æ—î—ó view, —Å—Ç–≤–æ—Ä—é—î–º–æ **PL/SQL-—Ñ—É–Ω–∫—Ü—ñ—é**, —è–∫–∞ –ø—Ä–∏–π–º–∞—î:
- `p_unit` ‚Äî –Ω–æ–º–µ—Ä —é–Ω—ñ—Ç–∞ (0, 1, 2)
- `p_departments` ‚Äî —Å–ø–∏—Å–æ–∫ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—ñ–≤ (`'DEP1:DEP2'`), –∞–ª–µ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –æ–±—Ä–æ–±–ª—è—î –≤—Å—ñ

---

## üìå –§–æ—Ä–º–∞—Ç HTML-–≤–∏–≤–æ–¥—É:
```
–ü–æ Unit: 1  
100 –±—Ä–∏–≥–∞–¥ –§—ñ—Ä–º–∞, 20 –ü—ñ–¥—Ä—è–¥–Ω–∏–∫–∏  
1000 —á–æ–ª. –§—ñ—Ä–º–∞, 50 –ü—ñ–¥—Ä—è–¥–Ω–∏–∫–∏
```

---

## ‚úÖ –§—É–Ω–∫—Ü—ñ—è `get_unit_quick_stats`

```plsql
CREATE OR REPLACE FUNCTION get_unit_quick_stats (
    p_unit IN NUMBER,
    p_departments IN VARCHAR2 DEFAULT NULL -- 'DEP1:DEP2'
) RETURN CLOB IS
    v_html        CLOB := '';
    v_firm_brig   NUMBER := 0;
    v_cont_brig   NUMBER := 0;
    v_firm_people NUMBER := 0;
    v_cont_people NUMBER := 0;

    TYPE dep_table IS TABLE OF VARCHAR2(4000);
    v_dep_tbl dep_table := apex_string.split(p_departments, ':');
BEGIN
    -- –ë—Ä–∏–≥–∞–¥–∏
    SELECT 
      COUNT(CASE WHEN org = 1 THEN 1 END),
      COUNT(CASE WHEN org = 0 THEN 1 END)
    INTO v_firm_brig, v_cont_brig
    FROM your_view
    WHERE unit = p_unit
      AND outfit_open = 6
      AND (p_departments IS NULL OR department MEMBER OF v_dep_tbl);

    -- –õ—é–¥–∏
    SELECT 
      SUM(CASE WHEN org = 1 THEN team_count ELSE 0 END),
      SUM(CASE WHEN org = 0 THEN team_count ELSE 0 END)
    INTO v_firm_people, v_cont_people
    FROM your_view
    WHERE unit = p_unit
      AND outfit_open = 6
      AND (p_departments IS NULL OR department MEMBER OF v_dep_tbl);

    v_html := '–ü–æ Unit: ' || p_unit || '<br>';
    v_html := v_html || v_firm_brig || ' –±—Ä–∏–≥–∞–¥ –§—ñ—Ä–º–∞, ' || v_cont_brig || ' –ü—ñ–¥—Ä—è–¥–Ω–∏–∫–∏<br>';
    v_html := v_html || v_firm_people || ' —á–æ–ª. –§—ñ—Ä–º–∞, ' || v_cont_people || ' –ü—ñ–¥—Ä—è–¥–Ω–∏–∫–∏';

    RETURN v_html;
EXCEPTION
    WHEN OTHERS THEN
        RETURN '–ü–æ–º–∏–ª–∫–∞: ' || SQLERRM;
END;
/
```

---

## üß™ –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –£ PL/SQL Dynamic Content –∞–±–æ Dynamic Action:

```plsql
BEGIN
  RETURN get_unit_quick_stats(1, 'DEP1:DEP2');
END;
```

---

## üß© –ü—Ä–∏–º—ñ—Ç–∫–∏

- `your_view` ‚Äî –∑–∞–º—ñ–Ω–∏ –Ω–∞ —Ñ–∞–∫—Ç–∏—á–Ω—É –Ω–∞–∑–≤—É —Ç–≤–æ–≥–æ view (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `V_OUTFIT_STATS`)
- –Ø–∫—â–æ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∏ ‚Äî —Ñ—ñ–ª—å—Ç—Ä –Ω–µ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è (`–ø–æ–∫–∞–∑—É—î –≤—Å—ñ`)
- `org = 1` ‚Äî —Ñ—ñ—Ä–º–∞, `org = 0` ‚Äî –ø—ñ–¥—Ä—è–¥–Ω–∏–∫ (–∑–≥—ñ–¥–Ω–æ —Ç–≤–æ—î—ó –ª–æ–≥—ñ–∫–∏)

---

–•–æ—á–µ—à ‚Äî –º–æ–∂—É –æ–¥—Ä–∞–∑—É –¥–æ–¥–∞—Ç–∏ —Ü—é —Ñ—É–Ω–∫—Ü—ñ—é –¥–æ –∑–≤—ñ—Ç—É –ø–æ –∫–ª—ñ–∫—É –∞–±–æ –¥–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –∑ –≤–∏–±–æ—Ä–æ–º —é–Ω—ñ—Ç–∞ –∑—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏.