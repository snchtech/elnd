–ß—É–¥–æ–≤–æ! –î–∞–≤–∞–π —è –ø–æ–∫–∞–∂—É —Ç–æ–±—ñ **–ø—Ä–∏–∫–ª–∞–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É `v_outfit_pivot_base`**, —è–∫—â–æ —Ç–∏ –ø–µ—Ä–µ–¥–∞—î—à —É —Ñ—ñ–ª—å—Ç—Ä –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:

---

## üîΩ **–ó–Ω–∞—á–µ–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä—ñ–≤:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä            | –ó–Ω–∞—á–µ–Ω–Ω—è                  |
|---------------------|---------------------------|
| `:P_MODAL_ORG`      | `0`  ‚Üí —Ñ—ñ—Ä–º–∞              |
| `:P_MODAL_UNIT`     | `1`  ‚Üí unit 1             |
| `:P_MODAL_DEPARTMENTS` | `'1523,1257'` ‚Üí –≤—ñ–¥–¥—ñ–ª–∏ |
| `:P_MODAL_TIMEMODE` | `'NOW'` ‚Üí `data_start <= SYSDATE` |

---

## üìã **SQL-—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è —É APEX:**
```sql
SELECT *
FROM v_outfit_pivot_base
WHERE 1=1
  AND (:P_MODAL_ORG IS NULL OR org = TO_NUMBER(:P_MODAL_ORG))         -- org = 0 (—Ñ—ñ—Ä–º–∞)
  AND (:P_MODAL_UNIT IS NULL OR unit = TO_NUMBER(:P_MODAL_UNIT))      -- unit = 1
  AND (:P_MODAL_DEPARTMENTS IS NULL 
       OR department IN (
           SELECT column_value FROM TABLE(split_string(:P_MODAL_DEPARTMENTS, ','))
       )
      )                                                               -- department IN (1523, 1257)
  AND (
    :P_MODAL_TIMEMODE = 'NOW' AND data_start <= SYSDATE               -- data_start <= SYSDATE
  )
```

---

## ‚úÖ **–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–ø—Ä–∏–∫–ª–∞–¥):**

| group_name   | org | unit | department | data_start         | u1_people | u1_brigades | u2_people | u2_brigades | u3_people | u3_brigades | total_people | total_brigades |
|--------------|-----|------|------------|---------------------|-----------|--------------|-----------|--------------|-----------|--------------|---------------|----------------|
| 1523         | 0   | 1    | 1523       | 2024-04-10 08:12:00 | 0         | 0            | 10        | 1            | 0         | 0            | 10            | 1              |
| 1257         | 0   | 1    | 1257       | 2024-04-10 09:30:00 | 0         | 0            | 7         | 1            | 0         | 0            | 7             | 1              |

---

## üìå –ü–æ—è—Å–Ω–µ–Ω–Ω—è:

- **group_name = department** (—Ñ—ñ—Ä–º–∞ ‚Üí org = 0)
- –ü–æ–∫–∞–∑–∞–Ω–æ –ª–∏—à–µ `unit = 1`, –±–æ –º–∏ –≤–∫–∞–∑–∞–ª–∏ —Ñ—ñ–ª—å—Ç—Ä `:P_MODAL_UNIT := 1`
- –¢—ñ–ª—å–∫–∏ –≤—ñ–¥–¥—ñ–ª–∏ `1523` —ñ `1257`
- –î–∞–Ω—ñ, —è–∫—ñ —Å—Ç–∞—Ä—Ç—É–≤–∞–ª–∏ **–¥–æ —Ç–µ–ø–µ—Ä—ñ—à–Ω—å–æ–≥–æ —á–∞—Å—É** (`:P_MODAL_TIMEMODE = 'NOW'`)
- –í–∏–≤–µ–¥–µ–Ω–æ:
  - `u1_people`, `u1_brigades` ‚Üí 0 (–±–æ unit = 1, –Ω–µ 0)
  - `u2_people`, `u2_brigades` ‚Üí —Ä–µ–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
  - `total_people`, `total_brigades` ‚Üí —Å—É–º–∞

---

## üéØ –Ø–∫ –≤–∏–≥–ª—è–¥–∞—Ç–∏–º–µ –≤ APEX:

- –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –∑–≤—ñ—Ç
- ‚úÖ –§—ñ–ª—å—Ç—Ä–∏ –∑–∞ LOV `P_MODAL_UNIT`, `P_MODAL_ORG`, `P_MODAL_DEPARTMENTS`
- üìä –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –ø–æ `group_name`
- üü¢ –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –ø—ñ–¥—Å—É–º–∫–æ–≤–∏–π —Ä—è–¥–æ–∫ (`SUM(...)`)

---

## üîß –•–æ—á–µ—à –¥–æ–¥–∞—Ç–∫–æ–≤–æ:

- –ü–æ–∫–∞–∑–∞—Ç–∏ **–∑–≤–µ–¥–µ–Ω–∏–π —Ä—è–¥–æ–∫ "–£—Å—å–æ–≥–æ"**?
- –ó—Ä–æ–±–∏—Ç–∏ **–≥—Ä–∞—Ñ—ñ–∫**?
- –î–æ–¥–∞—Ç–∏ **drill-down** –ø–æ –∫–æ–∂–Ω—ñ–π –∫–ª—ñ—Ç–∏–Ω—Ü—ñ —Ç–∞–±–ª–∏—Ü—ñ?

–°–∫–∞–∂–∏ ‚Äî —è –≤—Å–µ –ø—ñ–¥–ª–∞—à—Ç—É—é ‚ú®