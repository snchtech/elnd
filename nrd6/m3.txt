–î—è–∫—É—é –∑–∞ —á—ñ—Ç–∫–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è. –°–∏—Ç—É–∞—Ü—ñ—è —Å–ø—Ä–∞–≤–¥—ñ –º–∞—î –∫—ñ–ª—å–∫–∞ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó, —ñ –≤–∏–±—ñ—Ä –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ **—Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏**, **—à–≤–∏–¥–∫–æ–¥—ñ—ó** —Ç–∞ **–º—ñ—Å—Ü—è —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è –ª–æ–≥—ñ–∫–∏**. –†–æ–∑–≥–ª—è–Ω–µ–º–æ —Ç–≤–æ—é —Å–∏—Ç—É–∞—Ü—ñ—é –¥–µ—Ç–∞–ª—å–Ω–æ.

---

## üîπ –ü–∏—Ç–∞–Ω–Ω—è:
> –ß–∏ –≤–∞—Ä—Ç–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ª–æ–≥—ñ–∫—É `get_unit_quick_stats` —á–µ—Ä–µ–∑ SQL-–∑–∞–ø–∏—Ç, –∞ –Ω–µ —á–µ—Ä–µ–∑ PL/SQL-—Ñ—É–Ω–∫—Ü—ñ—é, —è–∫—â–æ WebSocket –ø—Ä–∞—Ü—é—î –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ Oracle 10g?

---

## ‚úÖ –í–∏—Å–Ω–æ–≤–æ–∫ –Ω–∞–ø–µ—Ä–µ–¥

> –Ø–∫—â–æ WebSocket –ø—Ä–∞—Ü—é—î **–Ω–∞–ø—Ä—è–º—É –∑ Oracle 10g**, –∞ —Ñ—É–Ω–∫—Ü—ñ—è —Å—Ç–≤–æ—Ä–µ–Ω–∞ —É **Oracle 12 —á–µ—Ä–µ–∑ DBLink**, **–ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ PL/SQL-—Ñ—É–Ω–∫—Ü—ñ—é —á–µ—Ä–µ–∑ `SELECT get_unit_quick_stats(...) FROM DUAL@dblink`.

**–ù–∞—Ç–æ–º—ñ—Å—Ç—å ‚Äî –∫—Ä–∞—â–µ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ª–æ–≥—ñ–∫—É –ø–æ–≤–Ω—ñ—Å—Ç—é —á–µ—Ä–µ–∑ SQL-–∑–∞–ø–∏—Ç, —è–∫–∏–π –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–∏–π –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –Ω–∞ Oracle 10g**, –∞–±–æ –≤–∏–Ω–µ—Å—Ç–∏ –≤—Å—é –ª–æ–≥—ñ–∫—É —É WebSocket-—Å—Ç–æ—Ä–æ–Ω—ñ (Node.js) —ñ –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—å –¥–æ `SELECT`-–∑–∞–ø–∏—Ç—É –Ω–∞–ø—Ä—è–º—É.

---

## üî∏ –ß–æ–º—É –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `get_unit_quick_stats` –∑ Oracle 12 —á–µ—Ä–µ–∑ dblink:
1. ‚ùå **DBLink –≤–∏–∫–ª–∏–∫–∏ —Ñ—É–Ω–∫—Ü—ñ–π** –º–æ–∂—É—Ç—å:
   - –±–ª–æ–∫—É–≤–∞—Ç–∏—Å—å (–æ—Å–æ–±–ª–∏–≤–æ —è–∫—â–æ –æ–±—Ä–æ–±–∫–∞ PL/SQL –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ª–æ–∫–∞–ª—å–Ω—ñ –æ–±‚Äô—î–∫—Ç–∏).
   - –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ `ORA-06550` –∞–±–æ `PLS-00201`, —è–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ –ª—ñ–Ω–∫.
   - –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ `CLOB` –∞–±–æ —Å–∫–ª–∞–¥–Ω–∏–º–∏ —Ç–∏–ø–∞–º–∏ –±–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
2. ‚ùå **–ú–æ–∂–ª–∏–≤–µ –∑–Ω–∏–∂–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ** –ø—Ä–∏ –º–∞—Å–æ–≤–∏—Ö –∑–∞–ø–∏—Ç–∞—Ö.
3. ‚ùå **APEX —ñ WebSocket –ø—Ä–∞—Ü—é—é—Ç—å –∑ —Ä—ñ–∑–Ω–∏–º–∏ –∫–æ–Ω—Ç—É—Ä–∞–º–∏**, —Ç–æ–º—É –ª–æ–≥—ñ–∫–∞ –≤ –æ–¥–Ω—ñ–π –°–£–ë–î –º–æ–∂–µ –Ω–µ –≤–∏–∫–æ–Ω–∞—Ç–∏—Å—å —É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —ñ–Ω—à–æ—ó.

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç ‚Äî **–ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –ª–æ–≥—ñ–∫—É –∑ —Ñ—É–Ω–∫—Ü—ñ—ó —É —á–∏—Å—Ç–∏–π SQL**:

–û—Å—å –∞–Ω–∞–ª–æ–≥ —Ç–≤–æ—î—ó `get_unit_quick_stats`, –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∏–π —è–∫ **—î–¥–∏–Ω–∏–π SQL-–∑–∞–ø–∏—Ç**, —è–∫–∏–π –º–æ–∂–Ω–∞ –ª–µ–≥–∫–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –∑ WebSocket-—Å–µ—Ä–≤–µ—Ä–∞:

```sql
SELECT
  COUNT(CASE WHEN org = 0 THEN 1 END) AS firm_brigades,
  COUNT(CASE WHEN org = 1 THEN 1 END) AS contractor_brigades,
  SUM(CASE WHEN org = 0 THEN team_count ELSE 0 END) AS firm_people,
  SUM(CASE WHEN org = 1 THEN team_count ELSE 0 END) AS contractor_people
FROM your_view
WHERE unit = :p_unit
  AND outfit_open = 6
  AND (
    :p_departments IS NULL 
    OR department IN (SELECT column_value FROM TABLE(split_string(:p_departments, ':')))
  )
  AND (
    (:p_date_start IS NULL AND :p_date_end IS NULL)
    OR (
      (:p_date_start IS NULL OR data_start >= :p_date_start)
      AND (:p_date_end IS NULL OR data_start <= :p_date_end)
    )
  )
```

> –£ Node.js —Ç–∏ –º–æ–∂–µ—à –ø–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ `p_unit`, `p_departments`, `p_date_start`, `p_date_end` —è–∫ –∑–º—ñ–Ω–Ω—ñ –π —Å—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ —Ü–µ–π SQL –¥–∏–Ω–∞–º—ñ—á–Ω–æ –∑ `oracledb.execute(...)`.

---

## üî∏ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞, —è–∫—â–æ —Ö–æ—á–µ—à –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ PL/SQL:
–Ø–∫—â–æ **–≤—Å–µ –∂ —Ö–æ—á–µ—à –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `get_unit_quick_stats`**, —Ç–æ–¥—ñ:

- üî∏ –í–∏–Ω–µ—Å–∏ —Ü—é —Ñ—É–Ω–∫—Ü—ñ—é —Ç–∞–∫–æ–∂ –≤ Oracle 10g, –∞–±–æ
- üî∏ –°—Ç–≤–æ—Ä–∏ **–∞–Ω–∞–ª–æ–≥ —É Node.js**, —â–æ –ø—Ä–æ—Å—Ç–æ —Ä–æ–±–∏—Ç—å SQL —ñ —Ñ–æ—Ä–º—É—î –ø–æ—Ç—Ä—ñ–±–Ω–∏–π JSON/HTML.

---

## üîß –§–æ—Ä–º—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —É WebSocket:

```js
const query = `SELECT ...`; // SQL —è–∫ –≤–∏—â–µ
const binds = {
  p_unit: 1,
  p_departments: '1523:1257',
  p_date_start: '2024-01-01',
  p_date_end: '2024-12-31'
};

const result = await oracleDBManager.query(query, binds);

const jsonResult = {
  html: `–ü–æ Unit: ${binds.p_unit}<br>
         ${result.rows[0].FIRM_BRIGADES} –±—Ä–∏–≥–∞–¥ –§—ñ—Ä–º–∞, ${result.rows[0].CONTRACTOR_BRIGADES} –ü—ñ–¥—Ä—è–¥–Ω–∏–∫–∏<br>
         ${result.rows[0].FIRM_PEOPLE} —á–æ–ª. –§—ñ—Ä–º–∞, ${result.rows[0].CONTRACTOR_PEOPLE} –ü—ñ–¥—Ä—è–¥–Ω–∏–∫–∏`
};
```

---

## ‚úÖ –ü—ñ–¥—Å—É–º–æ–∫:

| –ü—ñ–¥—Ö—ñ–¥ | –ü–µ—Ä–µ–≤–∞–≥–∏ | –ù–µ–¥–æ–ª—ñ–∫–∏ |
|-------|----------|----------|
| üî∏ PL/SQL —Ñ—É–Ω–∫—Ü—ñ—è `get_unit_quick_stats` –Ω–∞ Oracle 12 —á–µ—Ä–µ–∑ DBLink | –ü–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è, —á–∏—Ç–∞–±–µ–ª—å–Ω—ñ—Å—Ç—å | ‚ùå DBLink + CLOB = –ø—Ä–æ–±–ª–µ–º–∏; ‚ùå Node.js –Ω–µ –≤–∏–∫–ª–∏—á–µ –Ω–∞–ø—Ä—è–º—É |
| ‚úÖ SQL-–∑–∞–ø–∏—Ç —É Node.js | ‚úÖ –ü—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ Oracle 10g; ‚úÖ –ì–Ω—É—á–∫—ñ—Å—Ç—å | –ú–æ–∂–µ –ø–æ—Ç—Ä–µ–±—É–≤–∞—Ç–∏ –±—ñ–ª—å—à–µ –∫–æ–¥—É |
| üîÅ PL/SQL —Ñ—É–Ω–∫—Ü—ñ—è –Ω–∞ Oracle 10g | ‚úÖ –Ø–∫—â–æ –¥–æ—Å—Ç—É–ø–Ω–æ | –ü–æ—Ç—Ä–µ–±—É—î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó –Ω–∞ —ñ–Ω—à—ñ–π –ë–î |

---

üîπ **–†–µ–∫–æ–º–µ–Ω–¥—É—é:** —Ä–µ–∞–ª—ñ–∑–æ–≤—É–≤–∞—Ç–∏ –ª–æ–≥—ñ–∫—É –≤ —á–∏—Å—Ç–æ–º—É SQL —ñ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —ó—ó –Ω–∞–ø—Ä—è–º—É –Ω–∞ Oracle 10g —ñ–∑ WebSocket-—Å–µ—Ä–≤–µ—Ä–∞.

–ì–æ—Ç–æ–≤–∏–π –¥–æ–ø–æ–º–æ–≥—Ç–∏ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ SQL-–∑–∞–ø–∏—Ç –ø–æ–≤–Ω—ñ—Å—Ç—é –ø—ñ–¥ —Ç–≤–æ—ó –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —É —Ñ–æ—Ä–º–∞—Ç—ñ Node.js.