–û—Å—å –æ–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å—ñ—è —Ñ—É–Ω–∫—Ü—ñ—ó `get_unit_quick_stats`, –≤ —è–∫—ñ–π –∑–Ω–∞—á–µ–Ω–Ω—è –æ–±–≥–æ—Ä–Ω—É—Ç—ñ —É `<span>` –∑ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º–∏ `id`/`class`, –∞ –≤—Å–µ –≤–º—ñ—â–µ–Ω–æ –≤ `div` –∑ –∫–ª–∞—Å–æ–º `outfit-unitX` (–¥–µ `X = p_unit`):

```plsql
CREATE OR REPLACE FUNCTION get_unit_quick_stats (
    p_unit         IN NUMBER,
    p_departments  IN VARCHAR2 DEFAULT NULL, -- 'DEP1:DEP2'
    p_date_start   IN DATE DEFAULT NULL,
    p_date_end     IN DATE DEFAULT NULL
) RETURN CLOB IS
    v_html        CLOB := '';
    v_firm_brig   NUMBER := 0;
    v_cont_brig   NUMBER := 0;
    v_firm_people NUMBER := 0;
    v_cont_people NUMBER := 0;

    v_end         DATE;
    v_has_date    BOOLEAN := FALSE;

    v_dep_tbl SYS.ODCIVARCHAR2LIST := SYS.ODCIVARCHAR2LIST();
BEGIN
    -- –†–æ–∑–±–∏—Ç–∏ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∏, —è–∫—â–æ –ø–µ—Ä–µ–¥–∞–Ω–æ
    IF p_departments IS NOT NULL THEN
        v_dep_tbl := split_string(p_departments, ':');
    END IF;

    -- –í–∏–∑–Ω–∞—á–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä –ø–æ —á–∞—Å—É
    IF p_date_start IS NOT NULL THEN
        v_has_date := TRUE;
        v_end := NVL(p_date_end, SYSDATE);
    ELSIF p_date_end IS NOT NULL THEN
        v_has_date := TRUE;
        v_end := p_date_end;
    END IF;

    -- –ë—Ä–∏–≥–∞–¥–∏
    SELECT 
      COUNT(CASE WHEN org = 0 THEN 1 END),  -- —Ñ—ñ—Ä–º–∞
      COUNT(CASE WHEN org = 1 THEN 1 END)   -- –ø—ñ–¥—Ä—è–¥–Ω–∏–∫
    INTO v_firm_brig, v_cont_brig
    FROM your_view
    WHERE unit = p_unit
      AND outfit_open = 6
      AND (
        p_departments IS NULL 
        OR department IN (SELECT COLUMN_VALUE FROM TABLE(v_dep_tbl))
      )
      AND (
        NOT v_has_date OR (
          (p_date_start IS NULL OR data_start >= p_date_start) AND
          (p_date_end IS NULL OR data_start <= v_end)
        )
      );

    -- –õ—é–¥–∏
    SELECT 
      NVL(SUM(CASE WHEN org = 0 THEN team_count ELSE 0 END), 0),  -- —Ñ—ñ—Ä–º–∞
      NVL(SUM(CASE WHEN org = 1 THEN team_count ELSE 0 END), 0)   -- –ø—ñ–¥—Ä—è–¥–Ω–∏–∫
    INTO v_firm_people, v_cont_people
    FROM your_view
    WHERE unit = p_unit
      AND outfit_open = 6
      AND (
        p_departments IS NULL 
        OR department IN (SELECT COLUMN_VALUE FROM TABLE(v_dep_tbl))
      )
      AND (
        NOT v_has_date OR (
          (p_date_start IS NULL OR data_start >= p_date_start) AND
          (p_date_end IS NULL OR data_start <= v_end)
        )
      );

    -- HTML –∑ span-–æ–±–≥–æ—Ä—Ç–∫–∞–º–∏
    v_html := '<div class="outfit-unit' || p_unit || '">' ||
              '<div>–ü–æ Unit: <span class="unit-label">' || p_unit || '</span></div>' ||
              '<div>' ||
                '<span class="firm-brigades" id="firm-brigades-u' || p_unit || '">' || v_firm_brig || '</span> –±—Ä–∏–≥–∞–¥ –§—ñ—Ä–º–∞, ' ||
                '<span class="contractor-brigades" id="contractor-brigades-u' || p_unit || '">' || v_cont_brig || '</span> –ü—ñ–¥—Ä—è–¥–Ω–∏–∫–∏' ||
              '</div>' ||
              '<div>' ||
                '<span class="firm-people" id="firm-people-u' || p_unit || '">' || v_firm_people || '</span> —á–æ–ª. –§—ñ—Ä–º–∞, ' ||
                '<span class="contractor-people" id="contractor-people-u' || p_unit || '">' || v_cont_people || '</span> –ü—ñ–¥—Ä—è–¥–Ω–∏–∫–∏' ||
              '</div>' ||
              '</div>';

    RETURN v_html;

EXCEPTION
    WHEN OTHERS THEN
        RETURN '–ü–æ–º–∏–ª–∫–∞: ' || SQLERRM;
END;
/
```

---

### üîç –Ø–∫ —Ü–µ –≤–∏–≥–ª—è–¥–∞—î –≤ HTML:

```html
<div class="outfit-unit1">
  <div>–ü–æ Unit: <span class="unit-label">1</span></div>
  <div><span class="firm-brigades" id="firm-brigades-u1">4</span> –±—Ä–∏–≥–∞–¥ –§—ñ—Ä–º–∞, <span class="contractor-brigades" id="contractor-brigades-u1">2</span> –ü—ñ–¥—Ä—è–¥–Ω–∏–∫–∏</div>
  <div><span class="firm-people" id="firm-people-u1">12</span> —á–æ–ª. –§—ñ—Ä–º–∞, <span class="contractor-people" id="contractor-people-u1">5</span> –ü—ñ–¥—Ä—è–¥–Ω–∏–∫–∏</div>
</div>
```

---

### ‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏:

- –ú–æ–∂–µ—à –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –æ–∫—Ä–µ–º—ñ `span` –µ–ª–µ–º–µ–Ω—Ç–∏ —á–µ—Ä–µ–∑ JavaScript:
```js
document.getElementById('firm-people-u1').innerText = 15;
```

- –ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏ –¥–ª—è —Å—Ç–∏–ª—ñ–∑–∞—Ü—ñ—ó —á–∏ WebSocket –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:
```js
document.querySelector('.outfit-unit2 .contractor-brigades').textContent = '3';
```

–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ ‚Äî –º–æ–∂—É –¥–æ–ø–æ–º–æ–≥—Ç–∏ –∑ `JS` –∫–æ–¥–æ–º –¥–ª—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ü–∏—Ö –∑–Ω–∞—á–µ–Ω—å —á–µ—Ä–µ–∑ WebSocket.