Ğ”ÑĞºÑƒÑ, Ğ¿Ğ¾ÑÑĞ½ĞµĞ½Ğ½Ñ Ğ´ÑƒĞ¶Ğµ Ñ‡Ñ–Ñ‚ĞºĞµ â€” Ñ‚Ğ¸ Ñ…Ğ¾Ñ‡ĞµÑˆ **ĞºĞ¾Ñ€ĞµĞºÑ‚Ğ½Ğ¾ Ğ²Ñ–Ğ´Ñ–Ğ±Ñ€Ğ°Ñ‚Ğ¸ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ Ğ· `status_start_date` Ñ‚Ğ° `status_end_date`**, ÑĞºÑ– **Ğ°ĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ñ– Ğ´Ğ»Ñ Ğ²Ğ¸Ğ±Ñ€Ğ°Ğ½Ğ¾Ğ³Ğ¾ Ñ‡Ğ°ÑĞ¾Ğ²Ğ¾ÌĞ³Ğ¾ Ñ–Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ»Ñƒ**:

---

## ğŸ” ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° ÑÑ‚Ğ°Ñ€Ğ¾Ñ— ÑƒĞ¼Ğ¾Ğ²Ğ¸:
```sql
(p_date_start IS NULL OR data_start >= p_date_start)
AND (p_date_end IS NULL OR data_start <= v_end)
```
ğŸ‘‰ Ğ’Ğ¾Ğ½Ğ° Ñ„Ñ–Ğ»ÑŒÑ‚Ñ€ÑƒÑ” Ğ¿Ğ¾ `data_start`, Ğ° Ğ½Ğµ Ğ¿Ğ¾ **Ñ–Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ»Ğ°Ñ… ÑÑ‚Ğ°Ñ‚ÑƒÑÑƒ (start-end)**. Ğ¢Ğ¾Ğ¼Ñƒ Ğ²Ğ¾Ğ½Ğ° Ğ½Ğµ Ğ²Ñ–Ğ´Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°Ñ” Ğ¿Ğ¾Ğ²Ğ½Ñƒ ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½Ñƒ â€” Ğ½Ğ°Ğ¿Ñ€Ğ¸ĞºĞ»Ğ°Ğ´, ÑĞºÑ‰Ğ¾ outfit Ğ¿Ğ¾Ñ‡Ğ°Ğ²ÑÑ Ğ´Ğ¾ Ğ²Ğ¸Ğ±Ñ€Ğ°Ğ½Ğ¾Ğ³Ğ¾ Ñ–Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ»Ñƒ, Ğ°Ğ»Ğµ Ñ‚Ñ€Ğ¸Ğ²Ğ°Ñ” **Ğ²ÑĞµÑ€ĞµĞ´Ğ¸Ğ½Ñ–** Ğ½ÑŒĞ¾Ğ³Ğ¾.

---

## âœ… ĞĞ¾Ğ²Ğ° ÑƒĞ¼Ğ¾Ğ²Ğ° Ğ· `status_start_date` / `status_end_date` (Ğ¾Ñ†Ñ–Ğ½ĞºĞ°)

Ğ¢Ğ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ğ¿Ğ¾Ğ½ÑƒĞ²Ğ°Ğ²:
```sql
AND (
  (v_start IS NOT NULL AND status_start_date < v_end AND v_start < status_end_date)
  OR
  (v_start IS NULL AND status_start_date < v_end AND status_end_date IS NULL)
)
```

### ğŸ” Ğ Ğ¾Ğ·Ğ±ĞµÑ€ĞµĞ¼Ğ¾:

1. `v_start IS NOT NULL`: Ğ´Ğ»Ñ Ñ„Ñ–Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ… Ğ´Ñ–Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ñ–Ğ² (Ğ´Ğ¾Ğ±Ğ° / Ğ·Ğ¼Ñ–Ğ½Ğ°)
2. `status_start_date < v_end`: Ğ¿Ğ¾Ñ‡Ğ°Ñ‚Ğ¾Ğº ÑÑ‚Ğ°Ñ‚ÑƒÑÑƒ Ğ±ÑƒĞ² Ğ”Ğ ĞºÑ–Ğ½Ñ†Ñ Ğ´Ñ–Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ñƒ
3. `v_start < status_end_date`: ĞºÑ–Ğ½ĞµÑ†ÑŒ Ğ´Ñ–Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ñƒ Ğ±ÑƒĞ² Ğ”Ğ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ñ ÑÑ‚Ğ°Ñ‚ÑƒÑÑƒ

âš ï¸ **ĞĞ»Ğµ Ñ” Ğ½ÑĞ°Ğ½Ñ**: ÑĞºÑ‰Ğ¾ `status_end_date IS NULL`, Ñ‚Ğ¾Ğ´Ñ– `v_start < status_end_date` â†’ NULL â†’ ÑƒĞ¼Ğ¾Ğ²Ğ° Ğ½Ğµ ÑĞ¿Ñ€Ğ°Ñ†ÑÑ”.

---

## âœ… Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ¾Ğ²Ğ°Ğ½Ğ° ÑƒĞ¼Ğ¾Ğ²Ğ° (Ğ· ÑƒÑ€Ğ°Ñ…ÑƒĞ²Ğ°Ğ½Ğ½ÑĞ¼ `NULL` Ğ´Ğ»Ñ `status_end_date`):

```sql
AND (
  (v_start IS NOT NULL AND status_start_date < v_end AND (status_end_date IS NULL OR v_start < status_end_date))
  OR
  (v_start IS NULL AND status_start_date < v_end AND status_end_date IS NULL)
)
```

### âœ… ĞŸĞ¾ÑÑĞ½ĞµĞ½Ğ½Ñ:

- **ĞŸĞµÑ€ÑˆĞ¸Ğ¹ Ğ±Ğ»Ğ¾Ğº** â€” Ğ´Ğ»Ñ Ñ€ĞµĞ¶Ğ¸Ğ¼Ñ–Ğ² `DAY` Ñ– `SHIFT`:
  - ÑÑ‚Ğ°Ñ‚ÑƒÑ Ğ¿Ğ¾Ñ‡Ğ°Ğ²ÑÑ **Ğ´Ğ¾ ĞºÑ–Ğ½Ñ†Ñ Ğ²Ñ–ĞºĞ½Ğ°**
  - Ñ– Ñ‰Ğµ Ğ½Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ²ÑÑ Ğ´Ğ¾ Ğ¿Ğ¾Ñ‡Ğ°Ñ‚ĞºÑƒ Ğ²Ñ–ĞºĞ½Ğ° **(Ñ‚Ğ¾Ğ±Ñ‚Ğ¾ Ğ¿ĞµÑ€ĞµÑ‚Ğ¸Ğ½)**

- **Ğ”Ñ€ÑƒĞ³Ğ¸Ğ¹ Ğ±Ğ»Ğ¾Ğº** â€” Ğ´Ğ»Ñ Ñ€ĞµĞ¶Ğ¸Ğ¼Ñƒ `NOW`, ĞºĞ¾Ğ»Ğ¸ `v_start IS NULL`:
  - Ğ¿Ğ¾ĞºĞ°Ğ·ÑƒÑ” Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ– (Ğ² Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ–) ÑÑ‚Ğ°Ñ‚ÑƒÑĞ¸

---

## ğŸ”„ ĞŸĞ¾Ñ€Ñ–Ğ²Ğ½ÑĞ½Ğ½Ñ:

| Ğ’Ğ¸Ğ¿Ğ°Ğ´Ğ¾Ğº | status_start_date | status_end_date | v_start | v_end | ĞŸĞ¾Ñ‚Ñ€Ğ°Ğ¿Ğ¸Ñ‚ÑŒ Ñƒ Ğ²Ğ¸Ğ±Ñ–Ñ€ĞºÑƒ |
|--------|-------------------|-----------------|---------|-------|----------------------|
| Ğ—Ğ°Ñ€Ğ°Ğ·, ÑÑ‚Ğ°Ñ‚ÑƒÑ Ñ‰Ğµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¸Ğ¹ | 08:00 | `NULL` | `NULL` | `14:00` | âœ… |
| Ğ—Ğ¼Ñ–Ğ½Ğ°, ÑÑ‚Ğ°Ñ‚ÑƒÑ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¸Ğ¹ | 06:00 | `NULL` | 06:00 | 14:00 | âœ… |
| Ğ—Ğ¼Ñ–Ğ½Ğ°, ÑÑ‚Ğ°Ñ‚ÑƒÑ Ğ·Ğ°ĞºÑ–Ğ½Ñ‡Ğ¸Ğ²ÑÑ Ğ² ÑĞµÑ€ĞµĞ´Ğ¸Ğ½Ñ– | 06:00 | 08:00 | 06:00 | 14:00 | âœ… |
| Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ²ÑÑ Ğ´Ğ¾ Ğ¿Ğ¾Ñ‡Ğ°Ñ‚ĞºÑƒ | 05:00 | 05:59 | 06:00 | 14:00 | âŒ |
| Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ¿Ğ¾Ñ‡Ğ°Ğ²ÑÑ Ğ¿Ñ–ÑĞ»Ñ Ğ²Ñ–ĞºĞ½Ğ° | 15:00 | 16:00 | 06:00 | 14:00 | âŒ |

---

## ğŸ“Œ Ğ’Ğ¸ÑĞ½Ğ¾Ğ²Ğ¾Ğº:

Ğ¢Ğ²Ğ¾Ñ Ğ»Ğ¾Ğ³Ñ–ĞºĞ° â€” **Ğ´ÑƒĞ¶Ğµ Ğ±Ğ»Ğ¸Ğ·ÑŒĞºĞ° Ğ´Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ñ—**, Ñ– Ğ· Ğ¼Ğ°Ğ»ĞµĞ½ÑŒĞºĞ¸Ğ¼ Ğ´Ğ¾Ğ¿Ğ¾Ğ²Ğ½ĞµĞ½Ğ½ÑĞ¼ `status_end_date IS NULL OR ...` Ğ²Ğ¾Ğ½Ğ° ÑÑ‚Ğ°Ğ½Ğµ Ğ¿Ğ¾Ğ²Ğ½Ñ–ÑÑ‚Ñ ĞºĞ¾Ñ€ĞµĞºÑ‚Ğ½Ğ¾Ñ.

---

## ğŸ”§ Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¸Ğ¹ Ğ±Ğ»Ğ¾Ğº Ğ´Ğ»Ñ Ğ²ÑÑ‚Ğ°Ğ²ĞºĞ¸:

```sql
AND (
  (v_start IS NOT NULL AND status_start_date < v_end AND (status_end_date IS NULL OR v_start < status_end_date))
  OR
  (v_start IS NULL AND status_start_date < v_end AND status_end_date IS NULL)
)
```

ĞœĞ¾Ğ¶ĞµÑˆ Ğ·Ğ°ÑÑ‚Ğ¾ÑĞ¾Ğ²ÑƒĞ²Ğ°Ñ‚Ğ¸ Ñ†Ñ ÑƒĞ¼Ğ¾Ğ²Ñƒ Ğ² ÑƒÑÑ–Ñ… `SELECT ... FROM your_view` Ñƒ Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ— `get_unit_matrix_html`.

Ğ¯ĞºÑ‰Ğ¾ Ğ¿Ğ¾Ñ‚Ñ€Ñ–Ğ±Ğ½Ğ¾ â€” Ğ¼Ğ¾Ğ¶Ñƒ Ğ´Ğ¾Ğ¿Ğ¾Ğ¼Ğ¾Ğ³Ñ‚Ğ¸ Ğ²Ğ±ÑƒĞ´ÑƒĞ²Ğ°Ñ‚Ğ¸ Ñ—Ñ— Ğ¿Ñ€ÑĞ¼Ğ¾ Ğ² Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ.