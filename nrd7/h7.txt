–ß—É–¥–æ–≤–æ, —â–æ —Ç–∏ –≤–∂–µ –º–∞—î—à –æ–Ω–æ–≤–ª–µ–Ω—É view –∑ `status_start_date`, `status_end_date` ‚Äî —Ç–µ–ø–µ—Ä –∑–∞–º—ñ–Ω–∏–º–æ —Å—Ç–∞—Ä—É —É–º–æ–≤—É –Ω–∞ –Ω–æ–≤—É, —è–∫–∞ –±–∞–∑—É—î—Ç—å—Å—è **–Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º—É —Å—Ç–∞—Ç—É—Å—ñ outfit** (—Ç–æ–±—Ç–æ `status_id = 6`) —Ç–∞ –π–æ–≥–æ **–ø–µ—Ä—ñ–æ–¥—ñ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ**.

---

### ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–∞ —É–º–æ–≤–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –ø–æ `:P_MODAL_TIMEMODE`

```sql
AND (
  (:P_MODAL_TIMEMODE = 'NOW' AND status_start_date < SYSDATE AND status_end_date IS NULL)
  OR (:P_MODAL_TIMEMODE = 'DAY' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= TRUNC(SYSDATE)))
  OR (:P_MODAL_TIMEMODE = 'SHIFT' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= :P_SHIFT_START))
)
```

---

### üìå –ü–æ—è—Å–Ω–µ–Ω–Ω—è –ª–æ–≥—ñ–∫–∏:

| –†–µ–∂–∏–º —á–∞—Å—É (`:P_MODAL_TIMEMODE`) | –£–º–æ–≤–∞ |
|----------------------------------|-------|
| `NOW`                            | —Å—Ç–∞—Ç—É—Å –ø–æ—á–∞–≤—Å—è –¥–æ `SYSDATE` —ñ —â–µ –Ω–µ –∑–∞–≤–µ—Ä—à–∏–≤—Å—è |
| `DAY`                            | —Å—Ç–∞—Ç—É—Å –ø–æ—á–∞–≤—Å—è –¥–æ `SYSDATE` —ñ **—â–µ —Ç—Ä–∏–≤–∞—î –∞–±–æ –∑–∞–≤–µ—Ä—à–∏–≤—Å—è –ø—ñ—Å–ª—è –ø–æ—á–∞—Ç–∫—É –¥–æ–±–∏** |
| `SHIFT`                          | —Å—Ç–∞—Ç—É—Å –ø–æ—á–∞–≤—Å—è –¥–æ `SYSDATE` —ñ **—â–µ —Ç—Ä–∏–≤–∞—î –∞–±–æ –∑–∞–≤–µ—Ä—à–∏–≤—Å—è –ø—ñ—Å–ª—è `:P_SHIFT_START`** |

---

### üîÅ –ü–æ–≤–Ω–∞ –æ–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å—ñ—è SELECT

```sql
SELECT *
FROM v_outfit_pivot_base
WHERE 1=1
  --AND (:P_MODAL_ORG IS NULL OR org = TO_NUMBER(:P_MODAL_ORG))
  --AND (:P_MODAL_UNIT IS NULL OR unit = TO_NUMBER(:P_MODAL_UNIT))
  AND (:P_MODAL_DEPARTMENTS IS NULL 
       OR department IN (
           SELECT column_value FROM TABLE(split_string(:P_MODAL_DEPARTMENTS, ':'))
       )
      )
  AND (
    (:P_MODAL_TIMEMODE = 'NOW' AND status_start_date < SYSDATE AND status_end_date IS NULL)
    OR (:P_MODAL_TIMEMODE = 'DAY' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= TRUNC(SYSDATE)))
    OR (:P_MODAL_TIMEMODE = 'SHIFT' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= :P_SHIFT_START))
  )
```

---

üîß –¢–µ–ø–µ—Ä –ø—Ä–∏ –∑–º—ñ–Ω—ñ —á–∞—Å—É (`NOW`, `DAY`, `SHIFT`) ‚Äî –∑–≤—ñ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–æ–±–ª—è—î —Ç—ñ `outfit`, —è–∫—ñ –∞–∫—Ç–∏–≤–Ω—ñ –≤ –∑–∞–¥–∞–Ω–æ–º—É —á–∞—Å–æ–≤–æ–º—É —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ.  
–ü–æ–≤—ñ–¥–æ–º, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –≤—Ä–∞—Ö—É–≤–∞—Ç–∏ `unit`, `org`, –∞–±–æ –¥–æ–¥–∞—Ç–∏ `GROUP BY` —É —Ü–µ–π –∑–∞–ø–∏—Ç ‚Äî –¥–æ–ø–æ–º–æ–∂—É –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏.