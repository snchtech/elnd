–¢–∞–∫, –ø–æ–≤–µ–¥—ñ–Ω–∫–∞, –∫–æ–ª–∏ –Ω–∞ –º–æ–¥–∞–ª—å–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –¥–ª—è –≤—Å—ñ—Ö —Ä–µ–∂–∏–º—ñ–≤ (`NOW`, `DAY`, `SHIFT`) –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è **–æ–¥–Ω–∞–∫–æ–≤—ñ –¥–∞–Ω—ñ**, —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ç–µ, —â–æ **—É–º–æ–≤–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –ø–æ —á–∞—Å—É –Ω–µ –ø—Ä–∞—Ü—é—î –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º**.

---

## üîç –ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –ø—Ä–∏—á–∏–Ω–∏

### **1. –ó–Ω–∞—á–µ–Ω–Ω—è `:P_MODAL_TIMEMODE` –Ω–µ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –ø–µ—Ä–µ–¥ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è–º**

–ü–µ—Ä–µ–≤—ñ—Ä:
- —á–∏ –¥—ñ–π—Å–Ω–æ –≤ AJAX callback `OPEN_MODAL` –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–Ω—è `x01` (mode)
- —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è:
```plsql
:P_MODAL_TIMEMODE := apex_application.g_x01;
```

üîß **–ü–æ—Ä–∞–¥–∞**: –î–æ–¥–∞–π `APEX_DEBUG.MESSAGE('Mode: ' || :P_MODAL_TIMEMODE);` –¥–æ –ø—Ä–æ—Ü–µ—Å—É `OPEN_MODAL`, –∞ –ø–æ—Ç—ñ–º –ø–æ–¥–∏–≤–∏—Å—å —É `APEX Debug` ‚Üí `Session`.

---

### **2. –£–º–æ–≤–∏ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –ø–æ —á–∞—Å—É –≤ SQL –Ω–µ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞–ª–µ–∂–Ω–æ**

–Ø–∫—â–æ —Ç–∏ —Ñ—ñ–ª—å—Ç—Ä—É—î—à —É SQL/PLSQL —Ç–∞–∫:

```sql
AND (
  (:P_MODAL_TIMEMODE = 'NOW' AND status_start_date < SYSDATE AND status_end_date IS NULL)
  OR (:P_MODAL_TIMEMODE = 'DAY' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= TRUNC(SYSDATE)))
  OR (:P_MODAL_TIMEMODE = 'SHIFT' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= :P_SHIFT_START))
)
```

üëâ —Ü—è —É–º–æ–≤–∞ **–ø–µ—Ä–µ–≤—ñ—Ä—è—î –≤—Å—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏** –æ–¥–Ω–æ—á–∞—Å–Ω–æ, –±–æ Oracle –≤–∏–∫–æ–Ω—É—î `OR` –Ω–µ–∑–∞–ª–µ–∂–Ω–æ, —è–∫—â–æ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ **–ø–∞—Ä–∞–º–µ—Ç—Ä–∏ bind** —è–≤–Ω–æ –∞–±–æ —è–∫—â–æ `:P_MODAL_TIMEMODE` –º–∞—î NULL.

üîß **–†—ñ—à–µ–Ω–Ω—è** ‚Äì –ø–µ—Ä–µ–ø–∏—à–∏ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º `CASE` –∞–±–æ –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ `AND`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:

```sql
AND (
    (:P_MODAL_TIMEMODE = 'NOW' AND status_start_date < SYSDATE AND status_end_date IS NULL)
)
AND (
    (:P_MODAL_TIMEMODE != 'NOW') OR :P_MODAL_TIMEMODE IS NULL
)
```

–ê–ª–µ —Ü–µ –≥—Ä–æ–º—ñ–∑–¥–∫–æ.

### ‚úÖ –ö—Ä–∞—â–µ —Ä—ñ—à–µ–Ω–Ω—è ‚Äî –∑—Ä–æ–±–∏—Ç–∏ —Ç–∞–∫:

```sql
AND (
    (:P_MODAL_TIMEMODE = 'NOW' AND status_start_date < SYSDATE AND status_end_date IS NULL)
    OR (:P_MODAL_TIMEMODE = 'DAY' AND status_start_date < SYSDATE AND NVL(status_end_date, SYSDATE + 1) >= TRUNC(SYSDATE))
    OR (:P_MODAL_TIMEMODE = 'SHIFT' AND status_start_date < SYSDATE AND NVL(status_end_date, SYSDATE + 1) >= :P_SHIFT_START)
)
```

### **3. –ó–Ω–∞—á–µ–Ω–Ω—è `P_MODAL_TIMEMODE` –∑–∞–ø–∏—Å—É—î—Ç—å—Å—è, –∞–ª–µ –Ω–µ –æ–Ω–æ–≤–ª—é—î SQL –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ**

–ü–µ—Ä–µ–≤—ñ—Ä:
- —á–∏ **items `P_MODAL_TIMEMODE`** —Å–ø—Ä–∞–≤–¥—ñ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è —è–∫ **Page Items** –Ω–∞ –º–æ–¥–∞–ª—å–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É.
- —á–∏ —Ç–∏ **–æ—á–∏—â—É—î—à –∫–µ—à —Å—Ç–æ—Ä—ñ–Ω–∫–∏** –ø—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π `p_clear_cache => 4`, —è–∫—â–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ 4).

---

## üîÅ –ü—ñ–¥—Å—É–º–æ–∫: –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏

| –ö—Ä–æ–∫ | –©–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ | –Ø–∫ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏ |
|------|----------------|--------------|
| 1 | `:P_MODAL_TIMEMODE` –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `OPEN_MODAL` | –ü–µ—Ä–µ–≤—ñ—Ä `apex_application.g_x01` |
| 2 | –£–º–æ–≤–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó —á–∞—Å—É ‚Äî –ø—Ä–∞—Ü—é—î —Ç—ñ–ª—å–∫–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É | –ü–µ—Ä–µ–ø–∏—à–∏ `WHERE` —è–∫ –≤–∏—â–µ |
| 3 | –£ SQL `:P_MODAL_TIMEMODE` –∑–∞–≤–∂–¥–∏ NULL | –£–ø–µ–≤–Ω–∏—Å—å, —â–æ item —î –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ —ñ –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è |
| 4 | –ö–µ—à —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –Ω–µ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è | –î–æ–¥–∞–π `p_clear_cache => 'P_MODAL_UNIT_STATS'` –∞–±–æ `4` |

---

–•–æ—á–µ—à ‚Äî –º–æ–∂—É –¥–æ–ø–æ–º–æ–≥—Ç–∏ –ø—Ä—è–º–æ –∑–∞—Ä–∞–∑ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ SQL-—É–º–æ–≤—É –∞–±–æ –ø—Ä–æ—Ü–µ—Å `OPEN_MODAL`. –ù–∞–ø–∏—à–∏, —â–æ —Å–∞–º–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—à: —Ñ—É–Ω–∫—Ü—ñ—è, dynamic action —á–∏ SQL report?