ÐžÑÑŒ Ð¿Ð¾ÐºÑ€Ð¾ÐºÐ¾Ð²Ð° Ñ–Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ñ–Ñ, ÑÐº ÑÑ‚Ð²Ð¾Ñ€Ð¸Ñ‚Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ñ–Ð¾Ð½Ð°Ð»ÑŒÐ½Ñƒ ÑÑ‚Ð¾Ñ€Ñ–Ð½ÐºÑƒ Ð² Oracle APEX Ñ–Ð·:

- Ñ„Ñ–Ð»ÑŒÑ‚Ñ€Ð°Ð¼Ð¸: `status_start_date`, `status_end_date`, `unit`, `department`
- Ñ–Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¸Ð¼ Ð·Ð²Ñ–Ñ‚Ð¾Ð¼ (IR) Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ñ– `V_OUTFIT_PIVOT_BASE`
- Ð¿Ñ–Ð´ÑÑƒÐ¼ÐºÐ¾Ð²Ð¸Ð¼ Ð·Ð²Ñ–Ñ‚Ð¾Ð¼ Ð· ÑÑƒÐ¼Ð°Ð¼Ð¸ ÐºÐ¾Ð»Ð¾Ð½Ð¾Ðº

---

## ðŸ”§ 1. Ð¡Ñ‚Ð²Ð¾Ñ€ÐµÐ½Ð½Ñ ÐµÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ–Ð² Ð´Ð»Ñ Ñ„Ñ–Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ñ–Ñ—

ÐÐ° ÑÑ‚Ð¾Ñ€Ñ–Ð½Ñ†Ñ–, Ð´Ðµ Ð±ÑƒÐ´Ðµ Ñ€Ð¾Ð·Ñ‚Ð°ÑˆÐ¾Ð²Ð°Ð½Ð¸Ð¹ Ð·Ð²Ñ–Ñ‚, Ð´Ð¾Ð´Ð°Ð¹ Ð½Ð°ÑÑ‚ÑƒÐ¿Ð½Ñ– ÐµÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¸ (Ð½Ð°Ð¿Ñ€., Ð² Ñ€ÐµÐ³Ñ–Ð¾Ð½ "Ð¤Ñ–Ð»ÑŒÑ‚Ñ€Ð¸"):

| Ð†Ð¼'Ñ Item | Ð¢Ð¸Ð¿ | ÐŸÑ€Ð¸Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ |
|----------|-----|-------------|
| `PXX_DATE_START` | Date Picker | `status_start_date` Ð²Ñ–Ð´ |
| `PXX_DATE_END`   | Date Picker | `status_end_date` Ð´Ð¾ |
| `PXX_UNIT`       | Select List | unit (0, 1, 2) |
| `PXX_DEPARTMENTS` | Checkbox Group | ÑÐ¿Ð¸ÑÐ¾Ðº Ð¿Ñ–Ð´Ñ€Ð¾Ð·Ð´Ñ–Ð»Ñ–Ð² |

> ðŸ” Ð—Ð°Ð¼Ñ–ÑÑ‚ÑŒ `PXX_` Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð°Ð¹ Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð¸Ð¹ Ð½Ð¾Ð¼ÐµÑ€ ÑÑ‚Ð¾Ñ€Ñ–Ð½ÐºÐ¸, Ð½Ð°Ð¿Ñ€. `P8_DATE_START`.

---

## ðŸ“„ 2. SQL-Ð·Ð°Ð¿Ð¸Ñ‚ Ð´Ð»Ñ IR-Ð·Ð²Ñ–Ñ‚Ñƒ

Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð°Ð¹ `V_OUTFIT_PIVOT_BASE` Ñ–Ð· Ñ„Ñ–Ð»ÑŒÑ‚Ñ€Ð°Ð¼Ð¸:

```sql
SELECT *
FROM V_OUTFIT_PIVOT_BASE
WHERE 1 = 1
  AND (:PXX_UNIT IS NULL OR unit = TO_NUMBER(:PXX_UNIT))
  AND (:PXX_DEPARTMENTS IS NULL 
       OR department IN (
           SELECT column_value FROM TABLE(split_string(:PXX_DEPARTMENTS, ':'))
       ))
  AND (
    (:PXX_DATE_START IS NULL OR status_start_date >= :PXX_DATE_START)
    AND (:PXX_DATE_END IS NULL OR NVL(status_end_date, SYSDATE + 1) <= :PXX_DATE_END)
  )
```

ðŸ“Œ *`NVL(status_end_date, SYSDATE + 1)` Ð´Ð¾Ð·Ð²Ð¾Ð»ÑÑ” Ð¾Ð±Ñ€Ð¾Ð±Ð¸Ñ‚Ð¸ `NULL` ÑÐº "Ñ‚Ñ€Ð¸Ð²Ð°Ñ” Ð´Ð¾ÑÑ–".*

---

## ðŸ”„ 3. Ð”Ð¾Ð´Ð°Ð¹ Dynamic Action Ð´Ð»Ñ Ñ€ÐµÐ°ÐºÑ†Ñ–Ñ— Ð½Ð° Ñ„Ñ–Ð»ÑŒÑ‚Ñ€Ð¸

Ð¡Ñ‚Ð²Ð¾Ñ€Ð¸ **Ð¾Ð´Ð¸Ð½ DA** (Dynamic Action):

- **Name:** `DA_Refresh_Report`
- **Event:** `Change`
- **Selection Type:** `Region`
- **Region:** Ð²ÐºÐ°Ð¶Ð¸ Ð²ÐµÑÑŒ Ð±Ð»Ð¾Ðº Ñ„Ñ–Ð»ÑŒÑ‚Ñ€Ñ–Ð² (Ð°Ð±Ð¾ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾ ÐºÐ¾Ð¶ÐµÐ½ item)
- **True Action:**
  - Action: `Refresh`
  - Affected Element: Ñ‚Ð²Ñ–Ð¹ Ð·Ð²Ñ–Ñ‚ (IR)

> ðŸ” ÐœÐ¾Ð¶Ð½Ð° Ð´Ð¾Ð´Ð°Ñ‚Ð¸ ÐºÑ–Ð»ÑŒÐºÐ° Ð¿Ð¾Ð´Ñ–Ð¹ Ð´Ð»Ñ ÐºÐ¾Ð¶Ð½Ð¾Ð³Ð¾ item, Ð°Ð±Ð¾ Ð¾Ð´Ð½Ñƒ Ð½Ð° Ð²ÐµÑÑŒ Ð±Ð»Ð¾Ðº.

---

## ðŸ“Š 4. Ð¡ÑƒÐ¼Ð°Ñ€Ð½Ð¸Ð¹ Ð·Ð²Ñ–Ñ‚

ÐÐ¸Ð¶Ñ‡Ðµ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð³Ð¾ Ð·Ð²Ñ–Ñ‚Ñƒ ÑÑ‚Ð²Ð¾Ñ€Ð¸ Ñ‰Ðµ Ð¾Ð´Ð¸Ð½ Ð·Ð²Ñ–Ñ‚ (`Classic Report` Ð°Ð±Ð¾ `IR`) Ð· Ñ‚Ð°ÐºÐ¸Ð¼ Ð·Ð°Ð¿Ð¸Ñ‚Ð¾Ð¼:

```sql
SELECT
  SUM(u1_people) AS sum_u1_people,
  SUM(u1_brigades) AS sum_u1_brigades,
  SUM(u2_people) AS sum_u2_people,
  SUM(u2_brigades) AS sum_u2_brigades,
  SUM(u3_people) AS sum_u3_people,
  SUM(u3_brigades) AS sum_u3_brigades,
  SUM(total_people) AS sum_total_people,
  SUM(total_brigades) AS sum_total_brigades
FROM V_OUTFIT_PIVOT_BASE
WHERE 1 = 1
  AND (:PXX_UNIT IS NULL OR unit = TO_NUMBER(:PXX_UNIT))
  AND (:PXX_DEPARTMENTS IS NULL 
       OR department IN (
           SELECT column_value FROM TABLE(split_string(:PXX_DEPARTMENTS, ':'))
       ))
  AND (
    (:PXX_DATE_START IS NULL OR status_start_date >= :PXX_DATE_START)
    AND (:PXX_DATE_END IS NULL OR NVL(status_end_date, SYSDATE + 1) <= :PXX_DATE_END)
  )
```

### ðŸ“Ž ÐŸÐ¾Ñ€Ð°Ð´Ð°
- Ð’ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸ ÐºÐ»Ð°Ñ `t-Region--noPadding` Ð´Ð»Ñ Ð´Ñ€ÑƒÐ³Ð¾Ð³Ð¾ Ð·Ð²Ñ–Ñ‚Ñƒ â€” Ð²Ð¸Ð³Ð»ÑÐ´Ð°Ñ‚Ð¸Ð¼Ðµ Ð°ÐºÑƒÑ€Ð°Ñ‚Ð½Ñ–ÑˆÐµ.
- Ð”Ð»Ñ IR Ð¼Ð¾Ð¶Ð½Ð° Ð´Ð¾Ð´Ð°Ñ‚Ð¸ "Download" ÐºÐ½Ð¾Ð¿ÐºÑƒ â†’ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡ Ð·Ð¼Ð¾Ð¶Ðµ ÐµÐºÑÐ¿Ð¾Ñ€Ñ‚ÑƒÐ²Ð°Ñ‚Ð¸ Ð´Ð°Ð½Ñ– Ð² Excel.

---

## ðŸ§ª ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ°

1. Ð—Ð°Ð¹Ð´Ð¸ Ð½Ð° ÑÑ‚Ð¾Ñ€Ñ–Ð½ÐºÑƒ â†’ Ð¿Ð¾Ð±Ð°Ñ‡ Ñ„Ñ–Ð»ÑŒÑ‚Ñ€Ð¸ Ñ‚Ð° Ð·Ð²Ñ–Ñ‚.
2. Ð—Ð¼Ñ–Ð½Ð¸ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¸ â†’ DA Ð¾Ð½Ð¾Ð²Ð»ÑŽÑ” Ð¾Ð±Ð¸Ð´Ð²Ð° Ð·Ð²Ñ–Ñ‚Ð¸.
3. ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€ export Ñƒ IR â†’ Ð´Ð°Ð½Ñ– Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ñ–.

---

Ð¥Ð¾Ñ‡ÐµÑˆ, Ñ‰Ð¾Ð± Ð¿Ñ€Ð¸ Ð²Ñ–Ð´ÐºÑ€Ð¸Ñ‚Ñ‚Ñ– ÑÑ‚Ð¾Ñ€Ñ–Ð½ÐºÐ¸ Ð²ÑÑ– Ñ„Ñ–Ð»ÑŒÑ‚Ñ€Ð¸ Ð±ÑƒÐ»Ð¸ Ð²ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ñ– Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡Ð½Ð¾ (Ð½Ð°Ð¿Ñ€Ð¸ÐºÐ»Ð°Ð´, `unit=0` Ñ– Ð²ÑÑ– `departments`)? â€” Ð¿Ñ–Ð´ÐºÐ°Ð¶Ñƒ Ð¾ÐºÑ€ÐµÐ¼Ð¾.

Ð‘Ð°Ð¶Ð°Ñ”Ñˆ Ð´Ð¾Ð´Ð°Ñ‚Ð¸ "ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚Ð¸ Ñ„Ñ–Ð»ÑŒÑ‚Ñ€Ð¸" Ð°Ð±Ð¾ "ÐŸÐ¾ÑˆÑƒÐº" ÐºÐ½Ð¾Ð¿ÐºÐ¸?