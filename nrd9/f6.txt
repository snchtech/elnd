–ß—É–¥–æ–≤–æ —Å—Ñ–æ—Ä–º—É–ª—å–æ–≤–∞–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è! –î–∞–≤–∞–π –ø—ñ–¥—Å—É–º—É—é —Ç–≤–æ—é —Å–∏—Ç—É–∞—Ü—ñ—é:

---

### üìã –£ —Ç–µ–±–µ –∑–∞—Ä–∞–∑:
- –î–∞–Ω—ñ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è —á–µ—Ä–µ–∑ PL/SQL-—Ñ—É–Ω–∫—Ü—ñ—é `get_unit_matrix_html`, —è–∫–∞ –±—É–¥—É—î **HTML-—Ç–∞–±–ª–∏—Ü—é** (—Ç–æ–±—Ç–æ —Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–∏–π —Ç–µ–∫—Å—Ç, –∞ –Ω–µ –∑–≤–∏—á–∞–π–Ω—ñ SQL-—Ä—è–¥–∫–∏).
- –¢–æ–º—É —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É –∫–Ω–æ–ø–∫—É **Download ‚Üí Excel** —É –∫–ª–∞—Å–∏—á–Ω–æ–º—É APEX-—Ä–æ–∑—É–º—ñ–Ω–Ω—ñ (—è–∫ —É Interactive Report/Classic Report) ‚Äî **Excel-–∑–≤—ñ—Ç –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ –Ω–∞–ø—Ä—è–º—É**.

---

### üéØ –©–æ —Ç—Ä–µ–±–∞ –¥–ª—è Excel-–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:
‚úÖ –ü–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ –∞–Ω–∞–ª–æ–≥ `get_unit_matrix_html` —É –≤–∏–≥–ª—è–¥—ñ **SQL –∑–∞–ø–∏—Ç—É –∞–±–æ PLSQL-—Ñ—É–Ω–∫—Ü—ñ—ó (PIPELINED FUNCTION –∞–±–æ –ø—Ä–æ—Å—Ç–∏–π SELECT)**, —è–∫–∏–π –±—É–¥–µ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ –¥–∞–Ω—ñ –≤ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ç–∞–±–ª–∏—á–Ω–æ–º—É –≤–∏–≥–ª—è–¥—ñ.

‚úÖ –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ —Ç–∏ –∑–º–æ–∂–µ—à:
- –∞–±–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π **Interactive Report**,
- –∞–±–æ –¥–æ–¥–∞—Ç–∏ **Export CSV/Excel** –∫–Ω–æ–ø–∫—É,
- –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **APEX Data Export** –ø—Ä–æ—Ü–µ—Å –¥–ª—è –≤–∏–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.

---

### üî• –Ø–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç–∏

–¢–≤–æ—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–∑–∞ –ª–æ–≥—ñ–∫–æ—é `get_unit_matrix_html`) –º–∞—î –±—É—Ç–∏ —Ç–∞–∫–æ—é –≤ SQL:

| PERIOD      | TYPE             | UNIT_1 | UNIT_2 | UNIT_3 | TOTAL |
|:------------|:-----------------|:-------|:-------|:-------|:------|
| –ó–∞—Ä–∞–∑       | –ë—Ä–∏–≥–∞–¥ —Ñ—ñ—Ä–º–∏      | ...    | ...    | ...    | ...  |
| –ó–∞—Ä–∞–∑       | –ë—Ä–∏–≥–∞–¥ –ø—ñ–¥—Ä—è–¥–Ω–∏–∫—ñ–≤| ...    | ...    | ...    | ...  |
| –ó–∞—Ä–∞–∑       | –õ—é–¥–µ–π —Ñ—ñ—Ä–º–∏       | ...    | ...    | ...    | ...  |
| –ó–∞—Ä–∞–∑       | –õ—é–¥–µ–π –ø—ñ–¥—Ä—è–¥–Ω–∏–∫—ñ–≤ | ...    | ...    | ...    | ...  |
| –ó –ø–æ—á–∞—Ç–∫—É –¥–æ–±–∏ | –ë—Ä–∏–≥–∞–¥ —Ñ—ñ—Ä–º–∏  | ...    | ...    | ...    | ... |
| ...        | ...              | ...    | ...    | ...    | ... |

---

### üõ† –ü—Ä–æ–ø–æ–Ω—É—é –ø–æ–±—É–¥–æ–≤—É —á–µ—Ä–µ–∑ `UNION ALL` –Ω–∞ —Ä—ñ–≤–Ω—ñ SQL

–û—Å—å —ñ–¥–µ—è SQL, —è–∫ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ —Ç–≤–æ—é —Ñ—É–Ω–∫—Ü—ñ—é –≤ –∑–≤–∏—á–∞–π–Ω–∏–π **—Ç–∞–±–ª–∏—á–Ω–∏–π –∑–∞–ø–∏—Ç** –¥–ª—è APEX:

```sql
SELECT 'NOW' AS period_key, '–ë—Ä–∏–≥–∞–¥ —Ñ—ñ—Ä–º–∏' AS type_label, 
       SUM(CASE WHEN unit = 0 THEN 1 ELSE 0 END) AS unit1,
       SUM(CASE WHEN unit = 1 THEN 1 ELSE 0 END) AS unit2,
       SUM(CASE WHEN unit = 2 THEN 1 ELSE 0 END) AS unit3,
       COUNT(*) AS total
FROM your_view
WHERE org = 0
  AND ( :P_DEPARTMENTS IS NULL OR department IN (SELECT COLUMN_VALUE FROM TABLE(split_string(:P_DEPARTMENTS, ':'))) )
  AND status_start_date < SYSDATE
  AND status_end_date IS NULL

UNION ALL

SELECT 'NOW', '–ë—Ä–∏–≥–∞–¥ –ø—ñ–¥—Ä—è–¥–Ω–∏–∫—ñ–≤',
       SUM(CASE WHEN unit = 0 THEN 1 ELSE 0 END),
       SUM(CASE WHEN unit = 1 THEN 1 ELSE 0 END),
       SUM(CASE WHEN unit = 2 THEN 1 ELSE 0 END),
       COUNT(*)
FROM your_view
WHERE org = 1
  AND ( :P_DEPARTMENTS IS NULL OR department IN (SELECT COLUMN_VALUE FROM TABLE(split_string(:P_DEPARTMENTS, ':'))) )
  AND status_start_date < SYSDATE
  AND status_end_date IS NULL

UNION ALL

SELECT 'NOW', '–õ—é–¥–µ–π —Ñ—ñ—Ä–º–∏',
       SUM(CASE WHEN unit = 0 THEN team_count ELSE 0 END),
       SUM(CASE WHEN unit = 1 THEN team_count ELSE 0 END),
       SUM(CASE WHEN unit = 2 THEN team_count ELSE 0 END),
       SUM(team_count)
FROM your_view
WHERE org = 0
  AND ( :P_DEPARTMENTS IS NULL OR department IN (SELECT COLUMN_VALUE FROM TABLE(split_string(:P_DEPARTMENTS, ':'))) )
  AND status_start_date < SYSDATE
  AND status_end_date IS NULL

UNION ALL

SELECT 'NOW', '–õ—é–¥–µ–π –ø—ñ–¥—Ä—è–¥–Ω–∏–∫—ñ–≤',
       SUM(CASE WHEN unit = 0 THEN team_count ELSE 0 END),
       SUM(CASE WHEN unit = 1 THEN team_count ELSE 0 END),
       SUM(CASE WHEN unit = 2 THEN team_count ELSE 0 END),
       SUM(team_count)
FROM your_view
WHERE org = 1
  AND ( :P_DEPARTMENTS IS NULL OR department IN (SELECT COLUMN_VALUE FROM TABLE(split_string(:P_DEPARTMENTS, ':'))) )
  AND status_start_date < SYSDATE
  AND status_end_date IS NULL

-- –¢–µ–ø–µ—Ä –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ —Ç–∞–∫–∏–π –∂–µ UNION ALL –¥–ª—è –ø–µ—Ä—ñ–æ–¥—ñ–≤ DAY —ñ SHIFT (–∑ —ñ–Ω—à–∏–º–∏ —Ñ—ñ–ª—å—Ç—Ä–∞–º–∏ —á–∞—Å—É)
```

---

### ‚úÖ –î–∞–ª—ñ –∫—Ä–æ–∫–∏:

1. –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ **–Ω–æ–≤–∏–π Interactive Report** –∞–±–æ **Classic Report** –Ω–∞ –±–∞–∑—ñ —Ü—å–æ–≥–æ SQL.

2. –î–æ–¥–∞—Ç–∏ **Standard Download button** (`Actions ‚Üí Download ‚Üí CSV / Excel`).

3. –Ø–∫—â–æ —Ç—Ä–µ–±–∞ ‚Äî —Å—Ö–æ–≤–∞—Ç–∏ —Ü–µ–π –Ω–æ–≤–∏–π –∑–≤—ñ—Ç –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (—â–æ–± –π–æ–≥–æ –±–∞—á–∏–ª–∏ –ª–∏—à–µ —á–µ—Ä–µ–∑ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—É –∫–Ω–æ–ø–∫—É "–ï–∫—Å–ø–æ—Ä—Ç").

---

### üì¢ –ü–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞–∫–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É:
- –†–µ–∞–ª—å–Ω–∏–π **—Ç–∞–±–ª–∏—á–Ω–∏–π SQL**, –±–µ–∑ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó HTML.
- –ú–æ–∂–Ω–∞ –ª–µ–≥–∫–æ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ –≤–±—É–¥–æ–≤–∞–Ω—ñ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ APEX.
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó, —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è, –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó.
- –ú–æ–∂–µ—à —â–µ –π –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ –ø—ñ–¥–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏ —â–æ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏.

---

### ‚ö° –ü–∏—Ç–∞–Ω–Ω—è –¥–æ —É—Ç–æ—á–Ω–µ–Ω–Ω—è:

- –•–æ—á–µ—à, —è —â–µ –∑—Ä–∞–∑—É –Ω–∞–ø–∏—à—É –ø–æ–≤–Ω—É –≤–µ—Ä—Å—ñ—é –Ω–∞ 3 –ø–µ—Ä—ñ–æ–¥–∏ (`NOW`, `DAY`, `SHIFT`) –≤ –æ–¥–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è –∫–æ–¥—É?
- –ß–∏ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞ –∑—Ä–æ–±–∏—Ç–∏ —Ü—é –≤–∏–±—ñ—Ä–∫—É —á–µ—Ä–µ–∑ `WITH` (CTE) —â–æ–± –Ω–µ –¥—É–±–ª—é–≤–∞—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏ –≤ –∫–æ–∂–Ω–æ–º—É –±–ª–æ—Ü—ñ `UNION ALL`?

---

–¢—Ä–µ–±–∞ —â–µ —à–≤–∏–¥–∫–æ –¥–æ–ø–æ–º–æ–≥—Ç–∏ –∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è–º –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ (–ø–µ—Ä–µ–∫–ª–∞—Å—Ç–∏ "NOW" –Ω–∞ "–ó–∞—Ä–∞–∑" —ñ —Ç.–¥.)? üöÄ  
–Ø–∫—â–æ —Ç–∞–∫ ‚Äî —Å–∫–∞–∂–∏, —ñ —è –∑—Ä–∞–∑—É –¥–æ–ø–∏—à—É!