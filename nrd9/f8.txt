–ß—É–¥–æ–≤–æ –ø–æ—è—Å–Ω–∏–ª–∏! –î–∞–≤–∞–π—Ç–µ —Ä–æ–∑–∫–ª–∞–¥–µ–º–æ –ø–æ –ø—É–Ω–∫—Ç–∞—Ö, —è–∫ –≤–∏—Ä—ñ—à–∏—Ç–∏ –≤–∞—à –∑–∞–ø–∏—Ç.

---

## 1. **–Ø–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ –≤ Excel —É APEX**

–£ –≤–∞—Å –∑–∞—Ä–∞–∑ —î **Interactive Report** –Ω–∞ –æ—Å–Ω–æ–≤—ñ `V_OUTFIT_PIVOT_BASE`. –©–æ–± –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–∞–Ω—ñ –≤ Excel:

‚úÖ –í APEX –≤ IR –≤–∂–µ —î –≤–±—É–¥–æ–≤–∞–Ω–∞ –æ–ø—Ü—ñ—è **"Download ‚Üí Excel"**.

–ü—Ä–æ—Å—Ç–æ:
- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ —É –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—è—Ö Interactive Report —É–≤—ñ–º–∫–Ω–µ–Ω–æ:
  - ‚úÖ **Download** (Allow Download = Yes)
  - ‚úÖ **Excel** (Format = Excel)

–¢–æ–¥—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–º–æ–∂–µ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ "Actions ‚Üí Download ‚Üí Excel" —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–∞–º–µ —Ç—É –≤–∏–±—ñ—Ä–∫—É, —è–∫–∞ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∞ –∑–∞ —Ñ—ñ–ª—å—Ç—Ä–∞–º–∏ (`:P_MODAL_DEPARTMENTS`, `:P_MODAL_TIMEMODE` —Ç–æ—â–æ).

**‚ÑπÔ∏è –í–∞–∂–ª–∏–≤–æ:**  
Excel-—Ñ–∞–π–ª –±—É–¥–µ –º—ñ—Å—Ç–∏—Ç–∏ —Ä—ñ–≤–Ω–æ —Ç—ñ –¥–∞–Ω—ñ, —è–∫—ñ –≤–∏–¥–Ω–æ –≤ Interactive Report. –ù—ñ—á–æ–≥–æ –æ–∫—Ä–µ–º–æ –¥–ª—è —Ü—å–æ–≥–æ –ø–∏—Å–∞—Ç–∏ –Ω–µ —Ç—Ä–µ–±–∞.

---

## 2. **–Ø–∫ –ø–æ –æ–¥–Ω–æ–º—É –∫–ª—ñ–∫—É –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ –¥–∞–Ω—ñ, —ñ —Å—É–º–∞—Ä–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é**

–í–∞—à –≤–∞—Ä—ñ–∞–Ω—Ç **—Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è** –∑–≤—ñ—Ç—ñ–≤ (–¥–∞–Ω—ñ + –æ–∫—Ä–µ–º–æ –ø—ñ–¥—Å—É–º–∫–∏) –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∑ —Ç–æ—á–∫–∏ –∑–æ—Ä—É –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ APEX.

–©–æ–± –ø–æ –æ–¥–Ω–æ–º—É –∫–ª—ñ–∫—É –æ—Ç—Ä–∏–º–∞—Ç–∏ **–≤ –æ–¥–∏–Ω —Ñ–∞–π–ª** —ñ –¥–∞–Ω—ñ, —ñ —Å—É–º—É, –º–æ–∂–Ω–∞ –ø—ñ—Ç–∏ –¥–≤–æ–º–∞ —à–ª—è—Ö–∞–º–∏:

---

### üîµ –í–∞—Ä—ñ–∞–Ω—Ç 1. –°—Ç–≤–æ—Ä–∏—Ç–∏ **SQL-–∑–∞–ø–∏—Ç UNION ALL** –∑ –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º –∑–∞–≥–∞–ª—å–Ω–æ—ó —Å—É–º–∏

**–ü—Ä–∏–∫–ª–∞–¥:**

```sql
SELECT
  group_name,
  org,
  unit,
  department,
  data_start,
  status_start_date,
  status_end_date,
  u1_people,
  u1_brigades,
  u2_people,
  u2_brigades,
  u3_people,
  u3_brigades,
  total_people,
  total_brigades,
  'DATA' AS row_type
FROM v_outfit_pivot_base
WHERE 1=1
  AND (:P_MODAL_DEPARTMENTS IS NULL OR department IN (
           SELECT column_value FROM TABLE(split_string(:P_MODAL_DEPARTMENTS, ':'))
       ))
  AND (
    (:P_MODAL_TIMEMODE = 'NOW' AND status_start_date < SYSDATE AND status_end_date IS NULL)
    OR (:P_MODAL_TIMEMODE = 'DAY' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= TRUNC(SYSDATE)))
    OR (:P_MODAL_TIMEMODE = 'SHIFT' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= :P_SHIFT_START))
  )
UNION ALL
SELECT
  'TOTAL' AS group_name,
  NULL AS org,
  NULL AS unit,
  NULL AS department,
  NULL AS data_start,
  NULL AS status_start_date,
  NULL AS status_end_date,
  SUM(u1_people),
  SUM(u1_brigades),
  SUM(u2_people),
  SUM(u2_brigades),
  SUM(u3_people),
  SUM(u3_brigades),
  SUM(total_people),
  SUM(total_brigades),
  'TOTAL' AS row_type
FROM v_outfit_pivot_base
WHERE 1=1
  AND (:P_MODAL_DEPARTMENTS IS NULL OR department IN (
           SELECT column_value FROM TABLE(split_string(:P_MODAL_DEPARTMENTS, ':'))
       ))
  AND (
    (:P_MODAL_TIMEMODE = 'NOW' AND status_start_date < SYSDATE AND status_end_date IS NULL)
    OR (:P_MODAL_TIMEMODE = 'DAY' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= TRUNC(SYSDATE)))
    OR (:P_MODAL_TIMEMODE = 'SHIFT' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= :P_SHIFT_START))
  )
```

üß© **–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
- –ó–≤–∏—á–∞–π–Ω—ñ —Ä—è–¥–∫–∏ (DATA)
- –í –∫—ñ–Ω—Ü—ñ –æ–¥–∏–Ω —Ä—è–¥–æ–∫ —ñ–∑ –∑–∞–≥–∞–ª—å–Ω–æ—é —Å—É–º–æ—é (TOTAL)
- –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –∑—Ä–æ–±–∏—Ç–∏ —Å—Ç–∏–ª—å —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ CSS –≤ IR (`row_type` = 'TOTAL' –≤–∏–¥—ñ–ª–∏—Ç–∏ –∂–∏—Ä–Ω–∏–º/–∫–æ–ª—å–æ—Ä–æ–º).

---
### üîµ –í–∞—Ä—ñ–∞–Ω—Ç 2. –°—Ç–≤–æ—Ä–∏—Ç–∏ **–¥–≤–∞ –æ–∫—Ä–µ–º–∏—Ö Interactive Report –Ω–∞ –æ–¥–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ**

- –ü–µ—Ä—à–∏–π IR ‚Äî –≤–∞—à –æ—Å–Ω–æ–≤–Ω–∏–π —Å–ø–∏—Å–æ–∫
- –î—Ä—É–≥–∏–π IR ‚Äî –ø—ñ–¥—Å—É–º–æ–∫ (–∞–≥—Ä–µ–≥–∞—Ç–Ω–∞ –≤–∏–±—ñ—Ä–∫–∞ `SUM()`)
- –û–±–∏–¥–≤–∞ –∑–≤—ñ—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –Ω–∞ —Ç–∏—Ö –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö (`:P_MODAL_DEPARTMENTS`, `:P_MODAL_TIMEMODE`)

–¢–æ–¥—ñ –ø—Ä–∏ –µ–∫—Å–ø–æ—Ä—Ç—ñ ‚Äî –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±—É–¥–µ –æ–∫—Ä–µ–º–æ –Ω–∞—Ç–∏—Å–∫–∞—Ç–∏ Download –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ IR.

‚úÖ –ü—Ä–æ—Å—Ç—ñ—à–µ –∑ —Ç–æ—á–∫–∏ –∑–æ—Ä—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ (–æ—Å–æ–±–ª–∏–≤–æ –Ω–∞ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö)  
‚úÖ –õ–µ–≥–∫–æ –∫–µ—Ä—É–≤–∞—Ç–∏ –æ–∫—Ä–µ–º–æ –≤–∏–≥–ª—è–¥–æ–º

---

# üìã –í–∏—Å–Ω–æ–≤–æ–∫:
| –í–∞—Ä—ñ–∞–Ω—Ç        | –ü–µ—Ä–µ–≤–∞–≥–∏                            | –ù–µ–¥–æ–ª—ñ–∫–∏                       |
|:---------------|:-------------------------------------|:-------------------------------|
| UNION ALL      | –û–¥–∏–Ω —Ñ–∞–π–ª —ñ–∑ –¥–∞–Ω–∏–º–∏ —Ç–∞ —Å—É–º–æ—é         | –°–∫–ª–∞–¥–Ω—ñ—à–∏–π SQL, –º–æ–∂–ª–∏–≤–æ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ |
| 2 –æ–∫—Ä–µ–º–∏—Ö IR   | –õ–µ–≥–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å —ñ –≥–Ω—É—á–∫—ñ—Å—Ç—å          | –ü–æ—Ç—Ä—ñ–±–Ω–æ –¥–≤—ñ—á—ñ –Ω–∞—Ç–∏—Å–∫–∞—Ç–∏ Download |

---

–•–æ—á–µ—Ç–µ ‚Äî —è –æ–¥—Ä–∞–∑—É –¥–æ–ø–æ–º–æ–∂—É –≤–∞–º —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≥–æ—Ç–æ–≤–∏–π –∑–∞–ø–∏—Ç –∑ **`UNION ALL`** —ñ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ñ–æ—Ä–º–∏—Ç–∏ –π–æ–≥–æ –¥–ª—è Interactive Report? üöÄ  
**–ß–∏ —Ö–æ—á–µ—Ç–µ –≤–∞—Ä—ñ–∞–Ω—Ç –∑ –¥–≤–æ–º–∞ –æ–∫—Ä–µ–º–∏–º–∏ –∑–≤—ñ—Ç–∞–º–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ?**  

–Ø–∫ –æ–±–∏—Ä–∞—î—Ç–µ? üî•