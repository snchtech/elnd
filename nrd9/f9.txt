–û—Å—å –ø–æ–≤–Ω—ñ—Å—Ç—é –≥–æ—Ç–æ–≤–∏–π SQL-–∑–∞–ø–∏—Ç –∑ `UNION ALL`, —è–∫–∏–π –≤–∏ –º–æ–∂–µ—Ç–µ –≤—Å—Ç–∞–≤–∏—Ç–∏ —É –≤–∞—à **Interactive Report** —É APEX. –í—ñ–Ω:

- –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –≤—Å—ñ –¥–∞–Ω—ñ –∑ `V_OUTFIT_PIVOT_BASE` –∑–≥—ñ–¥–Ω–æ —Ñ—ñ–ª—å—Ç—Ä—ñ–≤,
- –¥–æ–¥–∞—î –≤–Ω–∏–∑—É –æ–¥–∏–Ω —Ä—è–¥–æ–∫ –∑ **—Å—É–º–∞—Ä–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏** –ø–æ –ª—é–¥—è–º —ñ –±—Ä–∏–≥–∞–¥–∞–º,
- –º—ñ—Å—Ç–∏—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤–µ –ø–æ–ª–µ `row_type`, —â–æ–± –ª–µ–≥–∫–æ —Å—Ç–∏–ª—ñ–∑—É–≤–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π —Ä—è–¥–æ–∫.

---

### ‚úÖ **SQL-–∑–∞–ø–∏—Ç –¥–ª—è Interactive Report**

```sql
SELECT
  group_name,
  org,
  unit,
  department,
  data_start,
  status_start_date,
  status_end_date,
  u1_people,
  u1_brigades,
  u2_people,
  u2_brigades,
  u3_people,
  u3_brigades,
  total_people,
  total_brigades,
  'DATA' AS row_type
FROM v_outfit_pivot_base
WHERE 1=1
  AND (:P_MODAL_DEPARTMENTS IS NULL 
       OR department IN (
           SELECT column_value FROM TABLE(split_string(:P_MODAL_DEPARTMENTS, ':'))
       )
      )
  AND (
    (:P_MODAL_TIMEMODE = 'NOW' AND status_start_date < SYSDATE AND status_end_date IS NULL)
    OR (:P_MODAL_TIMEMODE = 'DAY' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= TRUNC(SYSDATE)))
    OR (:P_MODAL_TIMEMODE = 'SHIFT' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= :P_SHIFT_START))
  )

UNION ALL

SELECT
  '–ó–ê–ì–ê–õ–û–ú' AS group_name,
  NULL AS org,
  NULL AS unit,
  NULL AS department,
  NULL AS data_start,
  NULL AS status_start_date,
  NULL AS status_end_date,
  SUM(u1_people),
  SUM(u1_brigades),
  SUM(u2_people),
  SUM(u2_brigades),
  SUM(u3_people),
  SUM(u3_brigades),
  SUM(total_people),
  SUM(total_brigades),
  'TOTAL' AS row_type
FROM v_outfit_pivot_base
WHERE 1=1
  AND (:P_MODAL_DEPARTMENTS IS NULL 
       OR department IN (
           SELECT column_value FROM TABLE(split_string(:P_MODAL_DEPARTMENTS, ':'))
       )
      )
  AND (
    (:P_MODAL_TIMEMODE = 'NOW' AND status_start_date < SYSDATE AND status_end_date IS NULL)
    OR (:P_MODAL_TIMEMODE = 'DAY' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= TRUNC(SYSDATE)))
    OR (:P_MODAL_TIMEMODE = 'SHIFT' AND status_start_date < SYSDATE AND (status_end_date IS NULL OR status_end_date >= :P_SHIFT_START))
  )
```

---

### üé® **–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ: —Å—Ç–∏–ª—ñ–∑—É–π—Ç–µ —Ä—è–¥–æ–∫ Total**

1. –£–≤—ñ–º–∫–Ω—ñ—Ç—å –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å **Static ID** —É –≤–∞—à–æ–º—É Interactive Report, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:  
   ```
   Static ID = pivotReportWithTotal
   ```

2. –î–æ–¥–∞–π—Ç–µ CSS (—á–µ—Ä–µ–∑ —Å—Ç–æ—Ä—ñ–Ω–∫—É ‚Üí Inline CSS –∞–±–æ —à–∞–±–ª–æ–Ω):
```css
#pivotReportWithTotal .t-Report-report tr td:last-child {
  font-weight: bold;
}
#pivotReportWithTotal .t-Report-report tr td[rowspan] {
  background-color: #f6f6f6;
}
#pivotReportWithTotal .t-Report-report tr td,
#pivotReportWithTotal .t-Report-report tr th {
  white-space: nowrap;
}
#pivotReportWithTotal .t-Report-report tr td[row_type="TOTAL"] {
  background-color: #e0f3e0;
  font-weight: bold;
}
```

3. –ê–±–æ –¥–æ–¥–∞–π—Ç–µ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π **row CSS class**:
   - –£ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—è—Ö Interactive Report ‚Üí Attributes ‚Üí Row CSS Classes ‚Üí  
     ```
     CASE WHEN row_type = 'TOTAL' THEN 'highlight-total' END
     ```
   - –Ü CSS:
     ```css
     .highlight-total td {
       background-color: #f9f9b7 !important;
       font-weight: bold;
     }
     ```

---

üîÅ –¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –ø—Ä–∞—Ü—é—î –≤—ñ–¥—Ä–∞–∑—É –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ **Excel**, —ñ –≤—Å—ñ —Ñ—ñ–ª—å—Ç—Ä–∏ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º—É—Ç—å –Ω–∞–ª–µ–∂–Ω–æ.

–•–æ—á–µ—Ç–µ —Ç–∞–∫–æ–∂ –¥–æ–ø–æ–º–æ–≥—É –ø–æ –∫–Ω–æ–ø—Ü—ñ "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ Excel" –∞–±–æ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Ñ–∞–π–ª—É —á–µ—Ä–µ–∑ WebSocket / PL/SQL ‚Äî —Ç–µ–∂ –ø—ñ–¥–∫–∞–∂—É. –ì–æ—Ç–æ–≤—ñ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏?