–©–æ–± –¥—ñ—Å—Ç–∞—Ç–∏ **–ø–æ—Å–∞–¥—É**, **–≤—ñ–¥–¥—ñ–ª**, —Ç–∞ **–ø—É–Ω–∫—Ç** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –¥–æ–¥–∞—Ç–∫—É, —Å–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ—Å—è –¥–∞–Ω–∏–º–∏, —è–∫—ñ –º–∏ –∑–±–µ—Ä–µ–≥–ª–∏ –ø—ñ–¥ —á–∞—Å –ª–æ–≥—ñ–Ω—É –≤ **AuthContext**.  
–î–∞–ª—ñ –ø–æ–∫–∞–∂—É, —è–∫ —Ü—ñ –¥–∞–Ω—ñ –º–æ–∂–Ω–∞ –∑—Ä—É—á–Ω–æ –≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏ –Ω–∞ –±—É–¥—å-—è–∫—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ.

---

### üìÇ **1. –î–æ–¥–∞–º–æ –ø–æ–ª—è –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**

–û–Ω–æ–≤–∏–º–æ `AuthContext.js`, —â–æ–± –≤—Ä–∞—Ö—É–≤–∞—Ç–∏ **–ø–æ–∑–∏—Ü—ñ—é**, **–≤—ñ–¥–¥—ñ–ª** —ñ **–ø—É–Ω–∫—Ç**.

#### üîë `/context/AuthContext.js`

```javascript
'use client';
import { createContext, useContext, useState, useEffect } from 'react';

const AuthContext = createContext();

export const AuthProvider = ({ children }) => {
  const [user, setUser] = useState(null);

  useEffect(() => {
    const storedUser = localStorage.getItem('user');
    if (storedUser) {
      setUser(JSON.parse(storedUser));
    }
  }, []);

  const login = (userData) => {
    setUser(userData);
    localStorage.setItem('user', JSON.stringify(userData));  // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  };

  const logout = () => {
    setUser(null);
    localStorage.removeItem('user');
  };

  return (
    <AuthContext.Provider value={{ user, login, logout }}>
      {children}
    </AuthContext.Provider>
  );
};

export const useAuth = () => useContext(AuthContext);
```

---

### üìã **2. –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**

–¢–µ–ø–µ—Ä –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—ñ –¥–∞–Ω—ñ –Ω–∞ –±—É–¥—å-—è–∫—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ.  
–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–æ–¥–∞–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É **Editor**.

#### üìù `/pages/editor.js`

```javascript
'use client';
import React from 'react';
import { Box, Typography, Divider } from '@mui/material';
import withAuth from '../middleware/withAuth';
import { useAuth } from '../context/AuthContext';

const EditorPage = () => {
  const { user } = useAuth();

  return (
    <Box sx={{ padding: 4 }}>
      <Typography variant="h4" gutterBottom>–†–µ–¥–∞–∫—Ç–æ—Ä —Å—Ö–µ–º</Typography>

      <Divider sx={{ my: 2 }} />

      {user ? (
        <Box sx={{ mb: 4 }}>
          <Typography variant="h6">–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:</Typography>
          <Typography><strong>–Ü–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:</strong> {user.username}</Typography>
          <Typography><strong>–ü–æ—Å–∞–¥–∞:</strong> {user.position}</Typography>
          <Typography><strong>–í—ñ–¥–¥—ñ–ª:</strong> {user.department}</Typography>
          <Typography><strong>–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª:</strong> {user.unit}</Typography>
          <Typography><strong>–†–æ–ª—ñ:</strong> {user.roles.join(', ')}</Typography>
        </Box>
      ) : (
        <Typography color="error">–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.</Typography>
      )}

      <Typography variant="body1">
        –¢—É—Ç –±—É–¥–µ –≤–∞—à —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å—Ö–µ–º. –¢—ñ–ª—å–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑ —Ä–æ–ª–ª—é <strong>Editor</strong> –º–∞—é—Ç—å –¥–æ—Å—Ç—É–ø.
      </Typography>
    </Box>
  );
};

export default withAuth(EditorPage, 'Editor');
```

---

### ‚ö° **3. –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î**

1. **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—Ö–æ–¥–∏—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É.**  
   –ü—ñ—Å–ª—è –ª–æ–≥—ñ–Ω—É –π–æ–≥–æ –¥–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –≤ `localStorage` —á–µ—Ä–µ–∑ `AuthContext`.

2. **–î–∞–Ω—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—ñ–¥—Ç—è–≥–Ω—É—Ç—å—Å—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É.**  
   –ó–∞–≤–¥—è–∫–∏ —Ö—É–∫—É `useAuth()` –º–∏ –º–æ–∂–µ–º–æ –ª–µ–≥–∫–æ –≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é.

3. **–†–æ–ª—ñ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å—Å—è.**  
   Middleware `withAuth` –ø—É—Å–∫–∞—î –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –ª–∏—à–µ —Ç–∏—Ö, —Ö—Ç–æ –º–∞—î –ø–æ—Ç—Ä—ñ–±–Ω—É —Ä–æ–ª—å.

---

### üí° **–ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è**

```plaintext
–†–µ–¥–∞–∫—Ç–æ—Ä —Å—Ö–µ–º
------------------------------
–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:
–Ü–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞: user123
–ü–æ—Å–∞–¥–∞: –Ü–Ω–∂–µ–Ω–µ—Ä
–í—ñ–¥–¥—ñ–ª: –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π –≤—ñ–¥–¥—ñ–ª
–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª: –ü—ñ–¥—Ä–æ–∑–¥—ñ–ª 1
–†–æ–ª—ñ: auth, scheme_user, Editor
```

---

### üîê **–î–æ–¥–∞—Ç–∫–æ–≤–æ: –ó–∞—Ö–∏—Å—Ç –¥–∞–Ω–∏—Ö**

1. **JWT –¢–æ–∫–µ–Ω:**  
   –î–∞–Ω—ñ –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –∑–∞—Ö–∏—Å—Ç–∏—Ç–∏, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ —Ç–æ–∫–µ–Ω —É `httpOnly` cookie. –¶–µ –∑–º–µ–Ω—à–∏—Ç—å —Ä–∏–∑–∏–∫ XSS-–∞—Ç–∞–∫.

2. **Middleware:**  
   –î–ª—è –≤–∞–∂–ª–∏–≤–∏—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –¥–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ä–æ–ª–µ–π —á–µ—Ä–µ–∑ middleware.

3. **–û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö:**  
   –Ø–∫—â–æ –ø–æ—Å–∞–¥–∞ –∞–±–æ –≤—ñ–¥–¥—ñ–ª –∑–º—ñ–Ω—é—é—Ç—å—Å—è –≤ –ë–î, –¥–æ–¥–∞—Ç–∏ –µ–Ω–¥–ø–æ—ñ–Ω—Ç –¥–ª—è –ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

---

–¢–∞–∫–∏–º —á–∏–Ω–æ–º –º–∏ –Ω–∞–¥—ñ–π–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ –±—É–¥—å-—è–∫—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ.