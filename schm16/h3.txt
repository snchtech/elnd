### ‚úÖ **–§—É–Ω–∫—Ü—ñ—è `isAuth` –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–∞–ª—ñ–¥–Ω–æ—Å—Ç—ñ —Ç–æ–∫–µ–Ω—ñ–≤ —É HTTP-only cookie**
–û—Å–∫—ñ–ª—å–∫–∏ `accessToken` —Ç–∞ `refreshToken` **–∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ HTTP-only cookies**, –º–∏ –Ω–µ –º–æ–∂–µ–º–æ —ó—Ö –æ—Ç—Ä–∏–º–∞—Ç–∏ —á–µ—Ä–µ–∑ `JavaScript`. –¢–æ–º—É –ª–æ–≥—ñ–∫—É –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –Ω–∞ **—Å–µ—Ä–≤–µ—Ä–Ω–æ–º—É API** `/api/auth/checkAuth`, —è–∫–∏–π:
1. **–ß–∏—Ç–∞—î —Ç–æ–∫–µ–Ω–∏ –∑ HTTP-only cookies**.
2. **–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ `accessToken` –≤–∞–ª—ñ–¥–Ω–∏–π**:
   - –Ø–∫—â–æ —Ç–∞–∫ ‚Üí –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π.
   - –Ø–∫—â–æ `accessToken` –∑–∞–∫—ñ–Ω—á–∏–≤—Å—è, –ø–µ—Ä–µ–≤—ñ—Ä—è—î `refreshToken`.
3. **–Ø–∫—â–æ `refreshToken` —Ç–∞–∫–æ–∂ –Ω–µ–¥—ñ–π—Å–Ω–∏–π ‚Üí –≤–∏–∫–æ–Ω—É—î logout —ñ —Ä–µ–¥—ñ—Ä–µ–∫—Ç**.

---

## üîπ **üìå 1. –°–µ—Ä–≤–µ—Ä–Ω–∏–π API –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó (`pages/api/auth/checkAuth.js`)**
```javascript
import { parse } from 'cookie';
import jwt from 'jsonwebtoken';

export default function handler(req, res) {
  try {
    // –û—Ç—Ä–∏–º—É—î–º–æ cookies
    const cookies = parse(req.headers.cookie || '');

    const accessToken = cookies.accessToken;
    const refreshToken = cookies.refreshToken;

    // –Ø–∫—â–æ –Ω–µ–º–∞—î accessToken —Ç–∞ refreshToken ‚Äì –≤–∏—Ö—ñ–¥
    if (!accessToken && !refreshToken) {
      return res.status(401).json({ isAuth: false, message: 'No tokens found' });
    }

    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ accessToken
    try {
      const decodedAccessToken = jwt.verify(accessToken, process.env.JWT_SECRET);
      return res.status(200).json({ isAuth: true, user: decodedAccessToken });
    } catch (accessError) {
      // –Ø–∫—â–æ accessToken –Ω–µ–¥—ñ–π—Å–Ω–∏–π, –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ refreshToken
      try {
        const decodedRefreshToken = jwt.verify(refreshToken, process.env.JWT_SECRET);

        // –Ø–∫—â–æ refreshToken —â–µ –¥—ñ–π—Å–Ω–∏–π, –≤–≤–∞–∂–∞—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–º
        return res.status(200).json({ isAuth: true, refreshSession: true });
      } catch (refreshError) {
        // –Ø–∫—â–æ refreshToken —Ç–µ–∂ –Ω–µ–¥—ñ–π—Å–Ω–∏–π ‚Äì —Ä–æ–±–∏–º–æ logout
        res.setHeader('Set-Cookie', [
          'accessToken=; HttpOnly; Path=/; Max-Age=0',
          'refreshToken=; HttpOnly; Path=/; Max-Age=0',
        ]);
        return res.status(401).json({ isAuth: false, message: 'Session expired' });
      }
    }
  } catch (error) {
    return res.status(500).json({ isAuth: false, message: 'Internal server error' });
  }
}
```

---

## üîπ **üìå 2. –§—É–Ω–∫—Ü—ñ—è `isAuth` –Ω–∞ –∫–ª—ñ—î–Ω—Ç—ñ (`utils/auth.js`)**
–¶—è —Ñ—É–Ω–∫—Ü—ñ—è:
- –í–∏–∫–æ–Ω—É—î –∑–∞–ø–∏—Ç –¥–æ `/api/auth/checkAuth` –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å–µ—Å—ñ—ó.
- –Ø–∫—â–æ `isAuth === false`, –≤–∏–∫–æ–Ω—É—î **logout —ñ —Ä–µ–¥—ñ—Ä–µ–∫—Ç**.

```javascript
export const isAuth = async () => {
  try {
    const response = await fetch('/api/auth/checkAuth', {
      method: 'GET',
      credentials: 'include', // –ü–µ—Ä–µ–¥–∞—î cookies
      headers: { 'Content-Type': 'application/json' },
    });

    const data = await response.json();

    if (!data.isAuth) {
      // –Ø–∫—â–æ —Å–µ—Å—ñ—è –∑–∞–∫—ñ–Ω—á–∏–ª–∞—Å—è, –≤–∏–∫–æ–Ω—É—î–º–æ logout
      await fetch('/api/auth/logout', { method: 'POST', credentials: 'include' });
      window.location.href = '/login';
      return false;
    }

    return true;
  } catch (error) {
    console.error('Error checking auth:', error);
    return false;
  }
};
```

---

## üîπ **üìå 3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `isAuth` —É HOC `withAuth.js`**
```javascript
'use client';

import { useRouter } from 'next/navigation';
import { useEffect, useState } from 'react';
import { isAuth } from '../utils/auth';

const withAuth = (WrappedComponent) => {
  const AuthHOC = (props) => {
    const router = useRouter();
    const [loading, setLoading] = useState(true);

    useEffect(() => {
      const checkAuthentication = async () => {
        const authenticated = await isAuth();
        if (!authenticated) {
          router.push('/login');
        } else {
          setLoading(false);
        }
      };

      checkAuthentication();
    }, []);

    if (loading) {
      return <p>Loading...</p>;
    }

    return <WrappedComponent {...props} />;
  };

  AuthHOC.displayName = `withAuth(${WrappedComponent.displayName || WrappedComponent.name || 'Component'})`;

  return AuthHOC;
};

export default withAuth;
```

---

## üîπ **üìå 4. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `withAuth` —É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ**
```javascript
import withAuth from '../hoc/withAuth';

const Dashboard = () => {
  return <h1>Welcome to the Dashboard</h1>;
};

export default withAuth(Dashboard);
```

---

## üîπ **üìå 5. API `/api/auth/logout.js`**
–û—á–∏—â–∞—î `accessToken` —Ç–∞ `refreshToken`:
```javascript
export default function handler(req, res) {
  res.setHeader('Set-Cookie', [
    'accessToken=; HttpOnly; Path=/; Max-Age=0',
    'refreshToken=; HttpOnly; Path=/; Max-Age=0',
  ]);
  res.status(200).json({ message: 'Logged out' });
}
```

---

## **‚úÖ –©–æ –º–∏ –æ—Ç—Ä–∏–º–∞–ª–∏**
‚úî **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ–∫–µ–Ω—ñ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ —á–µ—Ä–µ–∑ `/api/auth/checkAuth`**  
‚úî **–§—É–Ω–∫—Ü—ñ—è `isAuth` –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é —ñ –≤–∏–∫–æ–Ω—É—î logout –ø—Ä–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ**  
‚úî **HOC `withAuth` –∑–∞—Ö–∏—â–∞—î —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —ñ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞ –ª–æ–≥—ñ–Ω**  
‚úî **–ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ñ —Å–µ—Å—ñ—ó –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è logout —ñ —Ä–µ–¥—ñ—Ä–µ–∫—Ç**  

üîπ **–¢–µ–ø–µ—Ä —Ç–≤–æ—î —Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–∞—Ü—é—î, —è–∫ –∫–ª–∞—Å–∏—á–Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω–∞ —Å–µ—Å—ñ—è!** üöÄ