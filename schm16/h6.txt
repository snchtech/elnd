–¢–∞–∫, —Ç–∏ –º–æ–∂–µ—à –ø–æ–∫—Ä–∞—â–∏—Ç–∏ `middleware.js`, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ñ—É–Ω–∫—Ü—ñ—é `isAuth()`, —â–æ–± **—É–Ω—ñ—Ñ—ñ–∫—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** –º—ñ–∂ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º —ñ –±–µ–∫–µ–Ω–¥–æ–º.

### üîπ **üìå –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è Middleware**
1. **–ó–∞–º—ñ—Å—Ç—å `jwt.verify` ‚Äì –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ `isAuth()` –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ**  
   - –ú–∏ –Ω–µ –º–æ–∂–µ–º–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ `isAuth()` –Ω–∞–ø—Ä—è–º—É, –∞–ª–µ –º–æ–∂–µ–º–æ –∑—Ä–æ–±–∏—Ç–∏ `fetch` –¥–æ `/api/auth/checkAuth`.
2. **–Ø–∫—â–æ `accessToken` –Ω–µ–≤–∞–ª—ñ–¥–Ω–∏–π, –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ `refreshToken`.**  
   - –Ø–∫—â–æ `refreshToken` —â–µ –¥—ñ—î ‚Äì –¥–æ–∑–≤–æ–ª—è—î–º–æ –∑–∞–ø–∏—Ç (`NextResponse.next()`).
   - –Ø–∫—â–æ –æ–±–∏–¥–≤–∞ —Ç–æ–∫–µ–Ω–∏ –Ω–µ–¥—ñ–π—Å–Ω—ñ ‚Äì —Ä–µ–¥—ñ—Ä–µ–∫—Ç –Ω–∞ `/login`.
3. **–ù–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ `SECRET_KEY` —É middleware**  
   - –í—ñ–Ω –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É, –±–æ —Ç–æ–∫–µ–Ω–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å—Å—è —á–µ—Ä–µ–∑ –±–µ–∫–µ–Ω–¥ API.

---

## üîπ **üìå –û–Ω–æ–≤–ª–µ–Ω–∏–π `middleware.js`**
```javascript
import { NextResponse } from "next/server";

export async function middleware(req) {
  const { cookies } = req; // –û—Ç—Ä–∏–º—É—î–º–æ cookies

  // –í–∏–∫–æ–Ω—É—î–º–æ –∑–∞–ø–∏—Ç –¥–æ API –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞
  const authCheckResponse = await fetch(`${req.nextUrl.origin}/api/auth/checkAuth`, {
    method: "GET",
    credentials: "include",
    headers: {
      "Content-Type": "application/json",
      Cookie: req.headers.get("cookie") || "", // –ü–µ—Ä–µ–¥–∞—î–º–æ cookies –¥–æ –±–µ–∫–µ–Ω–¥—É
    },
  });

  const authData = await authCheckResponse.json();

  if (!authData.isAuth) {
    return NextResponse.redirect(new URL("/login", req.url));
  }

  return NextResponse.next(); // –î–æ–∑–≤–æ–ª—è—î–º–æ –¥–æ—Å—Ç—É–ø
}

export const config = {
  matcher: ["/", "/profile", "/dashboard"], // –ó–∞—Ö–∏—â–µ–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
};
```

---

## üîπ **üìå –ß–æ–º—É —Ü–µ –∫—Ä–∞—â–µ?**
| ‚ùå –°—Ç–∞—Ä–∏–π `middleware.js` | ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–∏–π `middleware.js` |
|--------------------------|----------------------------|
| –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤ `jwt.verify` –ø—Ä—è–º–æ –≤ middleware | –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–µ—Ä–≤–µ—Ä–Ω–∏–π `/api/auth/checkAuth`, —â–æ –±–µ–∑–ø–µ—á–Ω—ñ—à–µ |
| –ü—Ä–∞—Ü—é–≤–∞–≤ —Ç—ñ–ª—å–∫–∏ –∑ `accessToken` | –ü–µ—Ä–µ–≤—ñ—Ä—è—î —ñ `refreshToken`, —è–∫—â–æ `accessToken` –∑–∞–∫—ñ–Ω—á–∏–≤—Å—è |
| `SECRET_KEY` –±—É–≤ —É middleware (–ø–æ–≥–∞–Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞) | –ë–µ–∫–µ–Ω–¥ —Å–∞–º –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ç–æ–∫–µ–Ω, middleware –Ω–µ –∑–Ω–∞—î —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ |
| –ù–µ –º—ñ–≥ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ `HTTP-only cookies` | –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `credentials: include`, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ–≤—ñ—Ä–∫—É `refreshToken` |

---

## üîπ **üìå –ü—ñ–¥—Å—É–º–æ–∫**
‚úÖ **Middleware —Ç–µ–ø–µ—Ä –ø—Ä–∞—Ü—é—î —á–µ—Ä–µ–∑ API `/api/auth/checkAuth`** ‚Üí –û–¥–∏–Ω —Å–ø–æ—Å—ñ–± –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó.  
‚úÖ **–ë–µ–∫–µ–Ω–¥ —Å–∞–º –ø–µ—Ä–µ–≤—ñ—Ä—è—î `accessToken` —Ç–∞ `refreshToken`** ‚Üí –ù–µ–º–∞—î –ø–æ—Ç—Ä–µ–±–∏ –≤ `jwt.verify` —É middleware.  
‚úÖ **–ë–µ–∑–ø–µ—á–Ω—ñ—à–∏–π —Ç–∞ —á–∏—Å—Ç—ñ—à–∏–π –∫–æ–¥** ‚Üí `middleware.js` –ª–∏—à–µ –≤–∏–∫–æ–Ω—É—î –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –±–µ–∑ –æ–±—Ä–æ–±–∫–∏ —Ç–æ–∫–µ–Ω—ñ–≤ –Ω–∞–ø—Ä—è–º—É.  

üîπ **–¶–µ —ñ–¥–µ–∞–ª—å–Ω–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É! üöÄ**