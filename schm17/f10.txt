## ‚úÖ **–ß–∏ –ø–æ—Ç—Ä—ñ–±–µ–Ω `withAuth` (HOC), —è–∫—â–æ –≤–∂–µ —î `middleware.js`?**
–ö–æ—Ä–æ—Ç–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: **–ù—ñ, —è–∫—â–æ `middleware.js` –≤–∂–µ –æ–±—Ä–æ–±–ª—è—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –¥–ª—è –≤—Å—ñ—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫**.

–ê–ª–µ, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ **–¥–∏–Ω–∞–º—ñ—á–Ω–æ –∫–µ—Ä—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø–æ–º –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ (–Ω–∞ —Ä—ñ–≤–Ω—ñ UI)**, **`withAuth` –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º**.

---

## üîπ **üìå –©–æ —Ä–æ–±–∏—Ç—å `middleware.js`?**
- –ó–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è **–ø–µ—Ä–µ–¥ –∫–æ–∂–Ω–∏–º –∑–∞–ø–∏—Ç–æ–º** (–Ω–∞–≤—ñ—Ç—å –¥–ª—è —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `favicon.ico`).
- –ü–µ—Ä–µ–≤—ñ—Ä—è—î JWT (`accessTokenEtls`).
- –Ø–∫—â–æ —Ç–æ–∫–µ–Ω –Ω–µ–¥—ñ–π—Å–Ω–∏–π ‚Üí **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–µ–¥—ñ—Ä–µ–∫—Ç–∏—Ç—å –Ω–∞ `/login`**.

üìå **–Ø–∫—â–æ `middleware.js` –ø—Ä–∞—Ü—é—î –∫–æ—Ä–µ–∫—Ç–Ω–æ, —Ç–æ –≤—ñ–Ω –≤–∂–µ –±–ª–æ–∫—É—î –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —ñ HOC `withAuth` –Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É —Å—Ç–æ—Ä—ñ–Ω–æ–∫.**

---

## üîπ **üìå –ö–æ–ª–∏ –≤—Å–µ –∂ –≤–∞—Ä—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `withAuth`?**
1Ô∏è‚É£ **–î–ª—è –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è –æ–∫—Ä–µ–º–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ UI**  
   - –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **–ø–æ–∫–∞–∑–∞—Ç–∏ –∫–Ω–æ–ø–∫—É —Ç—ñ–ª—å–∫–∏ –¥–ª—è —Ä–æ–ª—ñ `admin`**, –∞–ª–µ –Ω–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –ø–æ–≤–Ω–∏–π —Ä–µ–¥—ñ—Ä–µ–∫—Ç.
   - `middleware.js` –Ω–µ –º–æ–∂–µ **—Ö–æ–≤–∞—Ç–∏ UI**, –≤—ñ–Ω –ª–∏—à–µ –±–ª–æ–∫—É—î —Å—Ç–æ—Ä—ñ–Ω–∫—É.

   üìå **–ü—Ä–∏–∫–ª–∞–¥ `withAuth` –¥–ª—è UI:**
   ```javascript
   import { useAuth } from '../context/AuthContext';

   const AdminPanel = () => {
     const { user } = useAuth();

     if (!user || user.role !== 'admin') {
       return null; // –ü—Ä–∏—Ö–æ–≤—É—î –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –Ω–µ–∞–¥–º—ñ–Ω—ñ–≤
     }

     return <div>–ê–¥–º—ñ–Ω—Å—å–∫–∞ –ø–∞–Ω–µ–ª—å</div>;
   };
   ```

---

2Ô∏è‚É£ **–î–ª—è SSR-–∑–∞–ø–∏—Ç—ñ–≤ (`getServerSideProps`)**  
   - `middleware.js` –ø—Ä–∞—Ü—é—î –Ω–∞ —Ä—ñ–≤–Ω—ñ Next.js **–ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Ç–æ–º**, –∞–ª–µ **–Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª—é—î SSR-–∑–∞–ø–∏—Ç–∏**.
   - –Ø–∫—â–æ —É –≤–∞—Å —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∑ **SSR-–∑–∞–ø–∏—Ç–æ–º (`getServerSideProps`)**, —Ç–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –≤ –Ω—å–æ–º—É.

   üìå **–ü—Ä–∏–∫–ª–∞–¥ –∑–∞—Ö–∏—Å—Ç—É SSR —É `getServerSideProps`:**
   ```javascript
   export async function getServerSideProps(context) {
     const { req } = context;
     const accessTokenEtls = req.cookies.accessTokenEtls;

     if (!accessTokenEtls) {
       return {
         redirect: {
           destination: '/login',
           permanent: false,
         },
       };
     }

     return { props: {} };
   }
   ```

---

3Ô∏è‚É£ **–Ø–∫—â–æ —î —ñ–∑–æ–ª—å–æ–≤–∞–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏, —è–∫—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –±–µ–∑ —Å—Ç–æ—Ä—ñ–Ω–∫–∏**  
   - –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ —É –≤–∞—Å —î –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ, —è–∫–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –Ω–∞ –±—É–¥—å-—è–∫—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ, –∞–ª–µ –ø–æ–≤–∏–Ω–Ω–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—è —Ç—ñ–ª—å–∫–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

   üìå **–ü—Ä–∏–∫–ª–∞–¥ `withAuth` –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É:**
   ```javascript
   const withAuth = (WrappedComponent) => {
     return (props) => {
       const { user, isAuth } = useAuth();

       if (!isAuth) {
         return <p>Access denied</p>;
       }

       return <WrappedComponent {...props} />;
     };
   };

   export default withAuth;
   ```

---

## ‚úÖ **üìå –í–∏—Å–Ω–æ–≤–æ–∫**
‚úî **–Ø–∫—â–æ `middleware.js` –≤–∂–µ –±–ª–æ–∫—É—î –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ ‚Äì `withAuth` –Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–ª—è —Å—Ç–æ—Ä—ñ–Ω–æ–∫**.  
‚úî **–ê–ª–µ `withAuth` –∫–æ—Ä–∏—Å–Ω–∏–π, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–∏—Ö–æ–≤—É–≤–∞—Ç–∏ UI –∞–±–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –≤ `getServerSideProps`**.  

üöÄ **–¢–æ–º—É –Ω–∞–π–∫—Ä–∞—â–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç ‚Äì –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `middleware.js` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –Ω–∞ —Ä—ñ–≤–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–æ–∫, –∞ `withAuth` —Ç—ñ–ª—å–∫–∏ —Ç–∞–º, –¥–µ –≤—ñ–Ω –¥—ñ–π—Å–Ω–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–ª—è –æ–∫—Ä–µ–º–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤).**