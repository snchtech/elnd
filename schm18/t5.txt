### ‚úÖ **üìå –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `customFetch` –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è `departments` —É Next.js**
–û—Å–∫—ñ–ª—å–∫–∏ —Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—à **Next.js API —è–∫ proxy –¥–æ —Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–≥–æ API**, —Ç–µ–ø–µ—Ä –º–æ–∂–Ω–∞ —Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ –Ω–∞ **`/api/rest/customfetch`**, –ø–µ—Ä–µ–¥–∞—é—á–∏ `url` —Ç–∞ `options`.

---

## **üîπ 1. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `customFetch` —É `getServerSideProps` (SSR)**
–Ø–∫—â–æ —Ç–∏ —Ö–æ—á–µ—à –æ—Ç—Ä–∏–º–∞—Ç–∏ `departments` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω—ñ–π —Å—Ç–æ—Ä–æ–Ω—ñ (–ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏), –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π **`getServerSideProps`**:

```javascript
export async function getServerSideProps(context) {
  try {
    const res = await fetch(`${process.env.NEXT_PUBLIC_BASE_URL}/api/rest/customfetch`, {
      method: "POST",
      credentials: "include",
      headers: { "Content-Type": "application/json", Cookie: context.req.headers.cookie || "" },
      body: JSON.stringify({ url: "/departments", options: { method: "GET" } }),
    });

    if (!res.ok) {
      throw new Error("Failed to fetch departments");
    }

    const data = await res.json();

    return { props: { departments: data } };
  } catch (error) {
    console.error("Error fetching departments:", error);
    return { props: { departments: [] } }; // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –ø—É—Å—Ç–∏–π –º–∞—Å–∏–≤ —É —Ä–∞–∑—ñ –ø–æ–º–∏–ª–∫–∏
  }
}
```
‚úî **–¢—É—Ç `customFetch` –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ**, –ø–µ—Ä–µ–¥–∞—é—á–∏ `Cookie` –∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—î—é.  
‚úî **API `/api/rest/customfetch`** –≤–∏–∫–æ–Ω—É—î –∑–∞–ø–∏—Ç –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π API `/departments`.  
‚úî **–Ø–∫—â–æ –æ—Ç—Ä–∏–º—É—î–º–æ –ø–æ–º–∏–ª–∫—É, –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –ø–æ—Ä–æ–∂–Ω—ñ–π –º–∞—Å–∏–≤ `departments`**.  

---

## **üîπ 2. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `customFetch` –Ω–∞ –∫–ª—ñ—î–Ω—Ç—ñ (React `useEffect`)**
–Ø–∫—â–æ —Ç–∏ —Ö–æ—á–µ—à –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ `departments` **–¥–∏–Ω–∞–º—ñ—á–Ω–æ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π `useEffect`:

```javascript
import { useEffect, useState } from "react";

const fetchDepartments = async () => {
  try {
    const res = await fetch("/api/rest/customfetch", {
      method: "POST",
      credentials: "include",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ url: "/departments", options: { method: "GET" } }),
    });

    if (!res.ok) {
      throw new Error("Failed to fetch departments");
    }

    return await res.json();
  } catch (error) {
    console.error("Error fetching departments:", error);
    return [];
  }
};

export default function DepartmentsPage() {
  const [departments, setDepartments] = useState([]);

  useEffect(() => {
    fetchDepartments().then(setDepartments);
  }, []);

  return (
    <div>
      <h1>Departments</h1>
      <ul>
        {departments.map((dep) => (
          <li key={dep.id}>{dep.name}</li>
        ))}
      </ul>
    </div>
  );
}
```
‚úî **–ü—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∑–∞–ø–∏—Ç —á–µ—Ä–µ–∑ `customFetch` API.**  
‚úî **`credentials: "include"` –¥–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ `cookies` –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó.**  
‚úî **–î–∞–Ω—ñ —Ä–µ–Ω–¥–µ—Ä—è—Ç—å—Å—è –ø—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.**

---

## ‚úÖ **üìå –ü—ñ–¥—Å—É–º–æ–∫**
| –ü—ñ–¥—Ö—ñ–¥ | –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è |
|--------|-------------|
| **`getServerSideProps`** | –û—Ç—Ä–∏–º—É—î `departments` –ø–µ—Ä–µ–¥ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (SEO + SSR) |
| **`useEffect` (–ö–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π –∑–∞–ø–∏—Ç)** | –î–∏–Ω–∞–º—ñ—á–Ω–æ –æ—Ç—Ä–∏–º—É—î `departments` –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏ |

üöÄ **–¢–µ–ø–µ—Ä —Ç–∏ –º–æ–∂–µ—à –≤–∏–∫–ª–∏–∫–∞—Ç–∏ `customFetch` –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö, –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑–≤–µ—Ä—Ç–∞—é—á–∏—Å—å –¥–æ `/api/rest/customfetch`! üî•**