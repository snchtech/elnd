### ‚úÖ **üìå –Ø–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑–ª–æ–≥—ñ–Ω—é–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫—â–æ –≤—ñ–Ω –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ `/login`?**
–¢–æ–±—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ **–ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏, —á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∂–µ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π, –∫–æ–ª–∏ –≤—ñ–Ω –∑–∞—Ö–æ–¥–∏—Ç—å –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É `/login`**. –Ø–∫—â–æ —Ç–∞–∫ ‚Äì **–≤–∏–¥–∞–ª–∏—Ç–∏ –π–æ–≥–æ `cookies` (logout) —Ç–∞ –∑–º—É—Å–∏—Ç–∏ –≤–≤—ñ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ**.

---

## üîπ **üìå –û–Ω–æ–≤–ª—é—î–º–æ `middleware.js`**
–î–æ–¥–∞—î–º–æ –ª–æ–≥—ñ–∫—É –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞—Ö–æ–¥–∏—Ç—å –Ω–∞ `/login`, —ñ —Ä–æ–∑–ª–æ–≥—ñ–Ω—é—î–º–æ –π–æ–≥–æ.

```javascript
import { NextResponse } from "next/server";
import { cookies } from "next/headers";

export function middleware(req) {
  const { pathname } = req.nextUrl;
  const cookieStore = cookies();
  const accessTokenEtls = cookieStore.get("accessTokenEtls")?.value;
  const refreshTokenEtls = cookieStore.get("refreshTokenEtls")?.value;

  // üîπ –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∂–µ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π —ñ –∑–∞—Ö–æ–¥–∏—Ç—å –Ω–∞ `/login`, —Ä–æ–±–∏–º–æ logout
  if (pathname === "/login" && (accessTokenEtls || refreshTokenEtls)) {
    return logoutUser(req);
  }

  return NextResponse.next();
}

function logoutUser(req) {
  return NextResponse.redirect(new URL("/login", req.url), {
    headers: {
      "Set-Cookie": [
        "accessTokenEtls=; HttpOnly; Path=/; Max-Age=0",
        "refreshTokenEtls=; HttpOnly; Path=/; Max-Age=0",
        "userDataEtls=; HttpOnly; Path=/; Max-Age=0",
      ].join(", "),
    },
  });
}

// üîπ –í–∫–∞–∑—É—î–º–æ, —â–æ middleware –ø—Ä–∞—Ü—é—î –Ω–∞ –≤—Å—ñ—Ö —Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö
export const config = {
  matcher: ["/login", "/dashboard", "/profile"], // –°–ø–∏—Å–æ–∫ —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
};
```

‚úî **–Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞—Ö–æ–¥–∏—Ç—å –Ω–∞ `/login`, –∞–ª–µ —â–µ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π ‚Äì –≤—ñ–Ω —Ä–æ–∑–ª–æ–≥—ñ–Ω—É—î—Ç—å—Å—è.**  
‚úî **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º—É—Å–∏—Ç—å –≤–≤–µ—Å—Ç–∏ –¥–∞–Ω—ñ –∑–∞–Ω–æ–≤–æ –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º.**  
‚úî **–¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –ø—Ä–∞—Ü—é—î –±–µ–∑ –∑–∞–π–≤–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä!**

---

## üîπ **üìå –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ `redirectToLogin()` —É Next.js API**
–¢–µ–ø–µ—Ä –º–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ `redirectToLogin()` —É –±—É–¥—å-—è–∫–æ–º—É API, —è–∫—â–æ —Ç—Ä–µ–±–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ logout.

### **üõ† –û–Ω–æ–≤–ª–µ–Ω–∏–π `utils/auth.js`**
```javascript
import { NextResponse } from "next/server";

export function redirectToLogin(req) {
  return NextResponse.redirect(new URL("/login", req.url), {
    headers: {
      "Set-Cookie": [
        "accessTokenEtls=; HttpOnly; Path=/; Max-Age=0",
        "refreshTokenEtls=; HttpOnly; Path=/; Max-Age=0",
        "userDataEtls=; HttpOnly; Path=/; Max-Age=0",
      ].join(", "),
    },
  });
}
```
‚úî **–¢–µ–ø–µ—Ä `redirectToLogin()` –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤ –±—É–¥—å-—è–∫–æ–º—É API –∞–±–æ middleware.**  

---

## ‚úÖ **üìå –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î?**
1Ô∏è‚É£ **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∂–µ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π —ñ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ `/login`.**  
2Ô∏è‚É£ **Middleware –±–∞—á–∏—Ç—å, —â–æ —É –Ω—å–æ–≥–æ —â–µ —î `accessTokenEtls` –∞–±–æ `refreshTokenEtls`.**  
3Ô∏è‚É£ **Middleware –≤–∏–∫–ª–∏–∫–∞—î `logoutUser()`, —è–∫–∏–π –æ—á–∏—â–∞—î `cookies` —Ç–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞ `/login`.**  
4Ô∏è‚É£ **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º—É—Å–∏—Ç—å –≤–≤–µ—Å—Ç–∏ –¥–∞–Ω—ñ –∑–∞–Ω–æ–≤–æ.**  

üöÄ **–¶—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑–ª–æ–≥—ñ–Ω—é—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø—Ä–∏ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—ñ –Ω–∞ `/login`, –∑–º—É—à—É—é—á–∏ –π–æ–≥–æ –∞–≤—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏—Å—å –∑–Ω–æ–≤—É! üî•**