-- Таблиця SCHEME_NOTE (залишається без змін, оскільки примітки можуть бути незалежними)
CREATE TABLE SCHEME_NOTE (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    note_text VARCHAR2(1000)
);

-- Таблиця NOTE_SCHEME (оновлено scheme_id → scheme_version_id)
CREATE TABLE NOTE_SCHEME (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    scheme_version_id NUMBER,
    note_id NUMBER,
    CONSTRAINT fk_note_scheme_version FOREIGN KEY (scheme_version_id) REFERENCES SCHEME_VERSION(id),
    CONSTRAINT fk_note_scheme_note FOREIGN KEY (note_id) REFERENCES SCHEME_NOTE(id)
);

-- Таблиця SCHEME_TABLE_INFO (залишається без змін, оскільки це загальні інформаційні дані)
CREATE TABLE SCHEME_TABLE_INFO (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    position NUMBER,
    label VARCHAR2(255),
    name VARCHAR2(255),
    count NUMBER,
    info VARCHAR2(1000)
);

-- Таблиця TABLE_SCHEME (оновлено id_scheme → scheme_version_id)
CREATE TABLE TABLE_SCHEME (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    scheme_version_id NUMBER,
    id_table_info NUMBER,
    CONSTRAINT fk_table_scheme_version FOREIGN KEY (scheme_version_id) REFERENCES SCHEME_VERSION(id),
    CONSTRAINT fk_table_scheme_table_info FOREIGN KEY (id_table_info) REFERENCES SCHEME_TABLE_INFO(id)
);

-- Таблиця ELEMENT (оновлено scheme_id → scheme_version_id)
CREATE TABLE ELEMENT (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    scheme_version_id NUMBER,
    album_id NUMBER, -- Уточнити
    name VARCHAR2(255),
    status_id NUMBER,
    department_id NUMBER, -- Уточнити
    unit_id NUMBER, -- Уточнити
    date_update DATE DEFAULT SYSDATE,
    group_id NUMBER,
    element_type NUMBER,
    created_at DATE DEFAULT SYSDATE,
    element_blob BLOB, -- Уточнити
    path_to_blob VARCHAR2(1000), -- Уточнити
    show_status NUMBER(1),
    last_editor_id NUMBER,
    x_position NUMBER,
    y_position NUMBER,
    width NUMBER,
    height NUMBER,
    radius NUMBER,
    fill_color VARCHAR2(255),
    rotation_angle NUMBER,
    z_index NUMBER,
    CONSTRAINT fk_element_version FOREIGN KEY (scheme_version_id) REFERENCES SCHEME_VERSION(id),
    CONSTRAINT fk_element_album FOREIGN KEY (album_id) REFERENCES ALBUM(id)
);

-- Додаткові індекси для оптимізації запитів
CREATE INDEX idx_note_scheme_version_id ON NOTE_SCHEME(scheme_version_id);
CREATE INDEX idx_table_scheme_version_id ON TABLE_SCHEME(scheme_version_id);
CREATE INDEX idx_element_version_id ON ELEMENT(scheme_version_id);
