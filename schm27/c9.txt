–¢–∞–∫, —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ç–∞–∫–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª —Ü—ñ–ª–∫–æ–º —Ä–µ–∞–ª—å–Ω–æ. –ù–∏–∂—á–µ —è –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å—É—é –∞–ª–≥–æ—Ä–∏—Ç–º —ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —â–æ–¥–æ –π–æ–≥–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó.

---

### **–ê–ª–≥–æ—Ä–∏—Ç–º –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –∞–±–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó —Å—Ö–µ–º–∏**
–ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –∫–Ω–æ–ø–∫–∏ **"–†–µ–¥–∞–≥—É–≤–∞—Ç–∏"** —É —Å—Ö–µ–º—ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –Ω–∞—Å—Ç—É–ø–Ω–∞ –ª–æ–≥—ñ–∫–∞ —á–µ—Ä–µ–∑ API:

1. **–û—Ç—Ä–∏–º—É—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Å—Ç–∞–±—ñ–ª—å–Ω—É –≤–µ—Ä—Å—ñ—é** (`is_stable = 1`).
   - –Ø–∫—â–æ **—Å—Ç–∞–±—ñ–ª—å–Ω–∞ –≤–µ—Ä—Å—ñ—è —î**, –ø–µ—Ä–µ—Ö–æ–¥–∏–º–æ –¥–æ –∫—Ä–æ–∫—É 2.
   - –Ø–∫—â–æ **—Å—Ç–∞–±—ñ–ª—å–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –Ω–µ–º–∞—î**, –≤—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –ø–æ—Ç–æ—á–Ω—É —Å—Ö–µ–º—É (`scheme_id`) –±–µ–∑ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –≤–µ—Ä—Å—ñ—ó.

2. **–ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —î —Ä–µ–¥–∞–≥–æ–≤–∞–Ω–∞ –≤–µ—Ä—Å—ñ—è (`is_stable = 0`) –¥–ª—è —Ü—ñ—î—ó —Å—Ö–µ–º–∏**.
   - –Ø–∫—â–æ —Ä–µ–¥–∞–≥–æ–≤–∞–Ω–∞ –≤–µ—Ä—Å—ñ—è **—ñ—Å–Ω—É—î**, –≤—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ —ó—ó.
   - –Ø–∫—â–æ **—Ä–µ–¥–∞–≥–æ–≤–∞–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –Ω–µ–º–∞—î**, —Å—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤—É —Ä–µ–¥–∞–≥–æ–≤–∞–Ω—É –≤–µ—Ä—Å—ñ—é (`is_stable = 0`):
     - **–ö–æ–ø—ñ—é—î–º–æ –¥–∞–Ω—ñ** –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ—ó —Å—Ç–∞–±—ñ–ª—å–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó.
     - **–°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π –∑–∞–ø–∏—Å —É SCHEME_VERSION** –∑ `is_stable = 0`.
     - **–ö–æ–ø—ñ—é—î–º–æ –≤—Å—ñ –ø–æ–≤'—è–∑–∞–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏** –∑ –æ—Å–Ω–æ–≤–Ω–æ—ó —Å—Ö–µ–º–∏.
     - –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ ID –Ω–æ–≤–æ—ó —Ä–µ–¥–∞–≥–æ–≤–∞–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó —Ç–∞ –≤—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ —ó—ó.

3. **–í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –≤–µ—Ä—Å—ñ—é –≤ —Ä–µ–∂–∏–º—ñ `editor`**.  

---

### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —â–æ–¥–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó**

#### **1. –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –∑–∞–ø–∏—Ç—ñ–≤**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π **–∑–∞–ø–∏—Ç–∏ –∑ –æ–±–º–µ–∂–µ–Ω–Ω—è–º `LIMIT 1`** (–∞–±–æ `FETCH FIRST 1 ROW ONLY`) –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –æ—Å—Ç–∞–Ω–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó.
- –î–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ —Å—Ç–∞–±—ñ–ª—å–Ω–æ—ó/—Ä–µ–¥–∞–≥–æ–≤–∞–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **—ñ–Ω–¥–µ–∫—Å–æ–≤–∞–Ω–∏–π –ø–æ—à—É–∫**.

#### **2. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π**
- **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó —Ä–µ–¥–∞–≥–æ–≤–∞–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó** –º–∞—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏—Å—å —É **—Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó** —Ä–∞–∑–æ–º —ñ–∑ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è–º –ø–æ–≤'—è–∑–∞–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤.
- –Ø–∫—â–æ –ø—ñ–¥ —á–∞—Å –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è —Å—Ç–∞–Ω–µ—Ç—å—Å—è –ø–æ–º–∏–ª–∫–∞, –ø–æ—Ç—Ä—ñ–±–Ω–æ **–≤—ñ–¥–∫–∞—Ç–∏—Ç–∏ –≤—Å—ñ –∑–º—ñ–Ω–∏**.

#### **3. –õ–æ–≥—ñ–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –≤–µ—Ä—Å—ñ—ó**
- –ù–æ–≤–∞ —Ä–µ–¥–∞–≥–æ–≤–∞–Ω–∞ –≤–µ—Ä—Å—ñ—è –ø–æ–≤–∏–Ω–Ω–∞ **–º–∞—Ç–∏ —Ç–æ–π —Å–∞–º–∏–π `scheme_id`**, —â–æ —ñ —Å—Ç–∞–±—ñ–ª—å–Ω–∞.
- –í–µ—Ä—Å—ñ—è –ø–æ–≤–∏–Ω–Ω–∞ –º–∞—Ç–∏ **–Ω–æ–º–µ—Ä +1 –≤—ñ–¥ –æ—Å—Ç–∞–Ω–Ω—å–æ—ó —Å—Ç–∞–±—ñ–ª—å–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó**.
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π `created_by`, `updated_by`, —â–æ–± –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∞–≤—Ç–æ—Ä–∞ –∑–º—ñ–Ω.

#### **4. –ö–æ–Ω—Ç—Ä–æ–ª—å –æ–¥–Ω–æ—á–∞—Å–Ω–æ–≥–æ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è**
- –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —É–∂–µ –≤—ñ–¥–∫—Ä–∏–≤ —Ä–µ–¥–∞–≥–æ–≤–∞–Ω—É –≤–µ—Ä—Å—ñ—é, —ñ–Ω—à–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –ø–æ–≤–∏–Ω–µ–Ω —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–æ–≤—É.
- –¶–µ –º–æ–∂–Ω–∞ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ **–±–ª–æ–∫—É–≤–∞–Ω–Ω—è** (`SELECT FOR UPDATE`) –∞–±–æ —á–µ—Ä–µ–∑ –æ–∫—Ä–µ–º–∏–π —Å—Ç–∞—Ç—É—Å —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è.

#### **5. –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è –ø–æ–≤‚Äô—è–∑–∞–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤**
- –£ —Ç–µ–±–µ —î **—Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–≤‚Äô—è–∑–∞–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤** –¥–æ —Å—Ö–µ–º. –í–∞–∂–ª–∏–≤–æ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ä–µ–¥–∞–≥–æ–≤–∞–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó:
  - **–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –≤—Å—ñ –ø—Ä–∏–≤‚Äô—è–∑–∞–Ω—ñ –æ–±'—î–∫—Ç–∏** (–∑–º—ñ–Ω–∏ –Ω–µ –ø–æ–≤–∏–Ω–Ω—ñ –≤–ø–ª–∏–≤–∞—Ç–∏ –Ω–∞ —Å—Ç–∞–±—ñ–ª—å–Ω—É –≤–µ—Ä—Å—ñ—é).
  - –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–π `scheme_version_id` –¥–ª—è –∑–≤'—è–∑–∫—É.

#### **6. –î–æ–¥–∞–≤–∞–Ω–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ –ø–µ—Ä–µ–¥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º**
- **–ó–∞–ø–æ–±—ñ–≥—Ç–∏ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –±—ñ–ª—å—à–µ –æ–¥–Ω—ñ—î—ó —Ä–µ–¥–∞–≥–æ–≤–∞–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó** –¥–ª—è –æ–¥–Ω—ñ—î—ó —Å—Ö–µ–º–∏.
- –Ø–∫—â–æ **—î –∞–∫—Ç–∏–≤–Ω–∞ —Ä–µ–¥–∞–≥–æ–≤–∞–Ω–∞ –≤–µ—Ä—Å—ñ—è**, —ó—ó –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏, –∞ –Ω–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–æ–≤—É.

---

### **–û—á—ñ–∫—É–≤–∞–Ω–∏–π SQL-–∑–∞–ø–∏—Ç –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–µ—Ä—Å—ñ–π**
```sql
SELECT id, version_number, is_stable, created_at
FROM SCHEME_VERSION
WHERE scheme_id = :schemeId
AND is_archived = 0
ORDER BY is_stable DESC, created_at DESC
FETCH FIRST 1 ROW ONLY;
```
–¶–µ–π –∑–∞–ø–∏—Ç –ø–æ–≤–µ—Ä–Ω–µ **–∞–±–æ —Å—Ç–∞–±—ñ–ª—å–Ω—É, –∞–±–æ –æ—Å—Ç–∞–Ω–Ω—é —Ä–µ–¥–∞–≥–æ–≤–∞–Ω—É –≤–µ—Ä—Å—ñ—é** (—è–∫—â–æ –≤–æ–Ω–∞ —î).

---

### **–û—á—ñ–∫—É–≤–∞–Ω–∏–π SQL-–∑–∞–ø–∏—Ç –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó —Ä–µ–¥–∞–≥–æ–≤–∞–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó**
```sql
INSERT INTO SCHEME_VERSION (scheme_id, version_number, is_stable, created_at, created_by)
VALUES (:schemeId, :newVersionNumber, 0, SYSDATE, :userId)
RETURNING id INTO :newVersionId;
```
**–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –≤—Å—ñ –ø–æ–≤‚Äô—è–∑–∞–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏**.

---

### **–í–∏—Å–Ω–æ–≤–æ–∫**
‚úÖ –¢–≤–æ—è –ª–æ–≥—ñ–∫–∞ —Ü—ñ–ª–∫–æ–º —Ä–µ–∞–ª—ñ–∑–æ–≤—É–≤–∞–Ω–∞, —è–∫—â–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ä–≥–∞–Ω—ñ–∑—É–≤–∞—Ç–∏ **—Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó, –±–ª–æ–∫—É–≤–∞–Ω–Ω—è, –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Å—Ç–∞—Ç—É—Å—ñ–≤**.  
‚úÖ –û—Å–Ω–æ–≤–Ω–∞ —É–≤–∞–≥–∞ –º–∞—î –±—É—Ç–∏ –Ω–∞:
- **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –≤–∏–±–æ—Ä—ñ –≤–µ—Ä—Å—ñ—ó** –ø—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ —Å—Ö–µ–º–∏.
- **–ó–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—ñ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—é –¥—É–±–ª—é—é—á–∏—Ö —Ä–µ–¥–∞–≥–æ–≤–∞–Ω–∏—Ö –≤–µ—Ä—Å—ñ–π**.
- **–ö–æ–ø—ñ—é–≤–∞–Ω–Ω—ñ –∑–≤‚Äô—è–∑–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö** –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ä–µ–¥–∞–≥–æ–≤–∞–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó.

–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫ ‚Äì —Ä–æ–∑—Ä–æ–±–∫–∞ API-–º–µ—Ç–æ–¥—É –¥–ª—è —Ü—ñ—î—ó –ª–æ–≥—ñ–∫–∏! üöÄ