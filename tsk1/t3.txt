### **–í—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ —Ç–≤–æ—ó –ø–∏—Ç–∞–Ω–Ω—è:**

---

### **1. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `COALESCE(sh.POSITION_ID, sr.POSITION_ID)`**
> **–¢–∏ –ø—Ä–∞–≤–∏–π!** –í `SIGNATUREHISTORY (sh)` **–Ω–µ–º–∞—î `POSITION_ID`**, —Ç–æ–º—É —Ü—è —á–∞—Å—Ç–∏–Ω–∞ `COALESCE(sh.POSITION_ID, sr.POSITION_ID)` –≤–∏–∫–ª–∏—á–µ –ø–æ–º–∏–ª–∫—É.

#### **–ß–æ–º—É —è —Ü–µ –Ω–∞–ø–∏—Å–∞–≤?**
- –£ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –≤–∞—Ä—ñ–∞–Ω—Ç—ñ —è –ø—Ä–∏–ø—É—Å–∫–∞–≤, —â–æ –≤ `SIGNATUREHISTORY` –º–æ–∂—É—Ç—å –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è –≤—Å—ñ –¥–∞–Ω—ñ –ø—Ä–æ –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç–∞, –≤–∫–ª—é—á–∞—é—á–∏ `POSITION_ID`, `DEPARTMENT_ID`, `UNIT_ID`.
- –Ø–∫—â–æ `SIGNATUREHISTORY` –º—ñ—Å—Ç–∏—Ç—å —Ç—ñ–ª—å–∫–∏ **SIGNER_BY, SIGNER_DATE, NOTE**, —Ç–æ–¥—ñ `POSITION_ID`, `DEPARTMENT_ID`, `UNIT_ID` —Å–ª—ñ–¥ –±—Ä–∞—Ç–∏ **–ª–∏—à–µ –∑ `SIGNATURERIGHTS`**.

#### **–Ø–∫ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏?**
–û—Å—å –ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤–µ—Ä—Å—ñ—è:

```sql
SELECT 
    sr.SOURCE_ID,
    COALESCE(sh.SIGNER_BY, sr.USER_ID) AS CREATOR_ID,
    COALESCE(sh.SIGNER_DATE, NULL) AS DATE_CREATED,
    COALESCE(sh.NOTE, NULL) AS CREATOR_NOTE,
    sr.POSITION_ID AS CREATOR_POSITION,  -- –ë–µ—Ä–µ–º–æ –ª–∏—à–µ –∑ SIGNATURERIGHTS
    sr.DEPARTMENT_ID AS CREATOR_DEPARTMENT,
    sr.UNIT_ID AS CREATOR_UNIT
```

‚úÖ **–¢–µ–ø–µ—Ä –≤—Å—ñ –ø–æ–ª—è `POSITION_ID`, `DEPARTMENT_ID`, `UNIT_ID` –∑–∞–≤–∂–¥–∏ –±–µ—Ä—É—Ç—å—Å—è –∑ `SIGNATURERIGHTS`.**  
‚úÖ **–ü–æ–ª—è `SIGNER_BY, SIGNER_DATE, NOTE` ‚Äì –∑ `SIGNATUREHISTORY`, —è–∫—â–æ –∑–∞–ø–∏—Å —î.**

---

### **2. –ß–∏ –±—É–¥–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ —Ü–µ–π –∫–æ–¥ —á–µ—Ä–µ–∑ `DBLINK` –º—ñ–∂ Oracle 12.1 —Ç–∞ Oracle 10g?**

> **–ó–∞–≥–∞–ª–æ–º, –∫–æ–¥ –±—É–¥–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏, –∞–ª–µ —î –Ω—é–∞–Ω—Å–∏!**

‚úÖ **–©–æ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º:**
1. `COALESCE(sh.SIGNER_BY, sr.USER_ID)`  
2. `LEFT JOIN` –º—ñ–∂ –ª–æ–∫–∞–ª—å–Ω–∏–º–∏ —Ç–∞ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–º–∏ —Ç–∞–±–ª–∏—Ü—è–º–∏  
3. `CASE WHEN` –¥–ª—è —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è  
4. `VIEW` –Ω–∞ 12.1, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –¥–∂–µ—Ä–µ–ª–æ –¥–∞–Ω–∏—Ö ‚Äî 10g  

‚ùå **–©–æ –º–æ–∂–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –ø–æ–º–∏–ª–∫–∏:**
1. `LISTAGG(...) WITHIN GROUP (ORDER BY ...)`  
   - **–£ 10g `LISTAGG` –ù–ï –ü–Ü–î–¢–†–ò–ú–£–Ñ–¢–¨–°–Ø!**  
   - –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—à `DBLINK` —ñ `SIGNATURERIGHTS` –∑ 10g, —Ç—Ä–µ–±–∞ –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ `WM_CONCAT()` –∞–±–æ `XMLAGG()`.  
   - –£ 12.1 `LISTAGG()` –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è, —Ç–æ–º—É –≤—ñ–Ω –±—É–¥–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏, —è–∫—â–æ —Ç–∞–±–ª–∏—Ü—è –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —É 12.1.

2. **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤ —á–µ—Ä–µ–∑ `DBLINK`**  
   - –Ø–∫—â–æ `SIGNATURERIGHTS`, `SIGNATUREHISTORY` –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ 10g, –∫–æ–∂–µ–Ω –∑–∞–ø–∏—Ç –±—É–¥–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏—Å—å —á–µ—Ä–µ–∑ **–ø–æ–≤—ñ–ª—å–Ω–∏–π –º–µ—Ä–µ–∂–µ–≤–∏–π –∑–≤‚Äô—è–∑–æ–∫**.
   - –ö—Ä–∞—â–µ **–ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è (–∑–ª–∏—Ç—Ç—è –¥–∞–Ω–∏—Ö) —É `VIEW` –Ω–∞ 10g**, –∞ —É 12.1 –≤–∂–µ –∞–≥—Ä–µ–≥—É–≤–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª—å–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏.

---

### **–Ø–∫ –∞–¥–∞–ø—Ç—É–≤–∞—Ç–∏ –∫–æ–¥ –¥–ª—è `DBLINK` –∑ 10g?**
#### **1. –ó–∞–º—ñ–Ω–∏—Ç–∏ `LISTAGG` –Ω–∞ `WM_CONCAT()` –∞–±–æ `XMLAGG()`**
**–Ø–∫—â–æ `SIGNATURERIGHTS` —É 10g**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ `WM_CONCAT()`:
```sql
SELECT 
    sr.SOURCE_ID,
    WM_CONCAT(sr.USER_ID) AS RESPONSIBLE_USERS
FROM SIGNATURERIGHTS@DBLINK10G sr
WHERE sr.STAGES_ID = 2
GROUP BY sr.SOURCE_ID;
```
üí° **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç:**
–Ø–∫—â–æ `WM_CONCAT` –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π, –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ `XMLAGG`:
```sql
SELECT 
    sr.SOURCE_ID,
    RTRIM(XMLAGG(XMLELEMENT(e, sr.USER_ID || ', ') ORDER BY sr.USER_ID).EXTRACT('//text()'), ', ') AS RESPONSIBLE_USERS
FROM SIGNATURERIGHTS@DBLINK10G sr
WHERE sr.STAGES_ID = 2
GROUP BY sr.SOURCE_ID;
```
üìå **–Ø–∫—â–æ `SIGNATURERIGHTS` –Ω–∞ 12.1, `LISTAGG()` –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ –±–µ–∑ –∑–º—ñ–Ω!**

---

### **–í–∏—Å–Ω–æ–≤–∫–∏**
‚úÖ **1. –í–∏–ø—Ä–∞–≤–∏–≤ –ø–æ–º–∏–ª–∫—É `COALESCE` ‚Äì —Ç–µ–ø–µ—Ä `POSITION_ID`, `DEPARTMENT_ID`, `UNIT_ID` –±–µ—Ä—É—Ç—å—Å—è –ª–∏—à–µ –∑ `SIGNATURERIGHTS`.**  
‚úÖ **2. `LISTAGG` –ù–ï –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è –≤ Oracle 10g, —è–∫—â–æ –¥–∞–Ω—ñ —á–µ—Ä–µ–∑ `DBLINK`.**  
‚úÖ **3. –Ø–∫—â–æ `SIGNATURERIGHTS` —É 10g, –∑–∞–º—ñ–Ω–∏ `LISTAGG` –Ω–∞ `WM_CONCAT` –∞–±–æ `XMLAGG`.**  
‚úÖ **4. `VIEW` –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ –≤ Oracle 12.1, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `DBLINK` –Ω–∞ 10g.**

üöÄ **–Ø–∫—â–æ —â–æ—Å—å —â–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∞–¥–∞–ø—Ç—É–≤–∞—Ç–∏ ‚Äì –¥–∞–π –∑–Ω–∞—Ç–∏!** üòä