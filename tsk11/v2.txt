‚úÖ –¢–∞–∫, –¥–ª—è **–ø—ñ–¥—à–∞–±–ª–æ–Ω—ñ–≤** (`TASK_TEMPLATE_SUBTASKS`) –Ω–∞–π–∫—Ä–∞—â–µ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **–æ–∫—Ä–µ–º–∏–π JavaScript + –æ–∫—Ä–µ–º—ñ –ø—Ä–æ—Ü–µ—Å–∏–Ω–≥–∏**, –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –¥–æ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å, –∞–ª–µ –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –Ω–æ–≤–æ—ó —Ç–∞–±–ª–∏—Ü—ñ –π –ª–æ–≥—ñ–∫–∏.

---

## üîß –©–æ —Ç—Ä–µ–±–∞ –∑—Ä–æ–±–∏—Ç–∏:

### ‚úÖ 1. **–ü—Ä–æ—Ü–µ—Å–∏–Ω–≥ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó URL —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—ñ–¥—à–∞–±–ª–æ–Ω—É**

–ù–∞–∑–≤–∞: `GET_SUBTEMPLATE_EDIT_URL`

```plsql
DECLARE
  l_url VARCHAR2(4000);
BEGIN
  l_url := apex_page.get_url (
    p_page        => 6, -- –∞–±–æ —ñ–Ω—à–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
    p_clear_cache => '6',
    p_items       => 'P6_ID,P6_IS_TEMPLATE',
    p_values      => APEX_APPLICATION.G_X01 || ',1', -- 1 –≤–∫–∞–∑—É—î, —â–æ —Ü–µ —à–∞–±–ª–æ–Ω
    p_request     => 'DIALOG'
  );

  APEX_JSON.OPEN_OBJECT;
  APEX_JSON.WRITE('url', l_url);
  APEX_JSON.CLOSE_OBJECT;
END;
```

üîπ **P6\_IS\_TEMPLATE** ‚Äî –¥–æ–ø–æ–º–æ–∂–µ —É —Ñ–æ—Ä–º—ñ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ 6 –≤–∏–∑–Ω–∞—á–∏—Ç–∏, —â–æ –π–¥–µ—Ç—å—Å—è –ø—Ä–æ –ø—ñ–¥—à–∞–±–ª–æ–Ω, –∞ –Ω–µ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è.

---

### ‚úÖ 2. **JavaScript –∫–æ–¥ –¥–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–µ–Ω—é —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—ñ–¥—à–∞–±–ª–æ–Ω—É**

```javascript
document.getElementById("menu-edit-subtemplate").addEventListener("click", function () {
  const id = this.dataset.id;
  if (!id) return;

  apex.server.process("GET_SUBTEMPLATE_EDIT_URL", {
    x01: id
  }, {
    dataType: "json",
    success: function(pData) {
      apex.navigation.redirect(pData.url);
    },
    error: function() {
      alert("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó URL –¥–ª—è –ø—ñ–¥—à–∞–±–ª–æ–Ω—É");
    }
  });

  document.getElementById("custom-ig-menu-template").style.display = "none";
});
```

---

### ‚úÖ 3. **HTML —á–∞—Å—Ç–∏–Ω–∞ —Ç–≤–æ–≥–æ Custom Menu –¥–ª—è –ø—ñ–¥—à–∞–±–ª–æ–Ω—ñ–≤**

```html
<ul id="custom-ig-menu-template" class="custom-ig-menu">
  <li><a href="#" id="menu-edit-subtemplate" data-id="">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a></li>
  <li><a href="#" id="menu-delete-subtemplate" data-id="">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏</a></li>
  <li><a href="#" id="menu-duplicate-subtemplate" data-id="">üìÑ –î—É–±–ª—é–≤–∞—Ç–∏</a></li>
  <li><a href="#" id="menu-create-child-subtemplate" data-id="">‚ûï –î–æ–¥–∞—Ç–∏ –ø—ñ–¥–ø—ñ–¥—à–∞–±–ª–æ–Ω</a></li>
</ul>
```

---

### ‚úÖ 4. **–§–æ—Ä–º–∞ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ 6**

–ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è (`P6_...`):

* –î–æ–¥–∞–π **–ø—Ä–∏—Ö–æ–≤–∞–Ω–µ –ø–æ–ª–µ** `P6_IS_TEMPLATE`
* –ü—Ä–∏ `P6_IS_TEMPLATE = 1`:

  * –ó–∞–≤–∞–Ω—Ç–∞–∂—É–π / –∑–±–µ—Ä—ñ–≥–∞–π —É `TASK_TEMPLATE_SUBTASKS`
* –ü—Ä–∏ `P6_IS_TEMPLATE = 0`:

  * –ü—Ä–∞—Ü—é–π –∑ `TASK_SUBTASKS`

---

### ‚úÖ 5. **–£–º–æ–≤–∞ Server-side —É –ø—Ä–æ—Ü–µ—Å–∏–Ω–≥–∞—Ö `UPDATE_SUBTASK / UPDATE_SUBTEMPLATE`**

* –ù–∞–ø—Ä–∏–∫–ª–∞–¥, `UPDATE_SUBTEMPLATE`:

```plsql
BEGIN
  UPDATE TASK_TEMPLATE_SUBTASKS
  SET
    SUBTASK_CONTENT = :P6_SUBTASK_CONTENT,
    PARENT_ID       = :P6_PARENT_ID
  WHERE ID = :P6_ID;

EXCEPTION
  WHEN OTHERS THEN
    raise_application_error(-20001, '–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –ø—ñ–¥—à–∞–±–ª–æ–Ω—É: ' || SQLERRM);
END;
```

* –£–º–æ–≤–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è: `:P6_IS_TEMPLATE = 1`

---

### ‚è≠ –î–∞–ª—ñ —Ç–∏ –∑–º–æ–∂–µ—à:

* —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **DELETE**
* —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **DUPLICATE**
* —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **CREATE\_CHILD**

–∑–∞ —Ç–∏–º —Å–∞–º–∏–º –ø—ñ–¥—Ö–æ–¥–æ–º, —è–∫ —Ç–∏ –≤–∂–µ –∑—Ä–æ–±–∏–≤ –¥–ª—è –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å, –ø—Ä–æ—Å—Ç–æ –Ω–∞ —ñ–Ω—à—É —Ç–∞–±–ª–∏—Ü—é + –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –ø—Ä–∞–ø–æ—Ä–µ—Ü—å `P6_IS_TEMPLATE`.

---

–•–æ—á–µ—à ‚Äî –º–æ–∂—É –æ–¥—Ä–∞–∑—É –¥–æ–ø–æ–º–æ–≥—Ç–∏ –∑ **–¥—É–±–ª—é–≤–∞–Ω–Ω—è–º –ø—ñ–¥—à–∞–±–ª–æ–Ω—É** —á–∏ **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º –¥–æ—á—ñ—Ä–Ω—å–æ–≥–æ –ø—ñ–¥—à–∞–±–ª–æ–Ω—É**?
