–ß—É–¥–æ–≤–æ, –¥–∞–≤–∞–π –∑—Ä–æ–±–∏–º–æ —Ü–µ **–ø–æ–µ—Ç–∞–ø–Ω–æ**, —â–æ–± –±—É–ª–æ –Ω–∞–¥—ñ–π–Ω–æ —ñ –±–µ–∑ –∑–∞–π–≤–æ–≥–æ —Å–º—ñ—Ç—Ç—è —É –ë–î.

---

## ‚úÖ –ß–∞—Å—Ç–∏–Ω–∞ 1: –û—á–∏—Å—Ç–∫–∞ `watchedItems` –ø—Ä–∏ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—ñ `P5_SWITCH`

üîπ **–£ —Ç—ñ–π —Å–∞–º—ñ–π Dynamic Action** (–¥–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞), –ø—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è (`if (confirmed)`), –¥–æ–¥–∞–π –æ—á–∏—â–µ–Ω–Ω—è –ø–æ–ª—ñ–≤:

```javascript
// –û—á–∏—Å—Ç–∫–∞ –æ—Å–Ω–æ–≤–Ω–∏—Ö item'—ñ–≤
const fieldsToClear = [
  'P5_DATE1',
  'P5_DATE2',
  'P5_DATE3',
  'P5_TEXT1',
  'P5_TEXT2',
  'P5_TEXTAREA'
];

fieldsToClear.forEach(item => apex.item(item).setValue(null));
```

> üîç –Ø–∫—â–æ –¥–µ—è–∫—ñ –∑ –ø–æ–ª—ñ–≤ –º–∞—é—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è ‚Äî –∫—Ä–∞—â–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ —Å–∞–º–µ `''`, –∞ –Ω–µ `null`.

---

## ‚úÖ –ß–∞—Å—Ç–∏–Ω–∞ 2: –Ø–∫ –±—É—Ç–∏ –∑ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è–º–∏ / –ø—ñ–¥—à–∞–±–ª–æ–Ω–∞–º–∏?

**–ü—Ä–æ–±–ª–µ–º–∞:**
–Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∂–µ –¥–æ–¥–∞–≤ –∑–∞–ø–∏—Å–∏ –≤ `TASK_SUBTASKS` –∞–±–æ `TASK_TEMPLATE_SUBTASKS` (—á–µ—Ä–µ–∑ IG), –ø—Ä–∏ –∑–º—ñ–Ω—ñ `P5_SWITCH` ‚Äî –¥–∞–Ω—ñ –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –≤ –ë–î.

### üîí –í–∞—Ä—ñ–∞–Ω—Ç 1: –ë–ª–æ–∫—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è, —è–∫—â–æ —î –∑–∞–ø–∏—Å–∞–Ω—ñ —Ä—è–¥–∫–∏ –≤ IG

#### üîπ –ü–µ—Ä–µ–≤–∞–≥–∏:

* –ë–µ–∑–ø–µ—á–Ω–∏–π —Å–ø–æ—Å—ñ–±
* –ù–µ —Ç—Ä–µ–±–∞ –¥—É–º–∞—Ç–∏ –ø—Ä–æ –æ—á–∏—â–µ–Ω–Ω—è

#### üîπ –Ø–∫ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏:

1. –°—Ç–≤–æ—Ä–∏ **PL/SQL-–ø—Ä–æ—Ü–µ—Å** `CHECK_SUBTASKS_EXISTS` (Ajax Callback):

```plsql
DECLARE
  l_exists BOOLEAN := FALSE;
BEGIN
  IF :P5_SWITCH = '0' THEN
    SELECT 1 INTO l_exists
    FROM TASK_SUBTASKS
    WHERE TASK_ID = :P5_TASK_ID AND ROWNUM = 1;
  ELSE
    SELECT 1 INTO l_exists
    FROM TASK_TEMPLATE_SUBTASKS
    WHERE TEMPLATE_ID = :P5_TASK_ID AND ROWNUM = 1;
  END IF;

  APEX_JSON.OPEN_OBJECT;
  APEX_JSON.WRITE('hasRows', CASE WHEN l_exists THEN 'Y' ELSE 'N' END);
  APEX_JSON.CLOSE_OBJECT;
EXCEPTION
  WHEN NO_DATA_FOUND THEN
    APEX_JSON.OPEN_OBJECT;
    APEX_JSON.WRITE('hasRows', 'N');
    APEX_JSON.CLOSE_OBJECT;
END;
```

2. –£ JS –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é `P5_SWITCH`:

```javascript
apex.server.process('CHECK_SUBTASKS_EXISTS', {
  x01: $v('P5_SWITCH')
}, {
  dataType: 'json',
  success: function(data) {
    if (data.hasRows === 'Y') {
      apex.message.alert("‚ö† –ù–µ–º–æ–∂–ª–∏–≤–æ –∑–º—ñ–Ω–∏—Ç–∏ —Ç–∏–ø. –Ü—Å–Ω—É—é—Ç—å –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è –∞–±–æ –ø—ñ–¥—à–∞–±–ª–æ–Ω–∏.");
      // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –Ω–∞–∑–∞–¥
      apex.item('P5_SWITCH').setValue($v('P5_SWITCH_PREV'));
    } else {
      // –û—á–∏—â–∞—î–º–æ —ñ–Ω—à—ñ –ø–æ–ª—è
      fieldsToClear.forEach(item => apex.item(item).setValue(null));
      apex.item("P5_SWITCH_PREV").setValue($v("P5_SWITCH"));
    }
  },
  error: function() {
    apex.message.alert("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–≤—ñ—Ä—Ü—ñ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å.");
  }
});
```

---

### üßπ –í–∞—Ä—ñ–∞–Ω—Ç 2: –í–∏–¥–∞–ª—è—Ç–∏ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—ñ

> ‚ùó –†–∏–∑–∏–∫–æ–≤–∞–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥: –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –≤–∏–ø–∞–¥–∫–æ–≤–æ –≤—Ç—Ä–∞—Ç–∏—Ç–∏ –¥–∞–Ω—ñ.

–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –ª–∏—à–µ, —è–∫—â–æ:

* –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —Ç–∏–º—á–∞—Å–æ–≤–æ (—á–µ—Ä–µ–∑ `DRAFT_ID`)
* –Ω–µ–º–∞—î —Ä–∏–∑–∏–∫—É –≤—Ç—Ä–∞—Ç–∏—Ç–∏ "–∂–∏–≤—ñ" –¥–∞–Ω—ñ

---

## ‚úÖ –©–æ —è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é

1. **–ó–∞–±–æ—Ä–æ–Ω—è—Ç–∏ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è, —è–∫—â–æ —î –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –∑–∞–ø–∏—Å–∏** ‚Äî —Ü–µ **–Ω–∞–π–±–µ–∑–ø–µ—á–Ω—ñ—à–µ —ñ –Ω–∞–π–ø—Ä–æ–∑–æ—Ä—ñ—à–µ** –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
2. –û—á–∏—Å—Ç–∫–∞ –æ—Å–Ω–æ–≤–Ω–∏—Ö item'—ñ–≤ ‚Äî –ø—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–º—ñ–Ω–∏ `P5_SWITCH`.

---

üîú –ì–æ—Ç–æ–≤–∏–π –¥–æ–ø–æ–º–æ–≥—Ç–∏ –¥–æ–æ–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ Ajax-–ø—Ä–æ—Ü–µ—Å –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ `DRAFT_ID`, —è–∫—â–æ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è —â–µ –Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–æ –æ—Å–Ω–æ–≤–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ?
