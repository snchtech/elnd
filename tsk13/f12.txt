–ß—É–¥–æ–≤–æ! üîî –î–∞–≤–∞–π –∑—Ä–æ–±–∏–º–æ **–ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –¥—ñ–π —á–µ—Ä–µ–∑ `apex.message.confirm`** –∑–∞–º—ñ—Å—Ç—å –ø—Ä–æ—Å—Ç–æ–≥–æ `window.confirm`.

–¶–µ:

* –≤–∏–≥–ª—è–¥–∞—î –Ω–∞—Ç–∏–≤–Ω–æ –≤ —Å—Ç–∏–ª—ñ APEX
* –∫—Ä–∞—â–µ –ø—Ä–∞—Ü—é—î –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö
* –Ω–µ –±–ª–æ–∫—É—î –ø–æ—Ç—ñ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–µ)

---

## ‚úÖ –ü–æ–≤–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è: –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –æ—á–∏—â–µ–Ω–Ω—è —Ñ–æ—Ä–º–∏ –ø—Ä–∏ –∑–º—ñ–Ω—ñ `P_TASK_MODE`

### üîπ 1. JavaScript –Ω–∞ `Change` –¥–ª—è `P_TASK_MODE`

–°—Ç–≤–æ—Ä–∏ **Dynamic Action**:

* **Name**: `On Task Mode Change`
* **Event**: `Change`
* **Selection Type**: `Item` ‚Üí `P_TASK_MODE`
* **True Action**: `Execute JavaScript Code`

### üîπ 2. –ö–æ–¥ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑ `apex.message.confirm`

```javascript
const hasSubtasks = apex.region('TASK_SUBTASKS_IG_1')?.widget()?.interactiveGrid("getViews", "grid").model.length > 0;
const hasSubtemplates = apex.region('TASK_TEMPLATE_SUBTASKS_IG')?.widget()?.interactiveGrid("getViews", "grid").model.length > 0;

if (hasSubtasks || hasSubtemplates) {
  apex.message.alert("–°–ø–æ—á–∞—Ç–∫—É –≤–∏–¥–∞–ª—ñ—Ç—å —É—Å—ñ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è –∞–±–æ –ø—ñ–¥—à–∞–±–ª–æ–Ω–∏ –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é —Ç–∏–ø—É.");
  $s("P_TASK_MODE", $v("P_TASK_MODE")); // –ü–æ–≤–µ—Ä—Ç–∞—î –ø–æ–ø–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è
  return;
}

apex.message.confirm(
  "–£—Å—ñ –≤–≤–µ–¥–µ–Ω—ñ –¥–∞–Ω—ñ –±—É–¥–µ –æ—á–∏—â–µ–Ω–æ. –í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏?",
  function(okPressed) {
    if (okPressed) {
      clearTaskFormFields();
    } else {
      $s("P_TASK_MODE", $v("P_TASK_MODE")); // –°–∫–∞—Å–æ–≤—É—î–º–æ –∑–º—ñ–Ω—É
    }
  }
);
```

---

### üîπ 3. –§—É–Ω–∫—Ü—ñ—è –æ—á–∏—â–µ–Ω–Ω—è —Ñ–æ—Ä–º–∏ `clearTaskFormFields()`

–ú–æ–∂–µ—à –¥–æ–¥–∞—Ç–∏ –≤ `Page Function and Global Variable Declaration`:

```javascript
function clearTaskFormFields() {
  const itemsToClear = [
    'P_TASK_CONTENT', 'P_NOTE', 'P_PLANNING_DATE_START', 'P_PLANNING_DATE_END',
    'P_PERIOD_MODE', 'P_PERIOD_INTERVAL', 'P_PERIOD_TIME', 'P_WEEKLY_DAYS',
    'P_WEEKLY_TIME', 'P_DATE_END', 'P_TYPE_ID', 'P_UNIT', 'P_TASK_ID', 'P_TEMPLATE_ID'
  ];
  itemsToClear.forEach(id => $s(id, ""));

  // Reset IG (–æ—á–∏—â–µ–Ω–Ω—è –∑–∞–ø–∏—Å—ñ–≤ –±–µ–∑ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è)
  apex.region('TASK_SUBTASKS_IG_1')?.widget()?.interactiveGrid("getActions").invoke("reset");
  apex.region('TASK_TEMPLATE_SUBTASKS_IG')?.widget()?.interactiveGrid("getActions").invoke("reset");

  // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–∏–¥–∏–º–æ—Å—Ç—ñ –ø–æ–ª—ñ–≤ (—É —Ä–∞–∑—ñ –ø–æ—Ç—Ä–µ–±–∏)
  apex.event.trigger(document, "task_mode_reset");
}
```

---

### üîπ 4. –ö–∞—Å—Ç–æ–º–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø—ñ—Å–ª—è –æ—á–∏—â–µ–Ω–Ω—è (–Ω–µ–æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ)

–°—Ç–≤–æ—Ä–∏ —â–µ –æ–¥–∏–Ω Dynamic Action:

* **Event**: `Custom Event`
* **Event Name**: `task_mode_reset`
* **True Action**: –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `Execute JavaScript Code`
  –î–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É, –ø–æ–∫–∞–∑—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–æ—â–æ.

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

| –ü–æ–¥—ñ—è                                      | –ü–æ–≤–µ–¥—ñ–Ω–∫–∞                   |
| ------------------------------------------ | --------------------------- |
| –ó–º—ñ–Ω–∞ `P_TASK_MODE`, —è–∫—â–æ —î –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è    | ‚ùå –ë–ª–æ–∫—É—î—Ç—å—Å—è                |
| –ó–º—ñ–Ω–∞ `P_TASK_MODE`, —è–∫—â–æ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å –Ω–µ–º–∞—î | üîî –ó–∞–ø–∏—Ç –Ω–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è   |
| –ü—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è                        | üßπ –û—á–∏—â–µ–Ω–Ω—è –≤—Å—ñ—Ö –ø–æ–ª—ñ–≤, IG  |
| –ü—ñ—Å–ª—è —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è                           | üîÑ –°–∫–∞—Å–æ–≤—É—î—Ç—å—Å—è –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è |

---

–•–æ—á–µ—à, —â–æ–± –º–∏ –∑—Ä–æ–±–∏–ª–∏ —Ç–∞–∫–µ —Å–∞–º–µ –¥–ª—è –∑–º—ñ–Ω–∏ `P_SELECT_TASK_TYPE` –∞–±–æ `P_PERIOD_MODE`?
