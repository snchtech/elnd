–û–∫–µ–π! –ü–æ–∫–∞–∂—É, —è–∫ **–æ–Ω–æ–≤–∏—Ç–∏ –∑–∞–ø–∏—Å–∏ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å —ñ–∑ `APEX_COLLECTION` —É —Ç–∞–±–ª–∏—Ü—é `TASK_SUBTASKS`**, —è–∫—â–æ –≤–æ–Ω–∏ –º–∞—é—Ç—å —Å—Ç–∞—Ç—É—Å `EXISTING`.

---

## ‚úÖ –ß–∞—Å—Ç–∏–Ω–∞ –ø—Ä–æ—Ü–µ—Å–∏–Ω–≥—É: `UPDATE EXISTING` —É —Ç–∞–±–ª–∏—Ü—ñ

–¶–µ–π –∫–æ–¥ –¥–æ–¥–∞—î—Ç—å—Å—è —É –∫—ñ–Ω–µ—Ü—å —Ç–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É `SAVE_TASK_SUBTASKS_FROM_COLLECTION` –ø—ñ—Å–ª—è –≤—Å—Ç–∞–≤–∫–∏ `NEW` —Ç–∞ –ø–µ—Ä–µ–¥ –æ—á–∏—â–µ–Ω–Ω—è–º –∫–æ–ª–µ–∫—Ü—ñ—ó:

```plsql
-- –û–Ω–æ–≤–ª—é—î–º–æ EXISTING –∑–∞–ø–∏—Å–∏
FOR r IN (
  SELECT
    c002 AS id,
    c001 AS subtask_content,
    c003 AS planning_date_end,
    c008 AS subtask_order,
    c009 AS parent_id
  FROM apex_collections
  WHERE collection_name = 'TASK_SUBTASKS_COLLECTION'
    AND c010 = 'EXISTING'
    AND c002 IS NOT NULL -- –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –º–∞—î –±—É—Ç–∏ ID –∑–∞–ø–∏—Å—É –∑ –ë–î
) LOOP
  UPDATE TASK_SUBTASKS
  SET
    SUBTASK_CONTENT    = r.subtask_content,
    PLANNING_DATE_END  = TO_DATE(r.planning_date_end, 'YYYY-MM-DD HH24:MI:SS'),
    SUBTASK_ORDER      = TO_NUMBER(r.subtask_order),
    PARENT_ID          = TO_NUMBER(r.parent_id)
  WHERE ID = r.id;
END LOOP;
```

> ‚ö†Ô∏è `TO_DATE(...)` —ñ `TO_NUMBER(...)` –ø–æ—Ç—Ä—ñ–±–Ω—ñ, —è–∫—â–æ –ø–æ–ª—è –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É –∫–æ–ª–µ–∫—Ü—ñ—ó —è–∫ —Ç–µ–∫—Å—Ç (—â–æ –∑–∞–∑–≤–∏—á–∞–π —Ç–∞–∫ —ñ —î).

---

## üß† –ü–æ—è—Å–Ω–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç—ñ–≤ —É `APEX_COLLECTION`

* `C001` ‚Äî SUBTASK\_CONTENT
* `C002` ‚Äî ID (—è–∫—â–æ –≤–∂–µ —î –≤ –ë–î)
* `C003` ‚Äî PLANNING\_DATE\_END
* `C008` ‚Äî SUBTASK\_ORDER
* `C009` ‚Äî PARENT\_ID
* `C010` ‚Äî —Å—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å—É (`NEW`, `EXISTING`, `DELETED`)

---

## ‚úÖ –ü—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

> –£ –∫—ñ–Ω—Ü—ñ **–æ—á–∏—â–∞–π –∫–æ–ª–µ–∫—Ü—ñ—é**, —Ç—ñ–ª—å–∫–∏ **–ø—ñ—Å–ª—è –≤—Å—ñ—Ö insert / update / delete**:

```plsql
APEX_COLLECTION.DELETE_COLLECTION('TASK_SUBTASKS_COLLECTION');
```

---

## üîÑ –ü–æ–≤–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫ –¥—ñ–π —É –ø—Ä–æ—Ü–µ—Å—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è:

1. Insert –Ω–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ (`C010 = 'NEW'`)
2. Update —ñ—Å–Ω—É—é—á–∏—Ö (`C010 = 'EXISTING'`)
3. Delete –≤–∏–¥–∞–ª–µ–Ω–∏—Ö (`C010 = 'DELETED'`)
4. –û—á–∏—Å—Ç–∏—Ç–∏ –∫–æ–ª–µ–∫—Ü—ñ—é

---

üîß –ì–æ—Ç–æ–≤–∏–π –¥–æ–ø–æ–º–æ–≥—Ç–∏ –Ω–∞–ø–∏—Å–∞—Ç–∏ –≤–µ—Å—å `SAVE_TASK_SUBTASKS_FROM_COLLECTION` —è–∫ —î–¥–∏–Ω–∏–π –ø—Ä–æ—Ü–µ—Å ‚Äî —Å–∫–∞–∑–∞—Ç–∏?
