–¢–∏ **—á—É–¥–æ–≤–æ –∑–∞—É–≤–∞–∂–∏–≤**: –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ `$s("P_TASK_MODE", previousTaskMode)` —É **`Change` Dynamic Action** –≤–∏–Ω–∏–∫–∞—î **—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π –≤–∏–∫–ª–∏–∫** ‚Üí –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è ‚Üí ‚ùå **–∑–∞—Ü–∏–∫–ª–µ–Ω–Ω—è**.

---

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è: **–í—ñ–¥–∫–ª–∞–¥–µ–Ω–∏–π, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –ø–µ—Ä–µ–º–∏–∫–∞—á (UI-only –±–ª–æ–∫—É–≤–∞–Ω–Ω—è)**

–ú–∏ –∑—Ä–æ–±–∏–º–æ –ø–µ—Ä–µ–º–∏–∫–∞—á `P_TASK_MODE` **–Ω–µ–∞–∫—Ç–∏–≤–Ω–∏–º (disabled)**, —è–∫—â–æ:

* –≤–∂–µ —î –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è / –ø—ñ–¥—à–∞–±–ª–æ–Ω–∏
* –∞–±–æ —è–∫—â–æ –≤–∂–µ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ –≤–∞–∂–ª–∏–≤—ñ –ø–æ–ª—è

### üîß –Ü–¥–µ—è: –∑–∞–º—ñ—Å—Ç—å –∑–º—ñ–Ω–∏ –∑–Ω–∞—á–µ–Ω–Ω—è `P_TASK_MODE` ‚Äî **–±–ª–æ–∫—É—î–º–æ –∫–ª—ñ–∫–∏**, –∞–ª–µ –ø–æ–∫–∞–∑—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

---

## üß© –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

### 1. –î–æ–¥–∞—î–º–æ **Dynamic Action** –Ω–∞ –ø–æ–¥—ñ—é `Change` –¥–ª—è `P_TASK_MODE`

* **Condition (JavaScript Expression)**: `true`
* True Action: **Execute JavaScript Code**

```javascript
const blocked = hasUnsavedData(); // —Ç–≤–æ—è –ª–æ–≥—ñ–∫–∞
if (blocked) {
  apex.message.alert("–í–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ —Ç–∏–ø, –¥–æ–∫–∏ –Ω–µ –æ—á–∏—Å—Ç–∏—Ç–µ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è –∞–±–æ –ø–æ–ª—è —Ñ–æ—Ä–º–∏.");
  // ‚ùó –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –≤–∏–≥–ª—è–¥ UI (–±–µ–∑ –∑–º—ñ–Ω)
  setTimeout(() => {
    apex.item("P_TASK_MODE").setValue(apex.item("P_TASK_MODE").getValue(), null, true); // —Å–∫–∏–¥–∞—î –¥–æ —Ç–æ–≥–æ –∂ –∑–Ω–∞—á–µ–Ω–Ω—è ‚Äî –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Ç—Ä–∏–≥–µ—Ä–∞
  }, 0);
}
```

---

### 2. –°—Ç–≤–æ—Ä—é—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é `hasUnsavedData()`:

```javascript
function hasUnsavedData() {
  // –ü—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è
  const hasSubtasks = apex.region('TASK_SUBTASKS_IG_1')?.widget()?.interactiveGrid("getViews", "grid").model.length > 0;
  const hasSubtemplates = apex.region('TASK_TEMPLATE_SUBTASKS_IG')?.widget()?.interactiveGrid("getViews", "grid").model.length > 0;

  // –ß–∏ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ —è–∫—ñ—Å—å –ø–æ–ª—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥)
  const filled = ['P_TASK_CONTENT', 'P_NOTE', 'P_UNIT'].some(id => $v(id) && $v(id).trim() !== '');

  return hasSubtasks || hasSubtemplates || filled;
}
```

> –ó–∞ –ø–æ—Ç—Ä–µ–±–∏ —Ä–æ–∑—à–∏—Ä —Ü—é –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —ñ–Ω—à–∏–º–∏ `item`

---

### üîí 3. –î–æ–¥–∞—Ç–∫–æ–≤–æ ‚Äî –±–ª–æ–∫—É–≤–∞—Ç–∏ `switch` (select –∞–±–æ radio group) **CSS + JS**

–ú–æ–∂–Ω–∞ –≤–∑–∞–≥–∞–ª—ñ –≤—ñ–∑—É–∞–ª—å–Ω–æ "–∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏" —Ü–µ–π –µ–ª–µ–º–µ–Ω—Ç, —è–∫—â–æ –≤–∂–µ –ø–æ—á–∞—Ç–∞ —Ä–æ–±–æ—Ç–∞:

```javascript
if (hasUnsavedData()) {
  apex.item("P_TASK_MODE").disable(); // —Ç–∏–º—á–∞—Å–æ–≤–æ
}
```

–Ü –ø–æ–∫–∞–∑–∞—Ç–∏ —Ç—É–ª—Ç—ñ–ø –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ:

```css
#P_TASK_MODE[disabled] {
  cursor: not-allowed;
}
#P_TASK_MODE[disabled]::after {
  content: "–û—á–∏—Å—Ç—ñ—Ç—å –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é —Ä–µ–∂–∏–º—É";
}
```

---

## üîö –í–∏—Å–Ω–æ–≤–æ–∫:

| –°—Ü–µ–Ω–∞—Ä—ñ–π                 | –†—ñ—à–µ–Ω–Ω—è                                                       |
| ------------------------ | ------------------------------------------------------------- |
| –ó–∞—Ü–∏–∫–ª–µ–Ω–Ω—è –ø—Ä–∏ `$s(...)` | ‚ùå –ù–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å ‚Äî –≤–∏–∫–ª–∏–∫–∞—î `change`                            |
| –ü—Ä–∞–≤–∏–ª—å–Ω–∞ UX-–ª–æ–≥—ñ–∫–∞      | ‚úÖ –ü–æ–∫–∞–∑–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è + —Å–∫–∞—Å—É–≤–∞—Ç–∏ –¥—ñ—é                       |
| –ö—Ä–∞—â–µ                    | üîí Disable `P_TASK_MODE` –¥–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å –∞–±–æ –æ—á–∏—â–µ–Ω–Ω—è |
| –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞             | –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ JavaScript —Ñ—É–Ω–∫—Ü—ñ—é `hasUnsavedData()`             |

---

üîß –•–æ—á–µ—à ‚Äî —è –º–æ–∂—É –∑—ñ–±—Ä–∞—Ç–∏ –ø–æ–≤–Ω–∏–π –≥–æ—Ç–æ–≤–∏–π —à–∞–±–ª–æ–Ω –∑ —Ü–∏–º –ø—ñ–¥—Ö–æ–¥–æ–º –¥–ª—è `Change` + `Disable` –ª–æ–≥—ñ–∫–∏, –∑ —É—Å—ñ–º–∞ –∫–æ–º–µ–Ω—Ç–∞—Ä—è–º–∏?
