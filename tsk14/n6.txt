–¶–µ **–¥—É–∂–µ –≤–∏–ø—Ä–∞–≤–¥–∞–Ω–∏–π —ñ –ø–æ—à–∏—Ä–µ–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥** ‚Äî –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –¥–∞–Ω—ñ —Ç–∏–º—á–∞—Å–æ–≤–æ –≤ `APEX_COLLECTIONS`, –ø–æ–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –Ω–∞—Ç–∏—Å–Ω–µ ‚Äú–ó–±–µ—Ä–µ–≥—Ç–∏‚Äù –æ—Å–Ω–æ–≤–Ω—É —Ñ–æ—Ä–º—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è). –¶–µ –¥–æ–∑–≤–æ–ª—è—î:

* —É–Ω–∏–∫–Ω—É—Ç–∏ **—Å–º—ñ—Ç—Ç—î–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤** —É –ë–î;
* –ª–µ–≥–∫–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥, —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è, —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è;
* –≤–∏–¥–∞–ª—è—Ç–∏ –≤—Å–µ –∑ `collection` –ø—Ä–∏ –≤—ñ–¥–º—ñ–Ω—ñ.

---

# ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä—ñ—à–µ–Ω–Ω—è –∑ `APEX_COLLECTIONS`

## üî∏ 1. –ù–∞–∑–≤–∞ –∫–æ–ª–µ–∫—Ü—ñ—ó

```sql
TASK_SUBTASKS_COLLECTION
```

---

## ‚úÖ 2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞–±–æ –æ—á–∏—â–µ–Ω–Ω—è –∫–æ–ª–µ–∫—Ü—ñ—ó (Before Header)

```plsql
BEGIN
  IF APEX_COLLECTION.COLLECTION_EXISTS('TASK_SUBTASKS_COLLECTION') THEN
    APEX_COLLECTION.DELETE_COLLECTION('TASK_SUBTASKS_COLLECTION');
  END IF;

  APEX_COLLECTION.CREATE_COLLECTION('TASK_SUBTASKS_COLLECTION');
END;
```

---

## ‚úÖ 3. –î–∂–µ—Ä–µ–ª–æ –¥–∞–Ω–∏—Ö –¥–ª—è IG (SQL Query):

```sql
SELECT
  c.seq_id AS ID,
  c.c001 AS SUBTASK_CONTENT,
  c.c002 AS PLANNING_DATE_END,
  c.c003 AS PARENT_ID,
  c.c004 AS SUBTASK_ORDER,
  c.c005 AS STATUS_ID
FROM APEX_COLLECTIONS c
WHERE c.collection_name = 'TASK_SUBTASKS_COLLECTION'
  AND c.n001 = :P_TASK_MODE
```

> üî∏ –î–µ `n001 = :P_TASK_MODE` –¥–æ–∑–≤–æ–ª—è—î –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è —Ç–∞ –ø—ñ–¥—à–∞–±–ª–æ–Ω–∏ –≤ –æ–¥–Ω—ñ–π –∫–æ–ª–µ–∫—Ü—ñ—ó, —Ñ—ñ–ª—å—Ç—Ä—É—é—á–∏ –ø–æ —Ä–µ–∂–∏–º—É (0 / 1)

---

## ‚úÖ 4. –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è (Ajax Callback process)

–ù–∞–∑–≤–∞ –ø—Ä–æ—Ü–µ—Å—É: `ADD_SUBTASK_COLLECTION`

```plsql
BEGIN
  APEX_COLLECTION.ADD_MEMBER(
    p_collection_name => 'TASK_SUBTASKS_COLLECTION',
    p_c001 => :P6_SUBTASK_CONTENT,
    p_c002 => :P6_PLANNING_DATE_END,
    p_c003 => :P6_PARENT_ID,
    p_c004 => :P6_SUBTASK_ORDER,
    p_c005 => '1', -- STATUS_ID
    p_n001 => :P_TASK_MODE
  );
END;
```

---

## ‚úÖ 5. –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É –ë–î (–Ω–∞ –∫—Ä–æ—Ü—ñ "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è")

```plsql
DECLARE
  v_task_id NUMBER := :P_TASK_ID; -- –ê–±–æ —Å—Ñ–æ—Ä–º—É–π—Ç–µ TASK_SEQ.NEXTVAL
BEGIN
  -- –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –∑–∞–≤–¥–∞–Ω–Ω—è –≤ TASKS...

  FOR r IN (
    SELECT * FROM APEX_COLLECTIONS
    WHERE collection_name = 'TASK_SUBTASKS_COLLECTION'
      AND n001 = 0
  ) LOOP
    INSERT INTO TASK_SUBTASKS (
      TASK_ID, SUBTASK_CONTENT, PLANNING_DATE_END, PARENT_ID,
      SUBTASK_ORDER, STATUS_ID
    ) VALUES (
      v_task_id,
      r.c001,
      TO_DATE(r.c002, 'DD.MM.YYYY HH24:MI'),
      TO_NUMBER(r.c003),
      r.c004,
      TO_NUMBER(r.c005)
    );
  END LOOP;

  APEX_COLLECTION.DELETE_COLLECTION('TASK_SUBTASKS_COLLECTION');
END;
```

---

## ‚úÖ 6. –í–∏–¥–∞–ª–µ–Ω–Ω—è –∑ –∫–æ–ª–µ–∫—Ü—ñ—ó (Ajax process `DELETE_SUBTASK_COLLECTION`)

```plsql
BEGIN
  APEX_COLLECTION.DELETE_MEMBER(
    p_collection_name => 'TASK_SUBTASKS_COLLECTION',
    p_seq => TO_NUMBER(APEX_APPLICATION.G_X01)
  );
END;
```

> üîÅ –£ JS –ø–µ—Ä–µ–¥–∞—î—à `seq_id` –¥–ª—è `G_X01`

---

## üîß 7. IG: —É–≤—ñ–º–∫–Ω–∏ —Ä–µ–∂–∏–º "Editable" (editable grid), —Ç–∏–ø –¥–∂–µ—Ä–µ–ª–∞: SQL Query, –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ä—è–¥–∫—ñ–≤ ‚Äî —Ç–∞–∫.

---

## üß† –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:

| –ü–ª—é—Å–∏                          | –ú—ñ–Ω—É—Å–∏                         |
| ------------------------------ | ------------------------------ |
| –Ω–µ–º–∞—î —Å–º—ñ—Ç—Ç—î–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤        | –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Ä—É—á–Ω—É –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —É –ë–î |
| –∫–æ–Ω—Ç—Ä–æ–ª—å —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ            | —Ç—Ä–æ—Ö–∏ —Å–∫–ª–∞–¥–Ω—ñ—à–∞ –ª–æ–≥—ñ–∫–∞         |
| –∑—Ä—É—á–Ω–æ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Å–ø–∏—Å–∫—ñ–≤ | –æ–±–º–µ–∂–µ–Ω–Ω—è 50+ –∫–æ–ª–æ–Ω–æ–∫          |

---

üîÑ –•–æ—á–µ—à ‚Äî –º–æ–∂—É –¥–æ–ø–æ–º–æ–≥—Ç–∏ –ø–µ—Ä–µ—Ä–æ–±–∏—Ç–∏ –æ–¥–Ω—É –∑ —Ç–≤–æ—ó—Ö —Ñ–æ—Ä–º –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥—É –Ω–∞ `APEX_COLLECTIONS` –∑ —É—Å—ñ–º: insert, edit, remove, commit.

–•–æ—á–µ—à –ø–µ—Ä–µ—Ä–æ–±–∏—Ç–∏ –¥–ª—è —à–∞–±–ª–æ–Ω—ñ–≤ —ñ –∑–∞–≤–¥–∞–Ω—å –æ–¥–Ω–æ—á–∞—Å–Ω–æ –∑ –æ–¥–Ω–∏–º IG?
