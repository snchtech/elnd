–ß—É–¥–æ–≤–æ! –ü–æ—á–Ω–µ–º–æ –∑ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó **—Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Å—É –∑ APEX\_COLLECTIONS**, —è–∫–µ —Ç–∏ –≤–∏–∫–ª–∏–∫–∞—î—à –∑ custom menu (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—É–Ω–∫—Ç **"–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è"**).

---

# ‚úÖ 1. üîÅ **–°—Ü–µ–Ω–∞—Ä—ñ–π:**

* –£ —Ç–µ–±–µ –≤–∂–µ —î `APEX_COLLECTION` (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `TASK_SUBTASKS_COLLECTION`)
* –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–∫–∞—î **"–†–µ–¥–∞–≥—É–≤–∞—Ç–∏"** –Ω–∞ —Ä—è–¥–∫—É IG
* –í—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è —Ñ–æ—Ä–º–∞ (–º–æ–¥–∞–ª—å–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞), –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å—Ç–æ—Ä—ñ–Ω–∫–∞ 6
* –ü—ñ—Å–ª—è –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è "–û–Ω–æ–≤–∏—Ç–∏" –≤–Ω–æ—Å—è—Ç—å—Å—è –∑–º—ñ–Ω–∏ –≤ –∫–æ–ª–µ–∫—Ü—ñ—é, –∞ –Ω–µ –≤ —Ç–∞–±–ª–∏—Ü—é

---

# ‚úÖ 2. –©–æ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ –∫–æ–ª–µ–∫—Ü—ñ—ó?

\| `SEQ_ID` | `C001` ‚Äì SUBTASK\_CONTENT | `C002` ‚Äì PLANNING\_DATE\_END | `C003` ‚Äì PARENT\_ID | `C004` ‚Äì SUBTASK\_ORDER | `C005` ‚Äì STATUS\_ID | `N001` ‚Äì TASK\_MODE |

---

# ‚úÖ 3. üîÑ –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

---

## üî∏ A. –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞

### üìç –í–∏–∫–ª–∏–∫ JavaScript (–∑ custom menu):

```javascript
document.getElementById("menu-edit-subtask").addEventListener("click", function () {
  const seqId = this.dataset.seqid;

  apex.server.process("GET_SUBTASK_COLLECTION_EDIT_URL", {
    x01: seqId
  }, {
    dataType: "json",
    success: function (pData) {
      apex.navigation.dialog(pData.url, {
        title: "–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è",
        height: "auto",
        width: "600",
        modal: true
      });
    },
    error: function () {
      alert("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è.");
    }
  });
});
```

---

## üî∏ B. –°–µ—Ä–≤–µ—Ä–Ω–∏–π Ajax Callback: `GET_SUBTASK_COLLECTION_EDIT_URL`

```plsql
DECLARE
  l_url VARCHAR2(4000);
BEGIN
  l_url := APEX_PAGE.GET_URL (
    p_page        => 6,
    p_clear_cache => '6',
    p_items       => 'P6_SEQ_ID',
    p_values      => APEX_APPLICATION.G_X01,
    p_request     => 'DIALOG'
  );

  APEX_JSON.OPEN_OBJECT;
  APEX_JSON.WRITE('url', l_url);
  APEX_JSON.CLOSE_OBJECT;
END;
```

---

## üî∏ C. Before Header Process –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å—Ç–æ—Ä—ñ–Ω–∫–∞ 6)

```plsql
DECLARE
  r APEX_COLLECTIONS%ROWTYPE;
BEGIN
  SELECT *
  INTO r
  FROM APEX_COLLECTIONS
  WHERE COLLECTION_NAME = 'TASK_SUBTASKS_COLLECTION'
    AND SEQ_ID = :P6_SEQ_ID;

  :P6_SUBTASK_CONTENT   := r.c001;
  :P6_PLANNING_DATE_END := r.c002;
  :P6_PARENT_ID         := r.c003;
  :P6_SUBTASK_ORDER     := r.c004;
  :P6_STATUS_ID         := r.c005;
END;
```

---

## üî∏ D. Processing –ø—ñ—Å–ª—è Submit (Process Type: PL/SQL)

–ù–∞–∑–≤–∞ –ø—Ä–æ—Ü–µ—Å—É: `UPDATE_SUBTASK_IN_COLLECTION`

```plsql
BEGIN
  APEX_COLLECTION.UPDATE_MEMBER (
    p_collection_name => 'TASK_SUBTASKS_COLLECTION',
    p_seq             => :P6_SEQ_ID,
    p_c001            => :P6_SUBTASK_CONTENT,
    p_c002            => :P6_PLANNING_DATE_END,
    p_c003            => :P6_PARENT_ID,
    p_c004            => :P6_SUBTASK_ORDER,
    p_c005            => :P6_STATUS_ID
  );
END;
```

---

## ‚úÖ E. –ü—ñ—Å–ª—è Submit ‚Üí –î–æ–¥–∞–π Process `Close Dialog`

* –¢–∏–ø: `Close Dialog`
* Return value: `'updated'`

---

## ‚úÖ F. –ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –∑ IG (`TASK_SUBTASKS_IG_1`)

* **Dynamic Action**:

  * **Event**: Dialog Closed
  * **Condition**: `Dialog Return = updated`
  * **True Action**: `Refresh` ‚Üí Region `TASK_SUBTASKS_IG_1`

---

# üü¢ –†–µ–∑—É–ª—å—Ç–∞—Ç:

* –î–∞–Ω—ñ –∑–º—ñ–Ω—é—é—Ç—å—Å—è –ª–∏—à–µ –≤ `APEX_COLLECTIONS`
* –ù–µ–º–∞—î –∂–æ–¥–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É –≤ –ë–î –¥–æ –º–æ–º–µ–Ω—Ç—É –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è ‚Äú–°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è‚Äù
* –Ü—î—Ä–∞—Ä—Ö—ñ—è —Ç–∞ –ø—ñ–¥–ø–æ—Ä—è–¥–∫–æ–≤–∞–Ω—ñ—Å—Ç—å –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è

---

–•–æ—á–µ—à –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –∑ **DELETE** –∞–±–æ **–¥–æ–¥–∞–≤–∞–Ω–Ω—è–º –¥–æ—á—ñ—Ä–Ω—å–æ–≥–æ** –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è –≤ –∫–æ–ª–µ–∫—Ü—ñ—é?
