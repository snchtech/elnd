–ß—É–¥–æ–≤–æ! –û—Å—å —è–∫ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **—ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—é –∫–æ–ª–µ–∫—Ü—ñ—ó –¥–ª—è –ø—ñ–¥—à–∞–±–ª–æ–Ω—ñ–≤ (`TASK_TEMPLATE_SUBTASKS`)** —É `BEFORE HEADER PROCESS`.

---

## ‚úÖ PL/SQL: –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è `TASK_SUBTASKS_COLLECTION` –¥–ª—è —à–∞–±–ª–æ–Ω—ñ–≤ (TASK\_MODE = 1)

```plsql
BEGIN
  -- –°—Ç–≤–æ—Ä—é—î–º–æ –∫–æ–ª–µ–∫—Ü—ñ—é, —è–∫—â–æ —ó—ó —â–µ –Ω–µ–º–∞—î
  IF NOT APEX_COLLECTION.COLLECTION_EXISTS('TASK_SUBTASKS_COLLECTION') THEN
    APEX_COLLECTION.CREATE_COLLECTION('TASK_SUBTASKS_COLLECTION');

    -- –Ø–∫—â–æ –º–∏ —Ä–µ–¥–∞–≥—É—î–º–æ —à–∞–±–ª–æ–Ω, –∑–∞–ø–æ–≤–Ω—é—î–º–æ –¥–∞–Ω–∏–º–∏ –∑ TASK_TEMPLATE_SUBTASKS
    IF :P8_TASK_MODE = 1 AND :P8_TASK_ID IS NOT NULL THEN
      FOR r IN (
        SELECT 
          ID,
          TEMPLATE_ID,
          SUBTASK_CONTENT,
          STATUS_ID,
          PARENT_ID,
          SUBTASK_ORDER
        FROM TASK_TEMPLATE_SUBTASKS
        WHERE TEMPLATE_ID = :P8_TASK_ID
      ) LOOP
        APEX_COLLECTION.ADD_MEMBER(
          p_collection_name => 'TASK_SUBTASKS_COLLECTION',
          -- –ó–Ω–∞—á–µ–Ω–Ω—è:
          p_c001 => r.TEMPLATE_ID,            -- –ó–∞–º—ñ—Å—Ç—å TASK_ID ‚Üí TEMPLATE_ID
          p_c002 => r.SUBTASK_CONTENT,
          p_c003 => r.STATUS_ID,
          p_c004 => NULL,                     -- PLANNING_DATE_END ‚Äî –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —à–∞–±–ª–æ–Ω—ñ–≤
          p_c005 => TO_CHAR(r.PARENT_ID),
          p_c006 => TO_CHAR(r.SUBTASK_ORDER),
          p_n001 => :P8_TASK_MODE             -- TASK_MODE = 1
        );
      END LOOP;
    END IF;

  END IF;
END;
```

---

## üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–Ω–∞—á–µ–Ω—å —É –∫–æ–ª–µ–∫—Ü—ñ—ó `TASK_SUBTASKS_COLLECTION`

| –ö–æ–ª–µ–∫—Ü—ñ—è | –ó–Ω–∞—á–µ–Ω–Ω—è (–¥–ª—è —à–∞–±–ª–æ–Ω—ñ–≤) | –ö–æ–º–µ–Ω—Ç–∞—Ä                              |
| -------- | ----------------------- | ------------------------------------- |
| `p_c001` | `TEMPLATE_ID`           | –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —à–∞–±–ª–æ–Ω—É                 |
| `p_c002` | `SUBTASK_CONTENT`       | –ù–∞–∑–≤–∞ –ø—ñ–¥—à–∞–±–ª–æ–Ω—É                      |
| `p_c003` | `STATUS_ID`             | –°—Ç–∞—Ç—É—Å                                |
| `p_c004` | `NULL`                  | –î–∞—Ç–∞ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —à–∞–±–ª–æ–Ω—ñ–≤ |
| `p_c005` | `PARENT_ID`             | –Ü—î—Ä–∞—Ä—Ö—ñ—è                              |
| `p_c006` | `SUBTASK_ORDER`         | –ü–æ—Ä—è–¥–æ–∫                               |
| `p_n001` | `1`                     | TASK\_MODE = 1 –¥–ª—è —à–∞–±–ª–æ–Ω—ñ–≤           |

---

## üí° –ü–æ—Ä–∞–¥–∞:

–Ø–∫—â–æ —Ç–∏ —Ö–æ—á–µ—à **–≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ IG –¥–ª—è —à–∞–±–ª–æ–Ω—ñ–≤ —ñ –∑–∞–≤–¥–∞–Ω—å**, –º–æ–∂–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –∑–∞ `p_n001 = 0` –∞–±–æ `p_n001 = 1` —É SQL –∑–∞–ø–∏—Ç—ñ –¥–æ IG –∞–±–æ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ —Ä–µ–≥—ñ–æ–Ω–∏ —á–µ—Ä–µ–∑ `Server-Side Condition`.

---

–ì–æ—Ç–æ–≤–∏–π –ø–æ–∫–∞–∑–∞—Ç–∏, —è–∫ –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è –∞–±–æ —à–∞–±–ª–æ–Ω—É –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Ç–∞–±–ª–∏—Ü—ñ `TASK_SUBTASKS` –∞–±–æ `TASK_TEMPLATE_SUBTASKS` –∑ –∫–æ–ª–µ–∫—Ü—ñ—ó?
