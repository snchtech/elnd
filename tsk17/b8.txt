–©–æ–± –ø—Ä–∏ **–¥–æ–¥–∞–≤–∞–Ω–Ω—ñ –∑–∞–ø–∏—Å—É –≤ —Ç–∞–±–ª–∏—Ü—é `SIGNATUREHISTORY`** –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é–≤–∞–≤—Å—è —Å—Ç–∞—Ç—É—Å –∑–∞–≤–¥–∞–Ω–Ω—è (`STATUS_ID`) —É —Ç–∞–±–ª–∏—Ü—ñ `TASKS`, –≤–∞–º —Å–ª—ñ–¥ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **AFTER INSERT —Ç—Ä–∏–≥–µ—Ä** –Ω–∞ —Ç–∞–±–ª–∏—Ü—é `SIGNATUREHISTORY`.

---

## ‚úÖ **1. –õ–æ–≥—ñ–∫–∞**

* –ü—ñ—Å–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ `SIGNATUREHISTORY`, –±–µ—Ä–µ–º–æ `SIGNRIGHT_ID`.
* –ß–µ—Ä–µ–∑ `SIGNATURERIGHTS` –∑–Ω–∞—Ö–æ–¥–∏–º–æ –ø–æ–≤‚Äô—è–∑–∞–Ω–∏–π `TASK_ID`.
* –û–Ω–æ–≤–ª—é—î–º–æ `TASKS.STATUS_ID = :NEW.NEW_STATUS_ID`.

---

## üßæ **2. –ö–æ–¥ —Ç—Ä–∏–≥–µ—Ä–∞**

```sql
CREATE OR REPLACE TRIGGER trg_update_task_status
AFTER INSERT ON SIGNATUREHISTORY
FOR EACH ROW
DECLARE
  v_task_id TASKS.ID%TYPE;
BEGIN
  -- –û—Ç—Ä–∏–º—É—î–º–æ TASK_ID —á–µ—Ä–µ–∑ SIGNATURERIGHTS
  SELECT sr.TASK_ID
  INTO v_task_id
  FROM SIGNATURERIGHTS sr
  WHERE sr.ID = :NEW.SIGNRIGHT_ID;

  -- –û–Ω–æ–≤–ª—é—î–º–æ STATUS_ID —É TASKS
  UPDATE TASKS
  SET STATUS_ID = :NEW.NEW_STATUS_ID
  WHERE ID = v_task_id;

EXCEPTION
  WHEN NO_DATA_FOUND THEN
    NULL; -- SIGNRIGHT_ID –Ω–µ –∑–Ω–∞–π—à–æ–≤—Å—è ‚Äî –Ω—ñ—á–æ–≥–æ –Ω–µ –æ–Ω–æ–≤–ª—é—î–º–æ
  WHEN OTHERS THEN
    RAISE;
END;
/
```

---

## üõ°Ô∏è **3. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó**

* ‚úÖ –¢—Ä–∏–≥–µ—Ä –ø—Ä–∞—Ü—é—î –ª–∏—à–µ –ø—Ä–∏ —É—Å–ø—ñ—à–Ω—ñ–π –≤—Å—Ç–∞–≤—Ü—ñ –Ω–æ–≤–æ–≥–æ –ø—ñ–¥–ø–∏—Å—É.
* ‚úÖ –í–∏ –º–æ–∂–µ—Ç–µ –¥–æ–¥–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —É–º–æ–≤–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `ONLY IF NEW_STATUS_ID IS NOT NULL`).
* üîç –Ø–∫—â–æ `SIGNATURERIGHTS` –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ —ñ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è (`SUBTASK_ID`), –∞ –≤–∏ —Ö–æ—á–µ—Ç–µ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –¥–ª—è **–æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è**, –ª–æ–≥—ñ–∫—É –º–æ–∂–Ω–∞ —Ä–æ–∑—à–∏—Ä–∏—Ç–∏.

---

–•–æ—á–µ—Ç–µ ‚Äî –º–æ–∂—É –∞–¥–∞–ø—Ç—É–≤–∞—Ç–∏ —Ç—Ä–∏–≥–µ—Ä –¥–æ –≤–∞—à–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä—ñ—é –∑ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è–º–∏ –∞–±–æ –æ–±–º–µ–∂–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–ª—è –ø–µ–≤–Ω–∏—Ö `STAGES_ID`.
