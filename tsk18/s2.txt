–û—Å—å –∞–¥–∞–ø—Ç–æ–≤–∞–Ω–∞ –≤–µ—Ä—Å—ñ—è SQL-–∫–æ–¥—É –¥–ª—è **–∫–æ–ª–æ–Ω–∫–∏ –≤–∏–∫–æ–Ω–∞–≤—Ü—ñ**, –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º —Ç–≤–æ—î—ó –ª–æ–≥—ñ–∫–∏ –¥–ª—è `SIGNATURERIGHTS.STAGES_ID = 2` (–≤–∏–∫–æ–Ω–∞–≤—Ü—ñ):

---

### ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–∏–π SQL-—Ñ—Ä–∞–≥–º–µ–Ω—Ç –¥–ª—è `EXECUTOR_INFO`

```sql
(
    SELECT LISTAGG(
        '<span class="task_creator">' || 
        NVL(pos.NAME, '') || ', ' || NVL(dep.NAME, '') || ', ' || NVL(u2.USERNAME, '') || '</span>' ||

        CASE 
            WHEN sr2.USER_ID IS NOT NULL THEN
                (
                    SELECT 
                        CASE 
                            WHEN h.SIGNER_BY = sr2.USER_ID THEN 
                                -- –ü—ñ–¥–ø–∏—Å–∞–≤ —Ç–æ–π —Å–∞–º–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á: —Ç—ñ–ª—å–∫–∏ —á–∞—Å
                                '<span class="signer_info">' || TO_CHAR(h.SIGNER_DATE, 'DD.MM.YYYY HH24:MI') || '</span>'
                            ELSE 
                                -- –ü—ñ–¥–ø–∏—Å–∞–≤ —ñ–Ω—à–∏–π: "–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å: USERNAME, –¥–∞—Ç–∞"
                                '<span class="signer_info">–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å: ' || us.USERNAME || ', ' || TO_CHAR(h.SIGNER_DATE, 'DD.MM.YYYY HH24:MI') || '</span>'
                        END
                    FROM SIGNATUREHISTORY h
                    JOIN USER_TABLE us ON us.ID = h.SIGNER_BY
                    WHERE h.SIGNRIGHT_ID = sr2.ID
                    FETCH FIRST ROW ONLY
                )
            ELSE
                -- USER_ID = NULL, –≤–∏–≤–æ–¥–∏–º–æ —è–∫ —Ä–∞–Ω—ñ—à–µ
                (
                    SELECT '<span class="signer_info">' || us.USERNAME || ', ' || TO_CHAR(h.SIGNER_DATE, 'DD.MM.YYYY HH24:MI') || '</span>'
                    FROM SIGNATUREHISTORY h
                    JOIN USER_TABLE us ON us.ID = h.SIGNER_BY
                    WHERE h.SIGNRIGHT_ID = sr2.ID
                    FETCH FIRST ROW ONLY
                )
        END,
    ' <br> ') 
    FROM SIGNATURERIGHTS sr2
    LEFT JOIN POSITION_TABLE pos ON pos.ID = sr2.POSITION_ID
    LEFT JOIN DEPARTMENT_TABLE dep ON dep.ID = sr2.DEPARTMENT_ID
    LEFT JOIN USER_TABLE u2 ON u2.ID = sr2.USER_ID
    WHERE sr2.TASK_ID = t.ID AND sr2.STAGES_ID = 2
) AS EXECUTOR_INFO
```

---

### üîé –ü–æ—è—Å–Ω–µ–Ω–Ω—è –ª–æ–≥—ñ–∫–∏:

| –£–º–æ–≤–∞                 | –í–∏–≤—ñ–¥                                                    |
| --------------------- | -------------------------------------------------------- |
| `USER_ID = SIGNER_BY` | –õ–∏—à–µ –¥–∞—Ç–∞ —ñ —á–∞—Å —É `<span class="signer_info">...</span>` |
| `USER_ID ‚â† SIGNER_BY` | `–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å: username, –¥–∞—Ç–∞`                             |
| `USER_ID IS NULL`     | –í–∏–≤–æ–¥–∏–º–æ `username + –¥–∞—Ç–∞`, —è–∫ —É –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –≤–µ—Ä—Å—ñ—ó       |

---

üü© –¢–µ–ø–µ—Ä –ª–æ–≥—ñ–∫–∞ –∫–æ–ª–æ–Ω–∫–∏ "–í–∏–∫–æ–Ω–∞–≤—Ü—ñ" –ø–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∫–æ–ª–æ–Ω—Ü—ñ "–•—Ç–æ –≤–∏–¥–∞–≤".

üîú –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ ‚Äî –º–æ–∂—É –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –∞–¥–∞–ø—Ç—É–≤–∞—Ç–∏ –∫–æ–ª–æ–Ω–∫—É "–§–∞–∫—Ç–∏—á–Ω–∞ –¥–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è" (stage = 3).
