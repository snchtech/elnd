–î–ª—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó **–æ–¥–Ω–æ–≥–æ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–≤—ñ—Ç—É** –∑ –ø–µ—Ä–µ–º–∏–∫–∞—á–µ–º –º—ñ–∂ –≤–∫–ª–∞–¥–∫–∞–º–∏ **(–±–µ–∑ –¥—É–±–ª—é–≤–∞–Ω–Ω—è –∑–≤—ñ—Ç—ñ–≤)** —É Oracle APEX, –¥–µ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∑–∞ –ª–æ–≥—ñ–∫–æ—é:

* **–ó–∞–ø–ª–∞–Ω–æ–≤–∞–Ω—ñ**
* **–ù–∞ –ø–æ—Ç–æ—á–Ω—É –∑–º—ñ–Ω—É**
* **–ü—Ä–æ–±–ª–µ–º–Ω—ñ**
* **–ê—Ä—Ö—ñ–≤**

üîß **–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ 4 —á–∞—Å—Ç–∏–Ω:**

---

### ‚úÖ **1. –î–æ–¥–∞—î–º–æ –µ–ª–µ–º–µ–Ω—Ç `PXX_TAB_MODE`**

**–¢–∏–ø:** `Hidden`
**–°—Ç–∞—Ä—Ç–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è:** `'PLANNED'`

–¶–µ–π item –±—É–¥–µ –≤–∏–∑–Ω–∞—á–∞—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É –≤–∫–ª–∞–¥–∫—É —ñ –∫–µ—Ä—É–≤–∞—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é.

---

### ‚úÖ **2. –ü–µ—Ä–µ–¥ `Header` –¥–æ–¥–∞—î–º–æ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π PL/SQL –ø—Ä–æ—Ü–µ—Å**

```plsql
DECLARE
  v_now         DATE := SYSDATE;
  v_hour        NUMBER := TO_NUMBER(TO_CHAR(v_now, 'HH24'));
BEGIN
  IF v_hour BETWEEN 6 AND 13 THEN
    :PXX_SHIFT_START := TRUNC(v_now) + 6/24;
    :PXX_SHIFT_END   := TRUNC(v_now) + 14/24;
  ELSIF v_hour BETWEEN 14 AND 21 THEN
    :PXX_SHIFT_START := TRUNC(v_now) + 14/24;
    :PXX_SHIFT_END   := TRUNC(v_now) + 22/24;
  ELSE
    IF v_hour >= 22 THEN
      :PXX_SHIFT_START := TRUNC(v_now) + 22/24;
      :PXX_SHIFT_END   := TRUNC(v_now + 1) + 6/24;
    ELSE -- 0 –¥–æ 5
      :PXX_SHIFT_START := TRUNC(v_now - 1) + 22/24;
      :PXX_SHIFT_END   := TRUNC(v_now) + 6/24;
    END IF;
  END IF;
END;
```

–°—Ç–≤–æ—Ä—é—î–º–æ –¥–≤–∞ item:

* `PXX_SHIFT_START`
* `PXX_SHIFT_END`

–¢–∏–ø ‚Äî `Hidden`, session state –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π.

---

### ‚úÖ **3. SQL-–∑–∞–ø–∏—Ç —É –∑–≤—ñ—Ç—ñ (–æ—Å–Ω–æ–≤–Ω–æ–º—É)**

```sql
SELECT ...
FROM TASKS t
LEFT JOIN STATUS_TABLE st ON st.ID = t.STATUS_ID
WHERE
  (:PXX_TAB_MODE = 'PLANNED')

  OR (:PXX_TAB_MODE = 'SHIFT'
      AND (
        (t.PLANNING_DATE_START < :PXX_SHIFT_END AND (t.ACTUAL_DATE_END IS NULL OR t.ACTUAL_DATE_END > :PXX_SHIFT_START)) OR
        (t.PLANNING_DATE_END BETWEEN :PXX_SHIFT_START AND :PXX_SHIFT_END)
      )
     )

  OR (:PXX_TAB_MODE = 'PROBLEM'
      AND (
        (t.PLANNING_DATE_END < SYSDATE AND t.ACTUAL_DATE_END IS NULL)
        OR EXISTS (
          SELECT 1
          FROM DICT_APP_CONFIRM_LIST d
          WHERE d.PAGE_LIST_ID = t.PAGE_LIST_ID
            AND NOT EXISTS (
              SELECT 1
              FROM SIGNATURERIGHTS r
              WHERE r.TASK_ID = t.ID AND r.STAGES_ID = d.STAGE
            )
        )
      )
     )

  OR (:PXX_TAB_MODE = 'ARCHIVE' AND t.STATUS_ID = 14)
```

> ‚ö† `ACTUAL_DATE_END` ‚Äî –∑–∞–º—ñ–Ω–∏ –Ω–∞ –ø—ñ–¥–∑–∞–ø–∏—Ç –∞–±–æ –∫–æ–ª–æ–Ω–∫—É –∑ —Ç–≤–æ–≥–æ view, –¥–µ –≤–æ–Ω–∞ —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è.

---

### ‚úÖ **4. –î–æ–¥–∞—î–º–æ –∫–Ω–æ–ø–∫–∏-–≤–∫–ª–∞–¥–∫–∏**

**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–π HTML-–µ–ª–µ–º–µ–Ω—Ç (Static Region)** –∑—ñ —Å—Ç–∏–ª—ñ–∑–æ–≤–∞–Ω–∏–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏:

```html
<div class="t-TabsRegion">
  <button type="button" class="t-Button" onclick="setTab('PLANNED')">–ó–∞–ø–ª–∞–Ω–æ–≤–∞–Ω—ñ</button>
  <button type="button" class="t-Button" onclick="setTab('SHIFT')">–ù–∞ –ø–æ—Ç–æ—á–Ω—É –∑–º—ñ–Ω—É</button>
  <button type="button" class="t-Button" onclick="setTab('PROBLEM')">–ü—Ä–æ–±–ª–µ–º–Ω—ñ</button>
  <button type="button" class="t-Button" onclick="setTab('ARCHIVE')">–ê—Ä—Ö—ñ–≤</button>
</div>
```

–Ü –¥–æ–¥–∞–π JavaScript –¥–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∏:

```js
function setTab(mode) {
  apex.item("PXX_TAB_MODE").setValue(mode);
  apex.region("report_static_id").refresh(); // –ó–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ Static ID –≤–∞—à–æ–≥–æ –∑–≤—ñ—Ç—É
}
```

---

### üîÅ **–©–æ –±—É–¥–µ –≤—ñ–¥–±—É–≤–∞—Ç–∏—Å—å**

* –ü—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ: `PXX_TAB_MODE = 'PLANNED'` ‚Üí –ø–æ–∫–∞–∑—É—é—Ç—å—Å—è –≤—Å—ñ.
* –ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –∫–Ω–æ–ø–∫–∏: –∑–º—ñ–Ω—é—î—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–Ω—è `PXX_TAB_MODE` —ñ **—Ä–µ—Ñ—Ä–µ—à–∏—Ç—å—Å—è –ª–∏—à–µ –æ–¥–∏–Ω –∑–≤—ñ—Ç**.
* SQL-–∑–∞–ø–∏—Ç –≥–Ω—É—á–∫–æ —Ä–µ–∞–≥—É—î –Ω–∞ –∑–º—ñ–Ω—É –∑–Ω–∞—á–µ–Ω–Ω—è `PXX_TAB_MODE`.

---

### üü¢ –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è

* –ó–∞–≤–¥—è–∫–∏ –æ–¥–Ω–æ–º—É SQL-–∑–∞–ø–∏—Ç—É —É–Ω–∏–∫–∞—î–º–æ –¥—É–±–ª—é–≤–∞–Ω–Ω—è –∑–≤—ñ—Ç—ñ–≤.
* –£—Å—ñ —É–º–æ–≤–∏ ‚Äî –≤ `WHERE`, —â–æ –¥–æ–±—Ä–µ –∫–µ—à—É—î—Ç—å—Å—è.
* –ü–∞—Ä–∞ shift\_start/shift\_end —Ä–∞—Ö—É—î—Ç—å—Å—è 1 —Ä–∞–∑ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ.

---

–•–æ—á–µ—à ‚Äî —è –º–æ–∂—É –æ–¥—Ä–∞–∑—É —Å–∫–ª–∞—Å—Ç–∏ –ø–æ–≤–Ω—É APEX demo-—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É –∑ —É—Å—ñ–º —Å—Ç–∏–ª–µ–º —ñ –¥—ñ—è–º–∏.
