–¢–∞–∫, **–¥–æ–¥–∞—Ç–∏ —Å—Ç–∞—Ä—Ç–æ–≤—É –¥–∞—Ç—É –¥–ª—è –ø–µ—Ä—ñ–æ–¥–∏—á–Ω–∏—Ö —à–∞–±–ª–æ–Ω—ñ–≤ ‚Äî —Ü–µ –¥—É–∂–µ —Ö–æ—Ä–æ—à–∞ —ñ –ª–æ–≥—ñ—á–Ω–∞ —ñ–¥–µ—è**, –æ—Å–∫—ñ–ª—å–∫–∏:

* –¢–µ–ø–µ—Ä —É —Ç–µ–±–µ –±—É–¥–µ **–ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å**:
  üìç –≤—ñ–¥ *—è–∫–æ—ó –¥–∞—Ç–∏* –ø–æ—á–∞—Ç–∏,
  ‚è≥ –ø–æ–≤—Ç–æ—Ä—é–≤–∞—Ç–∏ –∫–æ–∂–Ω—ñ `N` –¥–Ω—ñ–≤
  ‚è∞ –æ `HH24:MI`
  ‚èπ –¥–æ –¥–∞—Ç–∏ `PERIOD_END_TIME`.

---

## ‚úÖ –ü—Ä–æ–ø–æ–∑–∏—Ü—ñ—è: –Ω–∞–∑–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—è ‚Üí `PERIOD_START_DATE`

---

## üîß **–ó–º—ñ–Ω–∏ –≤ —Ç–∞–±–ª–∏—Ü—ñ `TASK_TEMPLATES`**

### –î–æ–¥–∞–π –Ω–æ–≤—É –∫–æ–ª–æ–Ω–∫—É:

```sql
ALTER TABLE TASK_TEMPLATES
ADD PERIOD_START_DATE DATE;
```

---

## üß† –õ–æ–≥—ñ–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è (–∫–æ–ª–∏ –º–∞—î —Å–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ —à–∞–±–ª–æ–Ω):

```text
–ù–∞—Å—Ç—É–ø–Ω–∞ –¥–∞—Ç–∞ –∑–∞–ø—É—Å–∫—É = –Ω–∞–π–±–ª–∏–∂—á–∞ –¥–∞—Ç–∞ –∑ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ:
  PERIOD_START_DATE + N * PERIODIC_INTERVAL
—â–æ >= SYSDATE
—ñ <= PERIOD_END_TIME
```

üß† –ó —Ñ–æ—Ä–º—É–ª—é–≤–∞–Ω–Ω—è–º:

> "–í–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫–æ–∂–Ω—ñ N –¥–Ω—ñ–≤ –æ HH\:MI, –ø–æ—á–∏–Ω–∞—é—á–∏ –∑ `PERIOD_START_DATE`, –¥–æ `PERIOD_END_TIME`"

---

## üîÑ –Ø–∫ —Ü–µ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≤ APEX

### 1. üìÖ –î–æ–¥–∞–π –ø–æ–ª–µ `P6_PERIOD_START_DATE` –Ω–∞ —Ñ–æ—Ä–º—É

* **Item Type**: `Date Picker`
* **Label**: "–î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É"
* **Default**: `SYSDATE`
* **Format**: –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ç–≤–æ—ó—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `DD.MM.YYYY`

---

### 2. ‚è∞ `P6_PERIODIC_TIME` ‚Äî –≤–∂–µ —î —è–∫ `type="time"`

### 3. üî¢ `P6_PERIODIC_INTERVAL` ‚Äî —ñ–Ω—Ç–µ—Ä–≤–∞–ª —É –¥–Ω—è—Ö (number)

---

## üßÆ –Ø–∫ —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ `NEXT_RUN_DATE` (–æ–Ω–æ–≤–ª–µ–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç)

### üîß –§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥—ñ–∫–∏ (PL/SQL):

```plsql
-- SYSDATE: –ø–æ—Ç–æ—á–Ω–∞ –¥–∞—Ç–∞
-- PERIOD_START_DATE: —Å—Ç–∞—Ä—Ç
-- PERIODIC_INTERVAL: —ñ–Ω—Ç–µ—Ä–≤–∞–ª
-- PERIODIC_TIME: —á–∞—Å
-- NEXT_RUN_DATE: —Ä–µ–∑—É–ª—å—Ç–∞—Ç

DECLARE
  v_start     DATE := :P6_PERIOD_START_DATE;
  v_interval  NUMBER := :P6_PERIODIC_INTERVAL;
  v_time      DATE := :P6_PERIODIC_TIME;
  v_now       DATE := SYSDATE;
  v_next      DATE;
  v_i         NUMBER := 0;
BEGIN
  LOOP
    v_next := TRUNC(v_start + v_i * v_interval) + TO_NUMBER(TO_CHAR(v_time, 'SSSSS')) / 86400;
    EXIT WHEN v_next > v_now;
    v_i := v_i + 1;
  END LOOP;

  :P6_NEXT_RUN_DATE := v_next; -- –∞–±–æ –∑–±–µ—Ä–µ–∂–∏ –≤ —Ç–∞–±–ª–∏—Ü—é
END;
```

üîÅ –ú–æ–∂–Ω–∞ –≤–∏–Ω–µ—Å—Ç–∏ –≤ —Ñ—É–Ω–∫—Ü—ñ—é `GET_NEXT_RUN_DATE(...)` (—è–∫ –º–∏ –≤–∂–µ —Ä–æ–±–∏–ª–∏ —Ä–∞–Ω—ñ—à–µ), –ø—Ä–æ—Å—Ç–æ –¥–æ–¥–∞—Ç–∏ `PERIOD_START_DATE` —è–∫ –Ω–æ–≤–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä.

---

## üñº –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —É –∑–≤—ñ—Ç–∞—Ö:

```sql
TO_CHAR(NEXT_RUN_DATE, 'DD.MM.YYYY HH24:MI') AS NEXT_RUN_DATE
```

---

## ‚úÖ –†–µ–∑—é–º–µ ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ–≥–æ —à–∞–±–ª–æ–Ω—É:

| –ü–æ–ª–µ                  | –¢–∏–ø    | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è                             |
| --------------------- | ------ | --------------------------------------- |
| `PERIODIC_INTERVAL`   | NUMBER | —ñ–Ω—Ç–µ—Ä–≤–∞–ª —É –¥–Ω—è—Ö                         |
| `PERIODIC_TIME`       | DATE   | —á–∞—Å –∑–∞–ø—É—Å–∫—É —É –º–µ–∂–∞—Ö –¥–æ–±–∏                |
| ‚úÖ `PERIOD_START_DATE` | DATE   | –∑ —è–∫–æ–≥–æ –¥–Ω—è –ø–æ—á–∞—Ç–∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è           |
| `PERIOD_END_TIME`     | DATE   | –¥–æ —è–∫–æ—ó –¥–∞—Ç–∏ –∑–∞–ø—É—Å–∫–∞—Ç–∏ —à–∞–±–ª–æ–Ω           |
| `NEXT_RUN_DATE`       | DATE   | —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è: –Ω–∞–π–±–ª–∏–∂—á–∞ –º–∞–π–±—É—Ç–Ω—è –¥–∞—Ç–∞ |

---

üîî –•–æ—á–µ—à ‚Äî –º–æ–∂—É –∞–¥–∞–ø—Ç—É–≤–∞—Ç–∏ —Ç–≤–æ—é `GET_NEXT_RUN_DATE()` –ø—ñ–¥ –Ω–æ–≤—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É.
