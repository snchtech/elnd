–î—É–∂–µ —Ö–æ—Ä–æ—à–∏–π –ø–ª–∞–Ω ‚Äî –∑—Ä–æ–±–∏–º–æ —Ü–µ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ:

---

## ‚úÖ 1. **–ü–æ–ª–µ "–¢–µ—Ä–º—ñ–Ω –≤–∏–∫–æ–Ω–∞–Ω–Ω—è (–¥–Ω—ñ–≤)"** –¥–ª—è –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è (–≤ —à–∞–±–ª–æ–Ω—ñ)

### –í APEX:

* **Item Name**: `P7_SUBTASK_TERM_DAYS`
* **–¢–∏–ø**: `Number Field`
* **Default Value**: `1`
* **–û–±–æ–≤‚Äô—è–∑–∫–æ–≤—ñ—Å—Ç—å**: ‚ùå (–Ω–µ –æ–±–æ–≤'—è–∑–∫–æ–≤–µ)
* **Visible When**: `P7_TASK_MODE = 1`

üìç –î–ª—è —Ü—å–æ–≥–æ:

* –í—Å—Ç–∞–Ω–æ–≤–∏ `Server-side Condition` ‚Üí PL/SQL Expression:

  ```plsql
  :P7_TASK_MODE = 1
  ```
* –ê–±–æ `Dynamic Action` ‚Üí Show/Hide –ø—Ä–∏ –∑–º—ñ–Ω—ñ `P7_TASK_MODE`

---

## ‚úÖ 2. **–ó–º—ñ–Ω–∏ —É —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ –∫–æ–ª–µ–∫—Ü—ñ—ó `TASK_TEMPLATE_SUBTASKS_COLLECTION`**

–î–æ–¥–∞–π –Ω–æ–≤–µ –ø–æ–ª–µ –≤ –∫–æ–ª–µ–∫—Ü—ñ—é:

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø    | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è                     |
| ------- | ------ | ------------------------------- |
| `N002`  | NUMBER | `TERM_DAYS` ‚Äî —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —É –¥–Ω—è—Ö |

> `N002` ‚Äî –ø—ñ–¥—Ö–æ–¥—è—â–µ –ø–æ–ª–µ (—á–∏—Å–ª–æ–≤–µ). –Ø–∫—â–æ –≤–∂–µ –∑–∞–π–Ω—è—Ç–µ ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π `N003`.

---

### üîß –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ –∫–æ–ª–µ–∫—Ü—ñ—é

–ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ **–ó–±–µ—Ä–µ–≥—Ç–∏ –ø—ñ–¥—à–∞–±–ª–æ–Ω**, –¥–æ–¥–∞–π –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è:

```plsql
APEX_COLLECTION.ADD_MEMBER(
  p_collection_name => 'TASK_TEMPLATE_SUBTASKS_COLLECTION',
  ...
  p_n002 => :P7_SUBTASK_TERM_DAYS,
  ...
);
```

---

## ‚úÖ 3. **–ó–º—ñ–Ω–∏ —É —Ç–∞–±–ª–∏—Ü—ñ `TASK_TEMPLATE_SUBTASK`**

### –î–æ–¥–∞–π –∫–æ–ª–æ–Ω–∫—É –≤ –ë–î:

```sql
ALTER TABLE TASK_TEMPLATE_SUBTASK
ADD TERM_DAYS NUMBER;
```

> –ó–Ω–∞—á–µ–Ω–Ω—è –ø–æ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—é: `NULL` –∞–±–æ `1` ‚Äî –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ç–≤–æ—î—ó –ª–æ–≥—ñ–∫–∏

---

## ‚úÖ 4. **–ü—Ä–∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—ñ –ø—ñ–¥—à–∞–±–ª–æ–Ω—ñ–≤ —É job ‚Üí —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å**

–ö–æ–ª–∏ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–æ–≤–µ **`TASK_SUBTASK`** –∑ `TASK_TEMPLATE_SUBTASK`, —Ç–æ:

```plsql
PLANNING_DATE_END := PLANNING_DATE_START + NVL(TEMPLATE.TERM_DAYS, 1);
```

---

## üìã –ü—Ä–∏–∫–ª–∞–¥ –≤—Å—Ç–∞–≤–∫–∏ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è –≤ job:

```plsql
INSERT INTO TASK_SUBTASKS (
  TASK_ID,
  SUBTASK_CONTENT,
  PLANNING_DATE_START,
  PLANNING_DATE_END,
  ...
)
SELECT
  :NEW_TASK_ID,
  tts.SUBTASK_CONTENT,
  v_task_start_date,
  v_task_start_date + NVL(tts.TERM_DAYS, 1),
  ...
FROM TASK_TEMPLATE_SUBTASK tts
WHERE tts.TEMPLATE_ID = :TEMPLATE_ID;
```

---

## ‚úÖ –ü—ñ–¥—Å—É–º–æ–∫:

| –†—ñ–≤–µ–Ω—å       | –ï–ª–µ–º–µ–Ω—Ç                                  | –î—ñ—è                                      |
| ------------ | ---------------------------------------- | ---------------------------------------- |
| APEX UI      | `P7_SUBTASK_TERM_DAYS`                   | –ø–æ–ª–µ –∑ –¥–µ—Ñ–æ–ª—Ç–Ω–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º `1`           |
| –ö–æ–ª–µ–∫—Ü—ñ—è     | `N002`                                   | –∑–±–µ—Ä—ñ–≥–∞—î `TERM_DAYS`                     |
| –ë–î           | `TERM_DAYS` —É `TEMPLATE_SUBTASK`         | —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —É –¥–Ω—è—Ö                        |
| JOB / PL/SQL | `PLANNING_DATE_END := START + TERM_DAYS` | —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –ø—ñ–¥ —á–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è |

---

üîî –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—à **Interactive Grid –¥–ª—è –ø—ñ–¥—à–∞–±–ª–æ–Ω—ñ–≤** ‚Äî —Å–∫–∞–∂–∏, —ñ —è –ø–æ–∫–∞–∂—É, —è–∫ –æ–±—Ä–æ–±–∏—Ç–∏ `TERM_DAYS` —á–µ—Ä–µ–∑ IG + –∫–æ–ª–µ–∫—Ü—ñ—é.
