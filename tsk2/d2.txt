–î–ª—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó **–æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è —è–∫ –∑ –æ–∫—Ä–µ–º–∏–º –∑–∞–≤–¥–∞–Ω–Ω—è–º, —Ç–∞–∫ —ñ –∑ —É—Å—ñ–º–∞ –∑–∞–≤–¥–∞–Ω–Ω—è–º–∏ –≤ –∑–≤—ñ—Ç—ñ (report)** –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑–∏ –¥–∞–Ω–∏—Ö. –ü–æ—Ç–æ—á–Ω–∞ —Å—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü—ñ `TASK_ACKNOWLEDGEMENT` –ø–æ–≤–Ω—ñ—Å—Ç—é –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è —Ü—å–æ–≥–æ.

---

## **–Ø–∫ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è?**

1. **–û–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è –∑ –æ–∫—Ä–µ–º–∏–º –∑–∞–≤–¥–∞–Ω–Ω—è–º**  
   - –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `task_id` –¥–ª—è —Ñ—ñ–∫—Å–∞—Ü—ñ—ó –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è.
   - –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–∫–∞—î "–û–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—è" –±—ñ–ª—è –æ–¥–Ω–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è.

2. **–û–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è –∑ —É—Å—ñ–º–∞ –∑–∞–≤–¥–∞–Ω–Ω—è–º–∏ –≤ –∑–≤—ñ—Ç—ñ (report)**  
   - –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `INSERT ALL` (–∞–±–æ `LOOP` —É PL/SQL), —â–æ–± –∑–±–µ—Ä–µ–≥—Ç–∏ –æ–¥—Ä–∞–∑—É –∫—ñ–ª—å–∫–∞ –∑–∞–ø–∏—Å—ñ–≤ –ø—Ä–æ –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö –∑–∞–≤–¥–∞–Ω—å —É –∑–≤—ñ—Ç—ñ.
   - –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–∫–∞—î "–û–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—è –∑ —É—Å—ñ–º–∞", —ñ –∑–∞–ø–∏—Å—É—î—Ç—å—Å—è –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è –æ–¥—Ä–∞–∑—É –¥–ª—è –≤—Å—ñ—Ö –∑–∞–≤–¥–∞–Ω—å, —è–∫—ñ –π–æ–º—É –ø–æ–∫–∞–∑–∞–Ω—ñ.

---

### **1. –û–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è –∑ –æ–∫—Ä–µ–º–∏–º –∑–∞–≤–¥–∞–Ω–Ω—è–º**
```sql
INSERT INTO TASK_ACKNOWLEDGEMENT (user_id, task_id, shift_date, shift_number)
VALUES (:current_user_id, :task_id, TRUNC(SYSDATE), GET_CURRENT_SHIFT());
```
‚úÖ **–ó–∞–ø–∏—Å—É—î –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è**.

---

### **2. –û–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è –∑ —É—Å—ñ–º–∞ –∑–∞–≤–¥–∞–Ω–Ω—è–º–∏ –≤ –∑–≤—ñ—Ç—ñ (report)**  
–Ø–∫—â–æ —Å–ø–∏—Å–æ–∫ –∑–∞–≤–¥–∞–Ω—å –≤ `REPORT_TASKS` —Ñ–æ—Ä–º—É—î—Ç—å—Å—è –∑–∞–ø–∏—Ç–æ–º, —Ç–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ `INSERT ALL`, —â–æ–± –∑–∞–ø–∏—Å–∞—Ç–∏ –≤—Å—ñ –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è –æ–¥–Ω–æ—á–∞—Å–Ω–æ.

```sql
INSERT ALL
    INTO TASK_ACKNOWLEDGEMENT (user_id, task_id, shift_date, shift_number)
    VALUES (:current_user_id, task_id, TRUNC(SYSDATE), GET_CURRENT_SHIFT())
SELECT t.id AS task_id
FROM TASKS t
LEFT JOIN TASK_ACKNOWLEDGEMENT ta 
    ON t.id = ta.task_id 
    AND ta.user_id = :current_user_id
    AND ta.shift_date = TRUNC(SYSDATE)
    AND ta.shift_number = GET_CURRENT_SHIFT()
WHERE (t.creator_id = :current_user_id OR t.department_id = :current_department_id)
    AND t.status_id != 4  -- –ó–∞–≤–¥–∞–Ω–Ω—è —â–µ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–µ
    AND ta.id IS NULL;  -- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —â–µ –Ω–µ –æ–∑–Ω–∞–π–æ–º–∏–≤—Å—è
```
‚úÖ **–ó–∞–ø–∏—Å—É—î –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è –æ–¥—Ä–∞–∑—É –¥–ª—è –≤—Å—ñ—Ö –∑–∞–≤–¥–∞–Ω—å, —è–∫—ñ —â–µ –Ω–µ –ø–µ—Ä–µ–≥–ª—è–¥–∞–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á**.

---

### **3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è PL/SQL –¥–ª—è –º–∞—Å–æ–≤–æ–≥–æ –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è**
–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ü–µ —É –≤–∏–≥–ª—è–¥—ñ **–∑–±–µ—Ä–µ–∂–µ–Ω–æ—ó –ø—Ä–æ—Ü–µ–¥—É—Ä–∏**, –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ —Ç–∞–∫:

```sql
CREATE OR REPLACE PROCEDURE MARK_ALL_TASKS_AS_ACKNOWLEDGED (
    p_user_id NUMBER
) AS
BEGIN
    INSERT INTO TASK_ACKNOWLEDGEMENT (user_id, task_id, shift_date, shift_number)
    SELECT p_user_id, t.id, TRUNC(SYSDATE), GET_CURRENT_SHIFT()
    FROM TASKS t
    LEFT JOIN TASK_ACKNOWLEDGEMENT ta 
        ON t.id = ta.task_id 
        AND ta.user_id = p_user_id
        AND ta.shift_date = TRUNC(SYSDATE)
        AND ta.shift_number = GET_CURRENT_SHIFT()
    WHERE (t.creator_id = p_user_id OR t.department_id IN 
          (SELECT department_id FROM USERS WHERE id = p_user_id))
        AND t.status_id != 4
        AND ta.id IS NULL;

    COMMIT;
END;
/
```
‚úÖ **–¶—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É –º–æ–∂–Ω–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –∫–Ω–æ–ø–∫–æ—é "–û–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—å –∑ —É—Å—ñ–º–∞"**:
```sql
BEGIN
    MARK_ALL_TASKS_AS_ACKNOWLEDGED(:current_user_id);
END;
/
```
‚úÖ **–§—ñ–∫—Å—É—î –æ–¥—Ä–∞–∑—É –≤—Å—ñ –∑–∞–≤–¥–∞–Ω–Ω—è, —è–∫—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —â–µ –Ω–µ –ø–µ—Ä–µ–≥–ª—è–Ω—É–≤ —É –ø–æ—Ç–æ—á–Ω—É –∑–º—ñ–Ω—É**.

---

## **–í–∏—Å–Ω–æ–≤–æ–∫**
üîπ **–°—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ** ‚Äì —Ç–∞–±–ª–∏—Ü—è `TASK_ACKNOWLEDGEMENT` –≤–∂–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å.  
üîπ **–û–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è –∑ –æ–¥–Ω–∏–º –∑–∞–≤–¥–∞–Ω–Ω—è–º** ‚Äì –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤–ª—è—î–º–æ –æ–¥–∏–Ω –∑–∞–ø–∏—Å.  
üîπ **–û–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è –∑ —É—Å—ñ–º–∞ –∑–∞–≤–¥–∞–Ω–Ω—è–º–∏** ‚Äì –º–æ–∂–Ω–∞ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ `INSERT ALL` –∞–±–æ –∑–±–µ—Ä–µ–∂–µ–Ω—É –ø—Ä–æ—Ü–µ–¥—É—Ä—É.  
üîπ **–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ `MARK_ALL_TASKS_AS_ACKNOWLEDGED`** ‚Äì –¥–æ–∑–≤–æ–ª—è—î —à–≤–∏–¥–∫–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –≤—Å—ñ –∑–∞–ø–∏—Å–∏ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.  

–¶–µ –¥–∞—Å—Ç—å –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑—Ä—É—á–Ω–æ –∫–µ—Ä—É–≤–∞—Ç–∏ –ø—Ä–æ—Ü–µ—Å–æ–º –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è –∑ –∑–∞–≤–¥–∞–Ω–Ω—è–º–∏ –≤ –∑–º—ñ–Ω—É. üöÄ