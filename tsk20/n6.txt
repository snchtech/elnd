–¢–∞–∫, –¥–∞–≤–∞–π –ø–æ —á–µ—Ä–∑—ñ —Ä–æ–∑–±–µ—Ä–µ–º–æ –æ–±–∏–¥–≤–∞ –ø–∏—Ç–∞–Ω–Ω—è:

---

### ‚úÖ **1. –ß–∏ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `VARCHAR2` –∑–∞–º—ñ—Å—Ç—å `CLOB` —É `TASK_CHANGE_LOG` –¥–ª—è `OLD_VALUE` / `NEW_VALUE`?**

**–¢–∞–∫**, —è–∫—â–æ:

* —Ç–∏ **–≤–ø–µ–≤–Ω–µ–Ω–∏–π**, —â–æ –∑–Ω–∞—á–µ–Ω–Ω—è **–Ω–µ –ø–µ—Ä–µ–≤–∏—â–∞—Ç—å 4000 –±–∞–π—Ç—ñ–≤** (–∞–±–æ 32767 —É PL/SQL, —è–∫—â–æ `VARCHAR2(‚Ä¶)` –æ–≥–æ–ª–æ—à–µ–Ω–æ –≤ –∑–º—ñ–Ω–Ω—ñ–π).
* —Ç–∏ —Ö–æ—á–µ—à —É–Ω–∏–∫–Ω—É—Ç–∏ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ —Ä–æ–±–æ—Ç–∏ –∑ `CLOB`.

–î–ª—è **DATE**-—Ç–∏–ø—ñ–≤ (`PLANNING_DATE_END`, `NEXT_RUN_DATE` —Ç–æ—â–æ) ‚Äî **–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –∫—Ä–∞—â–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ `TO_CHAR(‚Ä¶, —Ñ–æ—Ä–º–∞—Ç)`** —É `VARCHAR2`.

**–ü—Ä–∏–∫–ª–∞–¥:**

```plsql
TO_CHAR(:OLD.PLANNING_DATE_END, 'YYYY-MM-DD HH24:MI:SS')
```

–¢–æ–¥—ñ –≤ `OLD_VALUE`, `NEW_VALUE` —Ç–∏ –≤—Å—Ç–∞–≤–ª—è—î—à `VARCHAR2`, –∞ –Ω–µ `DATE`.

> üí° **–ü–æ—Ä–∞–¥–∞:** –Ø–∫—â–æ —Ç–∏ —Ö–æ—á–µ—à –≥–Ω—É—á–∫—ñ—Å—Ç—å, –º–æ–∂–µ—à –Ω–∞ –º–∞–π–±—É—Ç–Ω—î –∑–∞–ª–∏—à–∏—Ç–∏ `CLOB`, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –∑–∞—Ä–∞–∑ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏–º–µ—à –∫–æ—Ä–æ—Ç–∫—ñ —Ä—è–¥–∫–∏ ‚Äî —Ü–µ –±–µ–∑–ø–µ—á–Ω—ñ—à–µ, —è–∫—â–æ –≤ –º–∞–π–±—É—Ç–Ω—å–æ–º—É –∑‚Äô—è–≤–ª—è—Ç—å—Å—è –≤–µ–ª–∏–∫—ñ –ø–æ–ª—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –æ–ø–∏—Å –∞–±–æ JSON-–ø–æ–ª—è).

---

### ‚úÖ **2. –ó–≤—ñ–¥–∫–∏ `v_user := NVL(sys_context('APEX$SESSION','APP_USER'), USER)` –æ—Ç—Ä–∏–º—É—î –¥–∞–Ω—ñ?**

`sys_context('APEX$SESSION', 'APP_USER')` ‚Äî —Ü–µ –≤–±—É–¥–æ–≤–∞–Ω–∞ **Oracle APEX-—Å–µ—Å—ñ–π–Ω–∞ –∑–º—ñ–Ω–Ω–∞**, —è–∫–∞:

* –ø–æ–≤–µ—Ä—Ç–∞—î —ñ–º‚Äô—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π —É–≤—ñ–π—à–æ–≤ —É APEX-–¥–æ–¥–∞—Ç–æ–∫;
* –ø—Ä–∞—Ü—é—î —Ç—ñ–ª—å–∫–∏ **–ø—ñ–¥ —á–∞—Å —Å–µ—Å—ñ—ó APEX** (—á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä –∞–±–æ `APEX_EXEC` API).

**–£ –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ —Ç—Ä–∏–≥–µ—Ä –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –∑:**

* APEX ‚Äî –±—É–¥–µ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–æ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ —ñ–º‚Äô—è;
* SQL Developer / —ñ–Ω—à–∏–π –∫–ª—ñ—î–Ω—Ç ‚Äî –ø–æ–≤–µ—Ä–Ω–µ `NULL`, —ñ —Ç–æ–¥—ñ –≤–∏–∫–æ–Ω–∞—î—Ç—å—Å—è `USER`.

> –¢–∞–∫–∏–º —á–∏–Ω–æ–º, —Ü–µ —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è:

```plsql
v_user := NVL(sys_context('APEX$SESSION', 'APP_USER'), USER);
```

‚Äì —è–∫–∞ –ø—Ä–∞—Ü—é—î **—ñ –≤ APEX**, —ñ –≤ **SQL Developer**.

---

### üîé –Ø–∫—â–æ —Ö–æ—á–µ—à –±—É—Ç–∏ —â–µ —Ç–æ—á–Ω—ñ—à–∏–º:

–ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏:

```plsql
coalesce(apex_application.g_user, sys_context('APEX$SESSION', 'APP_USER'), user)
```

> –ê–ª–µ —Ü–µ –¥–æ—Ä–µ—á–Ω–æ **–≤ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞—Ö APEX**, –∞ –Ω–µ –≤ —Ç—Ä–∏–≥–µ—Ä–∞—Ö. –£ —Ç—Ä–∏–≥–µ—Ä–∞—Ö –∫—Ä–∞—â–µ –∑–∞–ª–∏—à–∞—Ç–∏ `sys_context + USER`.

---

### üîö –í–∏—Å–Ω–æ–≤–æ–∫

| –ó–∞–ø–∏—Ç–∞–Ω–Ω—è                                      | –í—ñ–¥–ø–æ–≤—ñ–¥—å                                                           |
| ---------------------------------------------- | ------------------------------------------------------------------- |
| –ß–∏ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `VARCHAR2` –¥–ª—è –ª–æ–≥—ñ–≤? | –¢–∞–∫, –æ—Å–æ–±–ª–∏–≤–æ –¥–ª—è `DATE`, `NUMBER`, `VARCHAR2`                      |
| –Ø–∫ –æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è `v_user`?                       | –ß–µ—Ä–µ–∑ `sys_context('APEX$SESSION', 'APP_USER')`, —ñ–∑ –∑–∞–ø–∞—Å–Ω–∏–º `USER` |

–ì–æ—Ç–æ–≤–∏–π –¥–æ–ø–æ–º–æ–≥—Ç–∏ –∑ –ø—Ä–∏–∫–ª–∞–¥–æ–º —Ç—Ä–∏–≥–µ—Ä–∞ –Ω–∞ `VARCHAR2` + `TO_CHAR`, —è–∫—â–æ —Ç—Ä–µ–±–∞.
