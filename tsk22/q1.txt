–¢–∞–∫, —Ü–µ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —ñ –≥–Ω—É—á–∫–∏–π –ø—ñ–¥—Ö—ñ–¥: **—Å—Ç–≤–æ—Ä–∏—Ç–∏ hidden item**, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `P5_IS_CANCELED`, —ñ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –π–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–∏ **–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏**, —â–æ–± –ø–æ—Ç—ñ–º –¥–∏–Ω–∞–º—ñ—á–Ω–æ —Ö–æ–≤–∞—Ç–∏ –∞–±–æ –Ω–µ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∫–Ω–æ–ø–∫—É **"–°–∫–∞—Å—É–≤–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è"**.

–û—Å—å –ø–æ–∫—Ä–æ–∫–æ–≤–æ, —è–∫ —Ü–µ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ üëá

---

## ‚úÖ 1. –î–æ–¥–∞–π `Hidden Item`

–ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ 5 —Å—Ç–≤–æ—Ä–∏ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç:

* **Name**: `P5_IS_CANCELED`
* **Type**: Hidden
* **Value Protected**: No
* **Session State**: Maintain

---

## ‚úÖ 2. Before Header PL/SQL Process

–°—Ç–≤–æ—Ä–∏ –ø—Ä–æ—Ü–µ—Å `Before Header`, —è–∫–∏–π –≤–∏–∑–Ω–∞—á–∞—î, —á–∏ –∑–∞–≤–¥–∞–Ω–Ω—è –∞–Ω—É–ª—å–æ–≤–∞–Ω–æ:

```plsql
DECLARE
  v_canceled_task_id NUMBER;
BEGIN
  -- –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Å—Ç–∞—Ç—É—Å —ñ–∑ TASKS
  SELECT 1 INTO v_canceled_task_id
  FROM TASKS t
  WHERE t.ID = :P5_TASK_ID AND t.STATUS_ID = 14;

  -- –Ø–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ ‚Äì –∑–∞–≤–¥–∞–Ω–Ω—è —Å–∫–∞—Å–æ–≤–∞–Ω–æ
  :P5_IS_CANCELED := 1;

EXCEPTION
  WHEN NO_DATA_FOUND THEN
    -- –Ø–∫—â–æ –≤ TASKS –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ, –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ SignatureHistory
    SELECT 1 INTO v_canceled_task_id
    FROM SIGNATUREHISTORY h
    JOIN SIGNATURERIGHTS r ON r.ID = h.RIGHT_ID
    WHERE r.TASK_ID = :P5_TASK_ID AND r.STAGES_ID = 6 AND h.STATUS_ID = 14;

    :P5_IS_CANCELED := 1;

  WHEN OTHERS THEN
    :P5_IS_CANCELED := 0;
END;
```

---

## ‚úÖ 3. –í–∏–≤—ñ–¥ –∫–Ω–æ–ø–∫–∏ –≤ PL/SQL Dynamic Content

–£ —Ç–≤–æ—î–º—É —Ä–µ–≥—ñ–æ–Ω—ñ, –¥–µ –≤–∏–≤–æ–¥–∏—Ç—å—Å—è –∫–Ω–æ–ø–∫–∞ **"–°–∫–∞—Å—É–≤–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è"**, –æ–±–≥–æ—Ä–Ω–∏ —ó—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é:

```plsql
BEGIN
  IF :P5_IS_CANCELED != 1 THEN
    HTP.P('
      <button class="t-Button t-Button--danger" onclick="confirmCancel()">–°–∫–∞—Å—É–≤–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è</button>
    ');
  END IF;
END;
```

---

## ‚úÖ 4. –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –ø—ñ—Å–ª—è —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è

–ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –ø—Ä–æ—Ü–µ—Å –∞–Ω—É–ª—é–≤–∞–Ω–Ω—è –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è, –¥–æ–¥–∞–π —É –π–æ–≥–æ `success` callback:

```javascript
// –ü—ñ—Å–ª—è –∞–Ω—É–ª—é–≤–∞–Ω–Ω—è
apex.item('P5_IS_CANCELED').setValue(1);
apex.region('my-task-region').refresh(); // —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
```

> –Ø–∫—â–æ `P5_IS_CANCELED` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –≤ —Ä–µ–≥—ñ–æ–Ω—ñ PL/SQL Dynamic Content ‚Äî –∫—Ä–∞—â–µ –ø—Ä–æ—Å—Ç–æ **–ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—Å—é —Å—Ç–æ—Ä—ñ–Ω–∫—É** –∞–±–æ –∑—Ä–æ–±–∏—Ç–∏ `apex.navigation.redirect(apex.util.makeApplicationUrl({ pageId: 5, clearCache: '5' }))`.

---

## ‚úÖ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ –ø–æ–≤–Ω—ñ—Å—Ç—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

–ú–æ–∂–Ω–∞ **–Ω–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ `P5_IS_CANCELED` –≤–∑–∞–≥–∞–ª—ñ**, –∞ –ø—Ä–æ—Å—Ç–æ –≤—Å—é –ª–æ–≥—ñ–∫—É –≤–∏–≤–æ–¥—É –∫–Ω–æ–ø–∫–∏ –ø–∏—Å–∞—Ç–∏ –≤ `PL/SQL Dynamic Content`, —è–∫ —É–∂–µ –∑—Ä–æ–±–ª–µ–Ω–æ –≤–∏—â–µ ‚Äî —Ü—å–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ, —è–∫—â–æ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ —Å—Ç–∞–Ω –±–µ–∑ reload.

---

üîÅ –Ø–∫—â–æ —Ö–æ—á–µ—à ‚Äî –º–æ–∂—É —â–µ –¥–æ–¥–∞—Ç–∏ JS –¥–ª—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è –∫–Ω–æ–ø–∫–∏ –±–µ–∑ reload –ø—ñ—Å–ª—è —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è.
