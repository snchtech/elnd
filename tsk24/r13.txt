üí° **–ß—É–¥–æ–≤–µ –∑–∞–≤–¥–∞–Ω–Ω—è! –Ø –¥–æ–ø–æ–º–æ–∂—É —Ä–æ–∑–∫–ª–∞—Å—Ç–∏ –π–æ–≥–æ –ø–æ –∫—Ä–æ–∫–∞—Ö —ñ –¥–∞–º –≥–æ—Ç–æ–≤—ñ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏ –¥–ª—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó. –ú–∏ –ø–æ—î–¥–Ω–∞—î–º–æ –¥–∏–Ω–∞–º—ñ–∫—É (JS + DA) —ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è APEX.**

---

## üöÄ **1Ô∏è‚É£ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è P4\_SUBTASK\_EXECUTOR**

### ‚û° –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ item:

* **Type:** Popup LOV
* **Default Value:** NULL
* **Visible:** No (–ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π –Ω–∞ —Å—Ç–∞—Ä—Ç—ñ)
* **CSS Classes:** `subtask-executor-hidden` (–∞–±–æ –Ω—ñ—á–æ–≥–æ, –∑–∞ –±–∞–∂–∞–Ω–Ω—è–º)

---

## üöÄ **2Ô∏è‚É£ LOV –¥–ª—è P4\_SUBTASK\_EXECUTOR**

### ‚û° SQL Query LOV:

```sql
SELECT
  CASE
    WHEN :P4_TASK_MODE = 0 THEN
      (SELECT subtask_content || ' (' || id || ')' FROM TASK_SUBTASKS WHERE TASK_ID = :P4_TASK_ID)
    WHEN :P4_TASK_MODE = 1 THEN
      (SELECT subtask_content || ' (' || id || ')' FROM TASK_SUBTASK_TEMPLATES WHERE TEMPLATE_ID = :P4_TASK_ID)
  END AS display_value,
  CASE
    WHEN :P4_TASK_MODE = 0 THEN
      (SELECT id FROM TASK_SUBTASKS WHERE TASK_ID = :P4_TASK_ID)
    WHEN :P4_TASK_MODE = 1 THEN
      (SELECT id FROM TASK_SUBTASK_TEMPLATES WHERE TEMPLATE_ID = :P4_TASK_ID)
  END AS return_value
FROM dual
```

‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –∫—Ä–∞—â–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç ‚Äî —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥–≤–∞ LOV (–æ–¥–∏–Ω –Ω–∞ TASK\_SUBTASKS, –¥—Ä—É–≥–∏–π –Ω–∞ TASK\_SUBTASK\_TEMPLATES) —ñ –ø–µ—Ä–µ–º–∏–∫–∞—Ç–∏ —ó—Ö —á–µ—Ä–µ–∑ DA –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤–∏–≤—ñ–¥ –∑ UNION:

```sql
SELECT subtask_content || ' (' || id || ')', id
FROM TASK_SUBTASKS
WHERE TASK_ID = :P4_TASK_ID
AND :P4_TASK_MODE = 0
UNION ALL
SELECT subtask_content || ' (' || id || ')', id
FROM TASK_SUBTASK_TEMPLATES
WHERE TEMPLATE_ID = :P4_TASK_ID
AND :P4_TASK_MODE = 1
```

---

## üöÄ **3Ô∏è‚É£ JS/Dynamic Action –¥–ª—è –ø–æ–∫–∞–∑—É P4\_SUBTASK\_EXECUTOR**

### ‚û° –°—Ç–≤–æ—Ä—é—î–º–æ **Dynamic Action**

* **Event:** Click
* **Selection Type:** jQuery Selector
* **jQuery Selector:** `.add-confirm-person`

---

### ‚û° –î—ñ—ó –≤ DA:

#### üîπ True Action: Execute JavaScript Code

```javascript
var stage = $(this.triggeringElement).data('current-stage');

if (stage == 4) {
  $('#P4_SUBTASK_EXECUTOR_CONTAINER').show(); // –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä item
  // –∞–±–æ, —è–∫—â–æ –±–µ–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
  $('#P4_SUBTASK_EXECUTOR').closest('.t-Form-fieldContainer').show();
} else {
  $('#P4_SUBTASK_EXECUTOR_CONTAINER').hide();
}
```

‚úÖ **–ü—Ä–∏–º—ñ—Ç–∫–∞:** —É APEX –º–æ–∂–Ω–∞ –∑–∞–¥–∞—Ç–∏ Static ID –¥–ª—è wrapper –µ–ª–µ–º–µ–Ω—Ç–∞ –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `.t-Form-fieldContainer`.

#### üîπ –î–æ–¥–∞—Ç–∫–æ–≤–æ –º–æ–∂–Ω–∞ –æ–Ω–æ–≤–∏—Ç–∏ LOV (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –∞–∫—Ç—É–∞–ª—ñ–∑–∞—Ü—ñ—è)

```javascript
apex.item('P4_SUBTASK_EXECUTOR').refresh();
```

---

## üöÄ **4Ô∏è‚É£ –ù–∞ —Å—Ç–∞—Ä—Ç—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –ø—Ä–∏—Ö–æ–≤–∞—Ç–∏**

‚úÖ –°—Ç–≤–æ—Ä—ñ—Ç—å DA –Ω–∞ **Page Load**:

```javascript
$('#P4_SUBTASK_EXECUTOR').closest('.t-Form-fieldContainer').hide();
```

–∞–±–æ:

```javascript
$('#P4_SUBTASK_EXECUTOR_CONTAINER').hide();
```

---

## ‚ö° **–°—Ö–µ–º–∞ —Ä–æ–±–æ—Ç–∏**

1Ô∏è‚É£ –ö–Ω–æ–ø–∫–∞ –¥–æ–¥–∞—î—Ç—å—Å—è:

```html
<button data-current-stage="4" ... class="add-confirm-person"></button>
```

2Ô∏è‚É£ –ö–ª—ñ–∫ –ø–æ –∫–Ω–æ–ø—Ü—ñ ‚Üí DA –ø–µ—Ä–µ–≤—ñ—Ä—è—î stage —ñ –ø–æ–∫–∞–∑—É—î LOV.
3Ô∏è‚É£ LOV –±—É–¥—É—î—Ç—å—Å—è –ø–æ UNION (–∞–±–æ –æ–∫—Ä–µ–º–∏—Ö LOV).
4Ô∏è‚É£ –ü—ñ—Å–ª—è –≤–∏–±–æ—Ä—É –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è ID –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è/—à–∞–±–ª–æ–Ω—É.

---

## ‚úÖ **–ü—Ä–∏–∫–ª–∞–¥ SQL –¥–ª—è LOV (–≥–æ—Ç–æ–≤–∏–π –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏)**

```sql
SELECT subtask_content || ' (' || id || ')' AS display_value, id AS return_value
FROM TASK_SUBTASKS
WHERE TASK_ID = :P4_TASK_ID
AND :P4_TASK_MODE = 0
UNION ALL
SELECT subtask_content || ' (' || id || ')', id
FROM TASK_SUBTASK_TEMPLATES
WHERE TEMPLATE_ID = :P4_TASK_ID
AND :P4_TASK_MODE = 1
```

---

## üí¨ **–•–æ—á–µ—Ç–µ –≥–æ—Ç–æ–≤–∏–π JSON –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É DA —á–∏ –∫–æ–¥ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ DA?**

–ù–∞–ø–∏—à—ñ—Ç—å ‚Äî —è –ø—ñ–¥–≥–æ—Ç—É—é –ø–æ–≤–Ω—ñ—Å—Ç—é –≥–æ—Ç–æ–≤–µ —Ä—ñ—à–µ–Ω–Ω—è! üöÄ
