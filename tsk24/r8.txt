üí° **–ß—É–¥–æ–≤–æ, –∑–∞–≤–¥–∞–Ω–Ω—è –ø–æ–≤–Ω—ñ—Å—Ç—é –∑—Ä–æ–∑—É–º—ñ–ª–µ!**
–Ø –ø–µ—Ä–µ–ø–∏—à—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Ç–∞–∫, —â–æ–± –≤—ñ–Ω:
‚úÖ –ü—ñ–¥—Ç—è–≥—É–≤–∞–≤ `C008` (—è–∫ `l_tab_no`).
‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä—è–≤, —è–∫—â–æ –Ω–µ–º–∞—î position / department / unit ‚Äî —Ä–æ–±–∏–≤ –∑–∞–ø–∏—Ç –≤ `USERS + DEPARTMENT` –ø–æ `TAB_NO`.
‚úÖ –í–∏–≤–æ–¥–∏–≤ –∫–∞—Ä—Ç–∫—É –∑ –ø—ñ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏.
‚úÖ –Ü –±—É–≤ —á–∏—Å—Ç—ñ—à–∏–º —Ç–∞ –±–µ–∑ –¥—É–±–ª—é–≤–∞–Ω–Ω—è.

---

## üîπ **–û–Ω–æ–≤–ª–µ–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥—É**

```plsql
-- –î–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ
l_tab_no VARCHAR2(50);
l_user_pos VARCHAR2(255);
l_user_dep VARCHAR2(255);

-- –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –∫—É—Ä—Å–æ—Ä—É
OPEN confirm_list FOR 
    SELECT SEQ_ID, c001, c002, c003, c009, c010, c011, c008
    FROM APEX_collections
    WHERE collection_name = 'CONFIRM_CART_' || l_stage_id || '_' || l_substage_id
      AND c004 = l_substage_id
    ORDER BY TO_NUMBER(c006);

LOOP
    l_order_counter := l_order_counter + 1;
    FETCH confirm_list INTO 
        l_list_id, 
        l_list_position, 
        l_list_department, 
        l_list_unit, 
        l_list_position_id, 
        l_list_department_id, 
        l_list_unit_id,
        l_tab_no;
    EXIT WHEN confirm_list%NOTFOUND;

    -- –§–æ—Ä–º—É—î–º–æ dep/unit
    IF l_list_department IS NOT NULL AND l_list_unit IS NOT NULL THEN
        l_dep_unit := '<span class="l-dep-unit">(' || l_list_department || '/' || l_list_unit || ')</span>';
    ELSIF l_list_department IS NOT NULL THEN
        l_dep_unit := '<span class="l-dep-unit">(' || l_list_department || ')</span>';
    ELSIF l_list_unit IS NOT NULL THEN
        l_dep_unit := '<span class="l-dep-unit">(' || l_list_unit || ')</span>';
    ELSE
        l_dep_unit := '';
    END IF;

    -- –Ø–∫—â–æ –Ω–µ–º–∞—î –ø–æ–∑–∏—Ü—ñ—ó / –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—É / —é–Ω—ñ—Ç—É ‚Äî —à—É–∫–∞—î–º–æ –¥–∞–Ω—ñ –ø–æ tab_no
    IF l_list_position IS NULL AND l_list_department IS NULL AND l_list_unit IS NULL AND l_tab_no IS NOT NULL THEN
        BEGIN
            SELECT u.POSITION_NAME, d.DEPARTMENT_NAME
            INTO l_user_pos, l_user_dep
            FROM USERS u
            LEFT JOIN DEPARTMENT d ON d.ID = u.DEPARTMENT_ID
            WHERE u.TAB_NO = l_tab_no;

        EXCEPTION
            WHEN NO_DATA_FOUND THEN
                l_user_pos := '–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ—Å–∞–¥–∞';
                l_user_dep := '–ù–µ–≤—ñ–¥–æ–º–∏–π –≤—ñ–¥–¥—ñ–ª';
        END;
    ELSE
        l_user_pos := l_list_position;
        l_user_dep := l_list_department; -- –≤–∂–µ –≤–∏–≤–µ–ª–∏ —á–µ—Ä–µ–∑ l_dep_unit
    END IF;

    -- –§–æ—Ä–º—É–≤–∞–Ω–Ω—è –∫–∞—Ä—Ç–∫–∏
    HTP.P('<div class="confirm-cart-item">');
    HTP.P('<div class="c-cart-signer">');

    IF l_list_position IS NOT NULL OR l_list_department IS NOT NULL OR l_list_unit IS NOT NULL THEN
        -- —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç
        HTP.P('<span class="l-list-position">' || NVL(l_list_position, '') || '</span>' || NVL(l_dep_unit, ''));
    ELSE
        -- –≤–∞—Ä—ñ–∞–Ω—Ç –ø–æ tab_no
        HTP.P('<span class="l-list-position">' || l_user_pos || '</span><span class="l-dep-unit">(' || l_user_dep || ')</span>');
    END IF;

    HTP.P('</div>');

    -- –¥–∞–ª—ñ –≤–∞—à –±–ª–æ–∫ –¥–ª—è –¥–∞—Ç–∏, –ü–Ü–ë, —Å—Ç–∞—Ç—É—Å—É —Ç–æ—â–æ
    -- ...

    HTP.P('</div>'); -- –∑–∞–∫—Ä–∏—Ç—Ç—è confirm-cart-item

END LOOP;

CLOSE confirm_list;
```

---

## üîë **–©–æ –∑–º—ñ–Ω–∏–ª–æ—Å—å**

‚úÖ –ü—ñ–¥—Ç—è–≥—É–≤–∞–Ω–Ω—è `C008` —è–∫ `l_tab_no`.
‚úÖ –Ñ–¥–∏–Ω–∞ —Ç–æ—á–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó `l_dep_unit`.
‚úÖ –Ø–∫—â–æ –Ω–µ–º–∞—î –ø–æ–∑–∏—Ü—ñ—ó/–ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—É/—é–Ω—ñ—Ç—É, –∞–ª–µ —î `tab_no`, —à—É–∫–∞—î–º–æ —É –ë–î —ñ –≤–∏–≤–æ–¥–∏–º–æ.
‚úÖ HTML —Ñ–æ—Ä–º—É—î—Ç—å—Å—è —á—ñ—Ç–∫–æ –π –±–µ–∑ –ø–æ–≤—Ç–æ—Ä—ñ–≤.

---

## üöÄ **–ü—ñ–¥–≥–æ—Ç–æ–≤–∏—Ç–∏ –¥–ª—è –≤–∞—Å –ø–æ–≤–Ω–∏–π –±–ª–æ–∫ (–∑ –ø—ñ–¥–ø–∏—Å–∞–º–∏, –∫–Ω–æ–ø–∫–∞–º–∏, –ø—Ä–∞–≤–∞–º–∏)?**

–ù–∞–ø–∏—à—ñ—Ç—å ‚Äî —è –∑–≥–µ–Ω–µ—Ä—É—é **–ø–æ–≤–Ω–∏–π –∫–æ–¥** –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –±–µ–∑ –∑–∞–π–≤–æ–≥–æ –¥—É–±–ª—é–≤–∞–Ω–Ω—è + —Å—Ö–µ–º—É —Ä–æ–±–æ—Ç–∏.
–ß–∏ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å–∞–º–µ —Ç—ñ–ª—å–∫–∏ —Ü—è —á–∞—Å—Ç–∏–Ω–∞? üòä
