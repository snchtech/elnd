üîπ **–ß—É–¥–æ–≤–æ, –æ—Å—å –ø–æ–≤–Ω–∏–π –≥–æ—Ç–æ–≤–∏–π –±–ª–æ–∫ PL/SQL –¥–ª—è –≤–∞—à–æ—ó –∫–∞—Ä—Ç–∫–∏ –≤—ñ–¥–º—ñ—Ç–æ–∫ –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º —Ç–∞–±–µ–ª—å–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ (C008)!**
‚úÖ –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–æ –¥–ª—è —á–∏—Å—Ç–æ—Ç–∏ –∫–æ–¥—É.
‚úÖ –û–±—Ä–æ–±–ª—è—î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –≤–∏–ø–∞–¥–∫–∏ –π –≤–∏–ø–∞–¥–∫–∏ –±–µ–∑ position/department/unit, –∞–ª–µ –∑ `tab_no`.
‚úÖ –ú–æ–∂–Ω–∞ –æ–¥—Ä–∞–∑—É –≤—Å—Ç–∞–≤–ª—è—Ç–∏ —É –≤–∞—à –ø—Ä–æ—Ü–µ—Å.

---

## ‚ö° **–ì–æ—Ç–æ–≤–∏–π –∫–æ–¥**

```plsql
-- –î–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ
l_tab_no VARCHAR2(50);
l_user_pos VARCHAR2(255);
l_user_dep VARCHAR2(255);

-- –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –∫—É—Ä—Å–æ—Ä—É
OPEN confirm_list FOR 
    SELECT SEQ_ID, c001, c002, c003, c009, c010, c011, c008
    FROM APEX_collections
    WHERE collection_name = 'CONFIRM_CART_' || l_stage_id || '_' || l_substage_id
      AND c004 = l_substage_id
    ORDER BY TO_NUMBER(c006);

LOOP
    l_order_counter := l_order_counter + 1;
    FETCH confirm_list INTO 
        l_list_id, 
        l_list_position, 
        l_list_department, 
        l_list_unit, 
        l_list_position_id, 
        l_list_department_id, 
        l_list_unit_id,
        l_tab_no;
    EXIT WHEN confirm_list%NOTFOUND;

    -- –§–æ—Ä–º—É–≤–∞–Ω–Ω—è dep/unit
    IF l_list_department IS NOT NULL AND l_list_unit IS NOT NULL THEN
        l_dep_unit := '<span class="l-dep-unit">(' || l_list_department || '/' || l_list_unit || ')</span>';
    ELSIF l_list_department IS NOT NULL THEN
        l_dep_unit := '<span class="l-dep-unit">(' || l_list_department || ')</span>';
    ELSIF l_list_unit IS NOT NULL THEN
        l_dep_unit := '<span class="l-dep-unit">(' || l_list_unit || ')</span>';
    ELSE
        l_dep_unit := '';
    END IF;

    -- –Ø–∫—â–æ –Ω–µ–º–∞—î position/department/unit, –∞–ª–µ —î tab_no ‚Äî —Ç—è–≥–Ω–µ–º–æ –∑ USERS
    IF l_list_position IS NULL AND l_list_department IS NULL AND l_list_unit IS NULL AND l_tab_no IS NOT NULL THEN
        BEGIN
            SELECT u.POSITION_NAME, d.DEPARTMENT_NAME
            INTO l_user_pos, l_user_dep
            FROM USERS u
            LEFT JOIN DEPARTMENT d ON d.ID = u.DEPARTMENT_ID
            WHERE u.TAB_NO = l_tab_no;
        EXCEPTION
            WHEN NO_DATA_FOUND THEN
                l_user_pos := '–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ—Å–∞–¥–∞';
                l_user_dep := '–ù–µ–≤—ñ–¥–æ–º–∏–π –≤—ñ–¥–¥—ñ–ª';
        END;
    ELSE
        -- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
        l_user_pos := l_list_position;
        l_user_dep := NULL; -- –≤–∂–µ –≤–∏–≤–µ–ª–∏ —á–µ—Ä–µ–∑ l_dep_unit
    END IF;

    -- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è HTML
    HTP.P('<div class="confirm-cart-item">');
    HTP.P('<div class="c-cart-signer">');

    IF l_list_position IS NOT NULL OR l_list_department IS NOT NULL OR l_list_unit IS NOT NULL THEN
        HTP.P('<span class="l-list-position">' || NVL(l_list_position, '') || '</span>' || NVL(l_dep_unit, ''));
    ELSE
        HTP.P('<span class="l-list-position">' || l_user_pos || '</span><span class="l-dep-unit">(' || l_user_dep || ')</span>');
    END IF;

    HTP.P('</div>');

    -- –í–∏–≤—ñ–¥ –¥–∞—Ç–∏ —Ç–∞ –≤–∏–∫–æ–Ω–∞–≤—Ü—è (—Å–ø—Ä–æ—â–µ–Ω–æ, —Ä–æ–∑—à–∏—Ä—Ç–µ –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±—ñ)
    BEGIN
        SELECT TO_CHAR(t.SIGNER_DATE, 'dd.mm.yyyy hh24:mi')
        INTO l_check_signer_date
        FROM ASICS.SIGNATUREHISTORY t
        WHERE t.SIGNRIGHT_ID = l_signature_id;

        HTP.P('<div class="c-cart-date-time">' || l_check_signer_date || '</div>');
    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            HTP.P('<div class="c-cart-date-time"></div>');
    END;

    -- –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –ü–Ü–ë, –∫–æ–º–µ–Ω—Ç–∞—Ä, —Å—Ç–∞—Ç—É—Å —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
    HTP.P('<div class="c-cart-pib"></div>');
    HTP.P('<div class="c-cart-signer-comment"></div>');
    HTP.P('<div class="c-cart-signer-mark"></div>');

    HTP.P('</div>'); -- confirm-cart-item

END LOOP;

CLOSE confirm_list;
```

---

## üìù **–©–æ —â–µ –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏**

üí° –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ, —è –º–æ–∂—É —Ä–æ–∑—à–∏—Ä–∏—Ç–∏ –±–ª–æ–∫:

* –ó –≥–µ–Ω–µ—Ä–∞—Ü—ñ—î—é –∫–Ω–æ–ø–∫–∏ –ø—ñ–¥–ø–∏—Å—É —á–∏ —Å—Ç–∞—Ç—É—Å—É –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è (–Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–æ–ª–µ–π).
* –ó –ø–æ–≤–Ω–∏–º –≤–∏–≤–æ–¥–æ–º `–ü–Ü–ë`, `–ø–æ—Å–∞–¥–∞`, `–≤—ñ–¥–¥—ñ–ª`, `–∫–æ–º–µ–Ω—Ç–∞—Ä`.
* –ó –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º –∫–ª–∞—Å—ñ–≤ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ/–Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç–∞–Ω—É.

---

## üöÄ **–•–æ—á–µ—Ç–µ –ø–æ–≤–Ω—ñ—Å—Ç—é –≥–æ—Ç–æ–≤–∏–π –∫–æ–¥ –¥–ª—è –≤—Å—ñ—î—ó –∫–∞—Ä—Ç–∫–∏ (–∑ –∫–Ω–æ–ø–∫–∞–º–∏, —Ä–æ–ª—è–º–∏, –ø—ñ–¥–ø–∏—Å–∞–º–∏)?**

–ù–∞–ø–∏—à—ñ—Ç—å! –Ø –ø—ñ–¥–≥–æ—Ç—É—é –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –≤–∞—à–∏—Ö –≤–∏–º–æ–≥ (ACL, —Å—Ç–∞—Ç—É—Å–∏, –∫–Ω–æ–ø–∫–∏). üòä
