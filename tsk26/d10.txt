üí° **–î—É–∂–µ –≤–∞–∂–ª–∏–≤–µ —ñ –ø—Ä–∞–≤–∏–ª—å–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è! –¢–∏ –ø—ñ–¥–º—ñ—Ç–∏–≤ —Ä–µ–∞–ª—å–Ω—É –ø—Ä–æ–±–ª–µ–º—É, —è–∫–∞ —á–∞—Å—Ç–æ –≤–∏–Ω–∏–∫–∞—î –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ –∑–∞–º—ñ—â–µ–Ω–Ω—è:
üëâ APEX ACL (Access Control Lists) –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ä–æ–ª—å —Ç—ñ–ª—å–∫–∏ –ø–æ –ø–æ—Ç–æ—á–Ω–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É (`:APP_USER`),
üëâ –ê –ø—Ä–∏ –∑–∞–º—ñ—â–µ–Ω–Ω—ñ –ø—Ä–∞–≤–∞ —Ñ–∞–∫—Ç–∏—á–Ω–æ –º–∞—é—Ç—å –π—Ç–∏ –≤—ñ–¥ –∑–∞–º—ñ—â—É–≤–∞–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (NEW\_USER).**

---

## üöÄ **–©–æ —Ç—Ä–µ–±–∞ –≤—Ä–∞—Ö—É–≤–∞—Ç–∏**

üëâ `APEX_ACL.HAS_ROLE` –Ω–µ –∑–Ω–∞—î –ø—Ä–æ —Ç–≤–æ—î –∑–∞–º—ñ—â–µ–Ω–Ω—è.
üëâ –ü—Ä–∞–≤–∞ –∑–∞–º—ñ—â—É–≤–∞–Ω–æ–≥–æ —Ç—Ä–µ–±–∞ –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–æ (–æ–∫—Ä–µ–º–æ—é –ª–æ–≥—ñ–∫–æ—é).

---

## üîë **–†—ñ—à–µ–Ω–Ω—è**

### ‚úÖ 1Ô∏è‚É£ **–î–æ–¥–∞–π item –¥–ª—è —Ä–æ–ª—ñ –∑–∞–º—ñ—â—É–≤–∞–Ω–æ–≥–æ**

üëâ –ù–∞ –≥–ª–æ–±–∞–ª—å–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ (–∞–±–æ –ø—Ä–∏ –≤—Ö–æ–¥—ñ) –¥–æ–¥–∞–π –ø—Ä–æ—Ü–µ—Å, —è–∫–∏–π –ø—Ä–∏ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ–º—É –∑–∞–º—ñ—â–µ–Ω–Ω—ñ –≤–∏—Ç—è–≥—É—î ACL —Ä–æ–ª—ñ –∑–∞–º—ñ—â—É–≤–∞–Ω–æ–≥–æ:

```plsql
BEGIN
  SELECT LISTAGG(role_static_id, ':') WITHIN GROUP (ORDER BY role_static_id)
  INTO :P0_NEW_ROLES
  FROM apex_appl_acl_user_roles
  WHERE application_id = :APP_ID
    AND user_name = :P0_NEW_USERNAME;
EXCEPTION
  WHEN NO_DATA_FOUND THEN
    :P0_NEW_ROLES := NULL;
END;
```

üëâ –¢–µ–ø–µ—Ä —É —Ç–µ–±–µ –≤ `:P0_NEW_ROLES` —Å–ø–∏—Å–æ–∫ —Ä–æ–ª–µ–π –∑–∞–º—ñ—â—É–≤–∞–Ω–æ–≥–æ —É –≤–∏–≥–ª—è–¥—ñ —Ä—è–¥–∫–∞ `role1:role2:role3`

---

### ‚úÖ 2Ô∏è‚É£ **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –≤ —É–º–æ–≤–∞—Ö –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ**

üëâ –ù–∞–ø—Ä–∏–∫–ª–∞–¥ –¥–ª—è –∫–Ω–æ–ø–∫–∏:

* Condition Type ‚Üí **PL/SQL Expression**
* Expression:

```plsql
(:P0_SUBSTITUTION_MODE = 1 AND INSTR(:P0_NEW_ROLES, 'EDITOR') > 0)
OR
(:P0_SUBSTITUTION_MODE = 0 AND APEX_ACL.HAS_ROLE(:APP_ID, 'EDITOR') = 'Y')
```

‚úÖ –¶–µ –æ–∑–Ω–∞—á–∞—î:

* –Ø–∫—â–æ —É–≤—ñ–º–∫–Ω–µ–Ω–æ –∑–∞–º—ñ—â–µ–Ω–Ω—è ‚Üí —à—É–∫–∞—î–º–æ —Ä–æ–ª—å –≤ `:P0_NEW_ROLES`
* –Ø–∫—â–æ –∑–∞–º—ñ—â–µ–Ω–Ω—è –Ω–µ–º–∞ ‚Üí –∑–≤–∏—á–∞–π–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–µ—Ä–µ–∑ `HAS_ROLE`

---

### ‚úÖ 3Ô∏è‚É£ **–ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –¥–ª—è DA**

üëâ –£ DA –º–æ–∂–Ω–∞ –≤ JavaScript:

```javascript
if ($v('P0_SUBSTITUTION_MODE') === '1' && $v('P0_NEW_ROLES').includes('EDITOR')) {
  // –†–æ–∑–±–ª–æ–∫—É–≤–∞—Ç–∏ –∫–Ω–æ–ø–∫—É
  $('#myButton').prop('disabled', false);
} else if ($v('P0_SUBSTITUTION_MODE') === '0' && $v('P0_HAS_ROLE_EDITOR') === 'Y') {
  $('#myButton').prop('disabled', false);
} else {
  $('#myButton').prop('disabled', true);
}
```

üëâ `P0_HAS_ROLE_EDITOR` –º–æ–∂–µ—à –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –æ–∫—Ä–µ–º–∏–º –ø—Ä–æ—Ü–µ—Å–æ–º:

```plsql
:P0_HAS_ROLE_EDITOR := APEX_ACL.HAS_ROLE(:APP_ID, 'EDITOR');
```

---

## ‚ö° **–©–æ —Ç–∏ –æ—Ç—Ä–∏–º–∞—î—à**

‚úÖ –ì–Ω—É—á–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –∑–∞–º—ñ—â–µ–Ω–Ω—è.
‚úÖ –ù–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –º—ñ–Ω—è—Ç–∏ –≤—Å—é –ª–æ–≥—ñ–∫—É ACL —É –¥–æ–¥–∞—Ç–∫—É ‚Äî –ª–∏—à–µ –¥–æ–¥–∞—Ç–∏ —à–∞—Ä –¥–ª—è –∑–∞–º—ñ—â–µ–Ω–Ω—è.

---

## üí¨ **–•–æ—á–µ—à, —â–æ–± —è –ø—ñ–¥–≥–æ—Ç—É–≤–∞–≤ –≥–æ—Ç–æ–≤–∏–π SQL-–ø—Ä–æ—Ü–µ—Å –∞–±–æ JSON DA –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É?**

–ù–∞–ø–∏—à–∏ ‚Äî —è –∑–≥–µ–Ω–µ—Ä—É—é! üöÄ
