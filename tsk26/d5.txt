üí° **–î—É–∂–µ —á—ñ—Ç–∫–æ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–µ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è! –î–∞–≤–∞–π —É–≤–∞–∂–Ω–æ —Ä–æ–∑–±–µ—Ä–µ–º–æ —Ç–≤—ñ–π SQL —ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ –π–æ–≥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –æ–ø–∏—Å–∞–Ω—ñ–π –ª–æ–≥—ñ—Ü—ñ Access Level 1, 2, 3. –Ø –ø–æ—è—Å–Ω—é –ø–æ –∫–æ–∂–Ω–æ–º—É –±–ª–æ–∫—É, —â–æ –≤—ñ–Ω —Ä–æ–±–∏—Ç—å, —ñ —á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –≤–∏–º–æ–≥–∞–º.**

---

## üöÄ **1Ô∏è‚É£ Access Level 1**

### –í–∏–º–æ–≥–∞:

üëâ –ü–æ–≤–µ—Ä—Ç–∞—î –≤—Å—ñ –∑–∞–≤–¥–∞–Ω–Ω—è (–±–µ–∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó), —è–∫—â–æ —î –ø—Ä–∞–≤–∏–ª–æ –∑ `access_level = 1` –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ –π–æ–≥–æ –ø–æ–∑–∏—Ü—ñ—ó.

### –£ —Ç–≤–æ—î–º—É –∫–æ–¥—ñ:

```sql
ac.access_level = 1
AND (
  ac.user_id = :P0_USER_ID
  OR (ac.position_id IS NOT NULL AND ac.position_id = :P0_POSITION_ID)
  OR (ac.position_id IS NULL)
)
```

‚úÖ **–ö–æ–º–µ–Ω—Ç–∞—Ä:**

* `ac.user_id = :P0_USER_ID` ‚Üí —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–π –¥–æ—Å—Ç—É–ø.
* `ac.position_id IS NOT NULL AND ac.position_id = :P0_POSITION_ID` ‚Üí –¥–æ—Å—Ç—É–ø –ø–æ –ø–æ–∑–∏—Ü—ñ—ó.
* `ac.position_id IS NULL` ‚Üí –∑–∞–≥–∞–ª—å–Ω–µ –ø—Ä–∞–≤–∏–ª–æ (–¥–ª—è –≤—Å—ñ—Ö –ø–æ–∑–∏—Ü—ñ–π).

üëâ **–ü—Ä–æ–±–ª–µ–º–∞:**
`OR ac.position_id IS NULL` —É —Ü—å–æ–º—É –≤–∏–≥–ª—è–¥—ñ —Ñ–∞–∫—Ç–∏—á–Ω–æ –∑–∞–≤–∂–¥–∏ —Å–ø—Ä–∞—Ü—å–æ–≤—É—î (–¥–∞—î –≥–ª–æ–±–∞–ª—å–Ω–∏–π –¥–æ—Å—Ç—É–ø, –±–æ –Ω–µ–º–∞—î –ø–æ–∑–∏—Ü—ñ—ó).
‚û° –ô–º–æ–≤—ñ—Ä–Ω–æ, —Ç–∏ —Ö–æ—Ç—ñ–≤ –±–∏:

```sql
(ac.user_id = :P0_USER_ID OR ac.position_id = :P0_POSITION_ID OR (ac.user_id IS NULL AND ac.position_id IS NULL))
```

—â–æ–± –±—É–ª–æ —á—ñ—Ç–∫–æ: —è–∫—â–æ –Ω—ñ user\_id, –Ω—ñ position\_id ‚Äî –ø—Ä–∞–≤–∏–ª–æ –∑–∞–≥–∞–ª—å–Ω–µ.

---

## üöÄ **2Ô∏è‚É£ Access Level 2**

### –í–∏–º–æ–≥–∞:

üëâ –ü–æ–≤–µ—Ä—Ç–∞—î –∑–∞–≤–¥–∞–Ω–Ω—è, —è–∫—â–æ —Å–ø—ñ–≤–ø–∞–¥–∞—é—Ç—å position\_id, department\_id, unit\_id (—è–∫—â–æ –≤–æ–Ω–∏ –≤–∫–∞–∑–∞–Ω—ñ).
üëâ –ú–æ–∂–µ –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ user\_id.

### –£ —Ç–≤–æ—î–º—É –∫–æ–¥—ñ:

```sql
ac.access_level = 2
AND (
  (ac.position_id IS NULL OR ac.position_id = :P0_POSITION_ID)
  AND (ac.department_id IS NULL OR ac.department_id = :P0_DEPARTMENT_ID)
  AND (ac.unit_id IS NULL OR ac.unit_id = :P0_UNIT_ID)
)
AND (
  ac.user_id IS NULL OR ac.user_id = :P0_USER_ID
)
```

‚úÖ **–¶–µ –¥–æ–±—Ä–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ**.
üëâ –¶–µ –¥–æ–∑–≤–æ–ª—è—î:

* –Ø–∫—â–æ –∑–Ω–∞—á–µ–Ω–Ω—è –≤ –ø—Ä–∞–≤–∏–ª—ñ NULL ‚Üí –Ω–µ–º–∞—î –æ–±–º–µ–∂–µ–Ω–Ω—è.
* –Ø–∫—â–æ –∑–Ω–∞—á–µ–Ω–Ω—è —î ‚Üí —Ñ—ñ–ª—å—Ç—Ä—É—î—Ç—å—Å—è –ø–æ –Ω—å–æ–º—É.

---

## üöÄ **3Ô∏è‚É£ Access Level 3**

### –í–∏–º–æ–≥–∞:

üëâ –ü–æ–≤–µ—Ä—Ç–∞—î –∑–∞–≤–¥–∞–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –¥–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —î –≤ `signaturerights`.

### –£ —Ç–≤–æ—î–º—É –∫–æ–¥—ñ:

```sql
ac.access_level = 3
AND ac.user_id = :P0_USER_ID
```

üëâ **–¶—å–æ–≥–æ –º–∞–ª–æ.**
‚û° –£ —Ç–≤–æ—î–º—É –æ–ø–∏—Å—ñ: Access Level 3 ‚Äî —Ü–µ **–¥–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —î –≤ signaturerights**.
‚û° –ê–ª–µ –≤ –∫–æ–¥—ñ: Access Level 3 –∑–∞—Ä–∞–∑ —à—É–∫–∞—î—Ç—å—Å—è –ª–∏—à–µ –ø–æ task\_access\_control.user\_id.

### –û–¥–Ω–∞–∫ —Ç–∏ –¥–æ–¥–∞–≤ –æ–∫—Ä–µ–º–∏–π EXISTS:

```sql
OR EXISTS (
  SELECT 1
  FROM signaturerights sr
  WHERE sr.task_id = t.id
    AND sr.user_id = :P0_USER_ID
    AND sr.status <> 11
)
```

‚úÖ **–¶–µ —è–∫—Ä–∞–∑ —ñ —î –ø—Ä–∞–≤–∏–ª—å–Ω–µ –≤—Ä–∞—Ö—É–≤–∞–Ω–Ω—è signaturerights!**

---

## üöÄ **–ó–∞–≥–∞–ª—å–Ω–∏–π –ø—ñ–¥—Å—É–º–æ–∫**

| Access Level | –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —É —Ç–≤–æ—î–º—É –∫–æ–¥—ñ                                     | –í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å |
| ------------ | ------------------------------------------------------------ | ------------- |
| 1            | –Ñ (–∞–ª–µ —Ç—Ä–µ–±–∞ –ø—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ OR, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –Ω–∞–¥–º—ñ—Ä–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É) | 95%           |
| 2            | –î–æ–±—Ä–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –ø–æ –ø–æ–ª—è–º                   | 100%          |
| 3            | –ß–µ—Ä–µ–∑ `OR EXISTS` –ø–æ signaturerights                         | 100%          |

---

## ‚ö° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è –¥–ª—è Access Level 1**

–ó–∞–º—ñ–Ω–∏:

```sql
OR (ac.position_id IS NULL)
```

–Ω–∞

```sql
OR (ac.user_id IS NULL AND ac.position_id IS NULL)
```

‚úÖ –¶–µ –Ω–µ –¥–∞—Å—Ç—å –¥–æ—Å—Ç—É–ø—É –≤—Å—ñ–º –ø—Ä–æ—Å—Ç–æ —á–µ—Ä–µ–∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å position\_id.

---

## üí° **–•–æ—á–µ—à, —â–æ–± —è –ø–µ—Ä–µ–ø–∏—Å–∞–≤ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π SQL —ñ–∑ —Ü—ñ—î—é –ø–æ–ø—Ä–∞–≤–∫–æ—é?**

–ù–∞–ø–∏—à–∏ ‚Äî —è –∑–≥–µ–Ω–µ—Ä—É—é –≥–æ—Ç–æ–≤–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç! üöÄ
