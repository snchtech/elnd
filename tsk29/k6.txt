–ß—É–¥–æ–≤–µ —É—Ç–æ—á–Ω–µ–Ω–Ω—è. –¢–∏ —Ö–æ—á–µ—à:

> **–î–æ–¥–∞—Ç–∫–æ–≤–æ –ø–æ–∫–∞–∑–∞—Ç–∏ —á–µ–∫–±–æ–∫—Å "–í—ñ–¥ —ñ–º–µ–Ω—ñ" –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –≤ —á–µ—Ä–∑—ñ –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç–∞**,
> –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á **–Ω–µ –º–∞—î –ø–æ–≤–Ω–æ–≥–æ –∑–±—ñ–≥—É –ø–æ —Ä–æ–ª—ñ**, –∞–ª–µ –º–∞—î **—Ä–æ–ª—å `EXTEND_SIGN`**,
> —ñ –ø—Ä–∏ —Ü—å–æ–º—É –π–æ–≥–æ `DEPARTMENT_ID` –∑–±—ñ–≥–∞—î—Ç—å—Å—è –∑ —Ç–∏–º, —â–æ –≤ `SIGNATURERIGHTS`,
> –∞ `POSITION_ID NOT IN (2206, 2246)`.

---

## üîß –Ø–∫ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ü–µ

### üîÅ **–ê–ª–≥–æ—Ä–∏—Ç–º –ª–æ–≥—ñ–∫–∏ –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —á–µ–∫–±–æ–∫—Å—É**

1. –ü–µ—Ä–µ–≤—ñ—Ä, —á–∏ –ø–æ—Ç–æ—á–Ω–∏–π –ø—ñ–¥–ø–∏—Å **—â–µ –Ω–µ –∑—Ä–æ–±–ª–µ–Ω–∏–π** (—Ç–æ–±—Ç–æ `SIGNATUREHISTORY` –Ω–µ –º—ñ—Å—Ç–∏—Ç—å –∑–∞–ø–∏—Å—É –¥–ª—è `l_signature_id`).
2. –í–∏–∑–Ω–∞—á, —á–∏ **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î —Ä–æ–ª—å `EXTEND_SIGN`** —á–µ—Ä–µ–∑ `APEX_ACL.HAS_ROLE(...)`.
3. –Ø–∫—â–æ –º–∞—î, –ø–µ—Ä–µ–≤—ñ—Ä:

   * –ß–∏ `:P0_DEPARTMENT_ID = l_list_department_id`
   * –ß–∏ `l_list_position_id NOT IN (2206, 2246)`
4. –Ø–∫—â–æ –≤—Å—ñ —Ü—ñ —É–º–æ–≤–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è —ñ —Ü–µ **–ø–µ—Ä—à–∏–π –≤ —á–µ—Ä–∑—ñ –Ω–∞ –ø—ñ–¥–ø–∏—Å (l\_count\_cb = 0)**,
   —Ç–æ–¥—ñ **–≤–∏–≤–µ—Å—Ç–∏ —á–µ–∫–±–æ–∫—Å "–í—ñ–¥ —ñ–º–µ–Ω—ñ"**, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Å–∞–º –ø—ñ–¥–ø–∏—Å –Ω–µ –Ω–∞–ª–µ–∂–∏—Ç—å —Ü—å–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É.

---

## ‚úÖ –ö–æ–¥ –¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–æ —Ç–≤–æ—î—ó –ª–æ–≥—ñ–∫–∏

–í—Å—Ç–∞–≤ —Ü—é –ø–µ—Ä–µ–≤—ñ—Ä–∫—É **–ø—ñ—Å–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ —Ä–æ–ª—ñ** —ñ –ø–µ—Ä–µ–¥ `HTP.P('</div>');`.

```plsql
-- –î–æ–¥–∞—Ç–∫–æ–≤–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª: —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î EXTEND_SIGN —ñ –º–æ–∂–µ –ø—ñ–¥–ø–∏—Å–∞—Ç–∏ –í–Ü–î –Ü–ú–ï–ù–Ü
IF l_count_cb = 0 THEN
  l_moderator_role := APEX_ACL.HAS_ROLE (
    p_application_id => l_application_id,
    p_role_static_id => 'EXTEND_SIGN',
    p_user_name      => v('APP_USER')
  );

  IF l_moderator_role AND 
     l_list_department_id = :P0_DEPARTMENT_ID AND
     l_list_position_id NOT IN (2206, 2246)
  THEN
    HTP.P('<div class="extend-sign-container">');
    HTP.P('<label><input type="checkbox" class="extend-sign-checkbox" data-signature-id="' || l_signature_id || '"> –í—ñ–¥ —ñ–º–µ–Ω—ñ</label>');
    HTP.P('</div>');
  END IF;
END IF;
```

---

## üìå –ü–æ—è—Å–Ω–µ–Ω–Ω—è:

* `l_count_cb = 0` ‚Äî –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ —Ü–µ **–ø–µ—Ä—à–∏–π —â–µ –Ω–µ –ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π –∑–∞–ø–∏—Å**.
* `APEX_ACL.HAS_ROLE(...)` ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ä–æ–ª—å `EXTEND_SIGN`.
* `DEPARTMENT_ID` ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –Ω–∞ –∑–±—ñ–≥ —ñ–∑ –ø–æ—Ç–æ—á–Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º.
* `POSITION_ID` ‚Äî –≤–∏–∫–ª—é—á–∞—î –¥–≤–∞ —Å–ª—É–∂–±–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è.

---

## üß© –©–æ —â–µ —Ç—Ä–µ–±–∞:

1. **JS –æ–±—Ä–æ–±–∫–∞** –¥–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –¥—ñ–∞–ª–æ–≥—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –Ω–∞ —á–µ–∫–±–æ–∫—Å `extend-sign-checkbox`.
2. **–ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —á–µ—Ä–µ–∑ `apex.navigation.dialog`) –∑ –≤–∏–±–æ—Ä–æ–º —Å–ø–æ—Å–æ–±—É –ø—ñ–¥–ø–∏—Å—É:

   * –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —è–∫ `SIGNATURERIGHTS.USER_ID`
   * –ê–±–æ `select` —á–µ—Ä–µ–∑ LOV –∑ USERS

---

üîú –ì–æ—Ç–æ–≤–∏–π –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –∑ JavaScript + APEX-–¥—ñ–∞–ª–æ–≥–æ–º –¥–ª—è —Ü—å–æ–≥–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É?
