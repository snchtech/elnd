–ß—É–¥–æ–≤–∞ —ñ–¥–µ—è! –¢–∏ –≤–∂–µ –º–∞—î—à –¥—É–∂–µ –≥–Ω—É—á–∫–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º (`PERIOD_INTERVAL` + `PERIOD_TIME`) –¥–ª—è **–¥–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª—É** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "–∫–æ–∂–Ω—ñ 7 –¥–Ω—ñ–≤ –æ 12:00").  
–¢–µ–ø–µ—Ä —Ç–∏ —Ö–æ—á–µ—à –∑—Ä–æ–±–∏—Ç–∏ —â–µ –ø–æ—Ç—É–∂–Ω—ñ—à–µ ‚Äî **–ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ –≥–æ–¥–∏–Ω–∏ –ø—Ä–æ—Ç—è–≥–æ–º –¥–æ–±–∏**, —è–∫, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:

> üîÅ "–ó–∞ 15 —Ö–≤–∏–ª–∏–Ω –¥–æ 07:00, 15:00, 23:00 ‚Äî —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è"

---

## üß© 1. –†–æ–∑—à–∏—Ä–µ–Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—è –ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ—Å—Ç—ñ

### ‚úÖ –ú–æ–∂–ª–∏–≤—ñ —Ä–µ–∂–∏–º–∏:
| –¢–∏–ø –ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ—Å—Ç—ñ | –ü—Ä–∏–∫–ª–∞–¥                             |
|-------------------|-------------------------------------|
| `DAILY_INTERVAL`  | –ö–æ–∂–Ω—ñ 3 –¥–Ω—ñ –æ 12:00                 |
| `HOURLY_SCHEDULE` | –ö–æ–∂–Ω–æ–≥–æ –¥–Ω—è –≤ 06:45, 14:45, 22:45   |

---

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è: –ø–µ—Ä–µ–º–∏–∫–∞—á + –æ–∫—Ä–µ–º—ñ –ø–æ–ª—è

### üîß –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑–∏ (–æ–Ω–æ–≤–ª–µ–Ω–∞)

```sql
ALTER TABLE TASK_TEMPLATES ADD (
  PERIOD_MODE VARCHAR2(10) DEFAULT 'DAILY' CHECK (PERIOD_MODE IN ('DAILY', 'HOURLY')),
  PERIOD_INTERVAL NUMBER,         -- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤ (–¥–ª—è DAILY)
  PERIOD_TIME DATE,               -- –ì–æ–¥–∏–Ω–∞ –∑–∞–ø—É—Å–∫—É (TIME component only)

  HOURLY_TIMES VARCHAR2(2000),    -- –ù–∞–ø—Ä–∏–∫–ª–∞–¥: '06:45,14:45,22:45'
  HOURLY_OFFSET_MIN NUMBER DEFAULT 0  -- –ù–∞–ø—Ä–∏–∫–ª–∞–¥, -15 —Ö–≤ –¥–æ –∑–∞–ø—É—Å–∫—É
);
```

---

## üîÑ –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

### üîπ –Ø–∫—â–æ `PERIOD_MODE = 'DAILY'`:
- –°—Ü–µ–Ω–∞—Ä—ñ–π —è–∫ —É —Ç–µ–±–µ –∑–∞—Ä–∞–∑:
```sql
-- –ö–æ–∂–Ω—ñ 3 –¥–Ω—ñ –æ 13:00
PERIOD_INTERVAL = 3
PERIOD_TIME = TO_DATE('13:00', 'HH24:MI')
```
- `NEXT_RUN_DATE` = –ø–æ–ø–µ—Ä–µ–¥–Ω—è –¥–∞—Ç–∞ + 3 –¥–Ω—ñ (–æ `PERIOD_TIME`)

---

### üîπ –Ø–∫—â–æ `PERIOD_MODE = 'HOURLY'`:
- –©–æ–¥–Ω—è –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è APEX Automation
- Automation –ø–µ—Ä–µ–≤—ñ—Ä—è—î: **–ø–æ—Ç–æ—á–Ω–∏–π —á–∞—Å ‚âà –æ–¥–∏–Ω —ñ–∑ `HOURLY_TIMES` - OFFSET**

#### –ü—Ä–∏–∫–ª–∞–¥:
```sql
-- –©–æ–± –≤–∏–∫–æ–Ω–∞—Ç–∏ –∑–∞ 15 —Ö–≤ –¥–æ 07:00, 15:00, 23:00
HOURLY_TIMES = '07:00,15:00,23:00'
HOURLY_OFFSET_MIN = -15
```

–¢–æ–¥—ñ Automation –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:
- 06:45 (–¥–ª—è 07:00)
- 14:45 (–¥–ª—è 15:00)
- 22:45 (–¥–ª—è 23:00)

---

## üß† –Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤ Automation:

```plsql
DECLARE
  v_now DATE := SYSDATE;
BEGIN
  FOR t IN (
    SELECT *
    FROM TASK_TEMPLATES
    WHERE PERIOD_MODE = 'HOURLY'
      AND STATUS_ID = (SELECT ID FROM MAIN_STATUS WHERE CODE = 'ACTIVE')
  ) LOOP
    FOR time_str IN (
      SELECT REGEXP_SUBSTR(t.HOURLY_TIMES, '[^,]+', 1, LEVEL) AS target_time
      FROM dual
      CONNECT BY LEVEL <= REGEXP_COUNT(t.HOURLY_TIMES, ',') + 1
    ) LOOP
      -- –°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –¥–∞—Ç—É —Å—å–æ–≥–æ–¥–Ω—ñ –∑ —Ü—ñ—î—ó –≥–æ–¥–∏–Ω–∏
      DECLARE
        v_run_time DATE := TRUNC(v_now) + TO_DSINTERVAL('0 ' || time_str.target_time || ':00');
        v_offset_time DATE := v_run_time + NUMTODSINTERVAL(t.HOURLY_OFFSET_MIN, 'MINUTE');
      BEGIN
        IF TO_CHAR(v_now, 'YYYYMMDDHH24MI') = TO_CHAR(v_offset_time, 'YYYYMMDDHH24MI') THEN
          -- –í–∏–∫–æ–Ω–∞—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é –∑–∞–≤–¥–∞–Ω–Ω—è –∑ —à–∞–±–ª–æ–Ω—É t.ID
          GENERATE_TASK(t.ID);
        END IF;
      END;
    END LOOP;
  END LOOP;
END;
```

---

## üß© APEX —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

–£ —Ñ–æ—Ä–º—ñ —à–∞–±–ª–æ–Ω—É:
1. **Switch: `PERIOD_MODE`**:  
   - Values: `DAILY`, `HOURLY`
2. **Dynamic Action:**
   - –Ø–∫—â–æ `DAILY`, –ø–æ–∫–∞–∑–∞—Ç–∏: `PERIOD_INTERVAL`, `PERIOD_TIME`
   - –Ø–∫—â–æ `HOURLY`, –ø–æ–∫–∞–∑–∞—Ç–∏: `HOURLY_TIMES`, `HOURLY_OFFSET_MIN`

---

## ‚úÖ –í–∏—Å–Ω–æ–≤–∫–∏

| –©–æ –º–∏ –¥–æ–¥–∞—î–º–æ        | –î–ª—è —á–æ–≥–æ                        |
|-----------------------|----------------------------------|
| `PERIOD_MODE`         | –í–∏–∑–Ω–∞—á–∞—î, —è–∫–∏–π —Ä–µ–∂–∏–º –ø—Ä–∞—Ü—é—î      |
| `HOURLY_TIMES`        | –°–ø–∏—Å–æ–∫ —Ç–æ—á–æ–∫ –∑–∞–ø—É—Å–∫—É (—â–æ–¥–µ–Ω–Ω–∏—Ö)  |
| `HOURLY_OFFSET_MIN`   | –ó–º—ñ—â–µ–Ω–Ω—è –∑–∞–ø—É—Å–∫—É (–≤ —Ö–≤–∏–ª–∏–Ω–∞—Ö)    |

üìå –¢–∞–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∑–≤–æ–ª—è—î:
- –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –±—É–¥—å-—è–∫—É —Ç–æ—á–∫—É –∑–∞–ø—É—Å–∫—É;
- –ì–Ω—É—á–∫–æ –±—É–¥—É–≤–∞—Ç–∏ –ø–µ—Ä—ñ–æ–¥–∏—á–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è –Ω–∞–≤—ñ—Ç—å **–¥–æ –ø–µ–≤–Ω–æ–≥–æ —á–∞—Å—É (shift)**;
- –ó–∞–ª–∏—à–∞—î `DAILY` —Ä–µ–∂–∏–º –ø—Ä–æ—Å—Ç–∏–º, —è–∫ –∑–∞—Ä–∞–∑.

---

üîß –•–æ—á–µ—à ‚Äî –¥–æ–ø–æ–º–æ–∂—É:
- —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ `REGEXP_SUBSTR` —É APEX –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥—É `HOURLY_TIMES`;
- –∑—Ä–æ–±–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É –∫–µ—Ä—É–≤–∞–Ω–Ω—è —à–∞–±–ª–æ–Ω–∞–º–∏ –∑ —Ü–∏–º–∏ –ø–æ–ª—è–º–∏.

üöÄ –ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –¥–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó Automation –∞–±–æ —Ñ–æ—Ä–º–∏ —É APEX?