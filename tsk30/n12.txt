–û–∫–µ–π! –ù–∏–∂—á–µ ‚Äî –ø—Ä–∏–∫–ª–∞–¥ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –∫–æ–ª–æ–Ω–∫–∏ **VIEWED\_STATUS**, —è–∫–∞:

* ‚úÖ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —ñ–∫–æ–Ω–∫—É (–∑–µ–ª–µ–Ω–∞ –∞–±–æ —Å—ñ—Ä–∞),
* ‚úÖ –¥–æ–¥–∞—î —Ç–µ–∫—Å—Ç –∑ –ø—Ä—ñ–∑–≤–∏—â–µ–º, –ø–æ—Å–∞–¥–æ—é —ñ –¥–∞—Ç–æ—é,
* ‚úÖ –∞–±–æ –ø–∏—à–µ *"–ù–µ –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–æ"* —ñ–∑ —Å—ñ—Ä–æ—é —ñ–∫–æ–Ω–∫–æ—é.

---

### üîπ **SQL-—Ñ—Ä–∞–≥–º–µ–Ω—Ç –¥–ª—è APEX Interactive Report**

> –ü—ñ–¥—Å—Ç–∞–≤ —É —Å–≤—ñ–π –æ—Å–Ω–æ–≤–Ω–∏–π SQL-–∑–∞–ø–∏—Ç (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤ `SELECT ... FROM TASKS t`) —Ü–µ–π –≤–∏—Ä–∞–∑:

```sql
(
  CASE
    WHEN :P_SUBSTITUTION_MODE = 0 THEN
      CASE 
        WHEN NVL(:P_CUR_SHIFT, '0') = '0' THEN
          (
            SELECT 
              '<span class="fa fa-check-circle text-success" title="–û–∑–Ω–∞–π–æ–º–ª–µ–Ω–æ"></span> ' ||
              (us.FAMILIA || ' ' || substr(us.IMYA, 1, 1) || '. ' || substr(us.OTCHESTVO, 1, 1) || '.') || ', ' ||
              us.SPR_DOLZNOST || ', ' || us.TSEH || 
              ' (' || TO_CHAR(MAX(tv.DATE_VIEWED), 'DD.MM.YYYY HH24:MI') || ')'
            FROM TASK_VIEWED tv
            JOIN USERS us ON tv.USER_ID = us.TAB_NO AND us.PRIZNAK IS NULL
            WHERE tv.TASK_ID = t.ID 
              AND tv.USER_ID = :P_CUR_VIEWED
          )
        ELSE
          (
            SELECT 
              '<span class="fa fa-check-circle text-success" title="–û–∑–Ω–∞–π–æ–º–ª–µ–Ω–æ"></span> ' ||
              (us.FAMILIA || ' ' || substr(us.IMYA, 1, 1) || '. ' || substr(us.OTCHESTVO, 1, 1) || '.') || ', ' ||
              us.SPR_DOLZNOST || ', ' || us.TSEH || 
              ' (' || TO_CHAR(tv.DATE_VIEWED, 'DD.MM.YYYY HH24:MI') || ')'
            FROM TASK_VIEWED tv
            JOIN USERS us ON tv.USER_ID = us.TAB_NO AND us.PRIZNAK IS NULL
            WHERE tv.TASK_ID = t.ID 
              AND tv.USER_ID = :P_CUR_VIEWED
              AND tv.DATE_VIEWED BETWEEN TO_DATE(:P_START_SHIFT, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(:P_END_SHIFT, 'YYYY-MM-DD HH24:MI:SS')
            FETCH FIRST ROW ONLY
          )
      END

    WHEN :P_SUBSTITUTION_MODE = 1 THEN
      CASE 
        WHEN NVL(:P_NEW_SHIFT, '0') = '0' THEN
          (
            SELECT 
              '<span class="fa fa-check-circle text-success" title="–û–∑–Ω–∞–π–æ–º–ª–µ–Ω–æ"></span> ' ||
              (us.FAMILIA || ' ' || substr(us.IMYA, 1, 1) || '. ' || substr(us.OTCHESTVO, 1, 1) || '.') || ', ' ||
              us.SPR_DOLZNOST || ', ' || us.TSEH || 
              ' (' || TO_CHAR(MAX(tv.DATE_VIEWED), 'DD.MM.YYYY HH24:MI') || ')'
            FROM TASK_VIEWED tv
            JOIN USERS us ON tv.USER_ID = us.TAB_NO AND us.PRIZNAK IS NULL
            WHERE tv.TASK_ID = t.ID 
              AND tv.USER_ID = :P_NEW_VIEWED
          )
        ELSE
          (
            SELECT 
              '<span class="fa fa-check-circle text-success" title="–û–∑–Ω–∞–π–æ–º–ª–µ–Ω–æ"></span> ' ||
              (us.FAMILIA || ' ' || substr(us.IMYA, 1, 1) || '. ' || substr(us.OTCHESTVO, 1, 1) || '.') || ', ' ||
              us.SPR_DOLZNOST || ', ' || us.TSEH || 
              ' (' || TO_CHAR(tv.DATE_VIEWED, 'DD.MM.YYYY HH24:MI') || ')'
            FROM TASK_VIEWED tv
            JOIN USERS us ON tv.USER_ID = us.TAB_NO AND us.PRIZNAK IS NULL
            WHERE tv.TASK_ID = t.ID 
              AND tv.USER_ID = :P_NEW_VIEWED
              AND tv.DATE_VIEWED BETWEEN TO_DATE(:P_START_SHIFT, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(:P_END_SHIFT, 'YYYY-MM-DD HH24:MI:SS')
            FETCH FIRST ROW ONLY
          )
      END
    ELSE
      '<span class="fa fa-circle text-muted" title="–ù–µ –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–æ"></span> –ù–µ –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–æ'
  END
) AS VIEWED_STATUS
```

---

### üîπ **–£ APEX:**

* –î–ª—è –∫–æ–ª–æ–Ω–∫–∏ `VIEWED_STATUS`:

  * **Escape Special Characters** = `No`.
  * –ú–æ–∂–Ω–∞ –∑–∞—Ö–æ–≤–∞—Ç–∏ –∫–æ–ª–æ–Ω–∫—É `VIEWED_BY`, —è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—à `VIEWED_STATUS`.

---

### üîπ **CSS-–æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è (—è–∫—â–æ —Ç—Ä–µ–±–∞ —Ç–æ–Ω—à—ñ —Å—Ç–∏–ª—ñ)**

–Ø–∫—â–æ —Ö–æ—á–µ—à –¥–æ–¥–∞—Ç–∏ —Å—Ç–∏–ª—ñ –∞–±–æ –∑—Ä–æ–±–∏—Ç–∏ –ø—ñ–∫—Ç–æ–≥—Ä–∞–º—É –±—ñ–ª—å—à—É:

```css
.fa-check-circle.text-success {
  color: #28a745;
  font-size: 1.2em;
}

.fa-circle.text-muted {
  color: #6c757d;
  font-size: 1.2em;
}
```

---

üîî –•–æ—á–µ—à —â–µ –¥–æ–¥–∞—Ç–∫–æ–≤—É –∫–æ–ª–æ–Ω–∫—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ª–∏—à–µ –∑ –ø—ñ–∫—Ç–æ–≥—Ä–∞–º–æ—é (`VIEWED_ICON`), —â–æ–± –º–∞—Ç–∏ –≤—ñ–∑—É–∞–ª—å–Ω–µ –ø–æ–ª–µ –ø–æ—Ä—è–¥ —ñ–∑ —Ç–µ–∫—Å—Ç–æ–º?
