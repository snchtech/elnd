–î–ª—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ü—å–æ–≥–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ `P0` –≤ Oracle APEX, —Ç–∏ –º–æ–∂–µ—à –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ **PL/SQL Dynamic Action** –∞–±–æ **Before Header Process**, —è–∫–∏–π –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –∑–Ω–∞—á–µ–Ω–Ω—è item'—ñ–≤ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –∑–∞–º—ñ—â–µ–Ω–Ω—è.

---

## üî∂ –ü—Ä–∏–ø—É—â–µ–Ω–Ω—è –ø—Ä–æ item'–∏:

* `P0_UCHASTOK` ‚Äî –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
* `P0_KATEGORIA_OTIZ` ‚Äî –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
* `P0_NEW_UCHASTOK` ‚Äî –¥–ª—è –∑–∞–º—ñ—â–µ–Ω–æ–≥–æ
* `P0_NEW_KATEGORIA_OTIZ` ‚Äî –¥–ª—è –∑–∞–º—ñ—â–µ–Ω–æ–≥–æ
* `P0_SUBSTITUTION_MODE` ‚Äî 1, —è–∫—â–æ —î –∑–∞–º—ñ—â–µ–Ω–Ω—è
* `P0_SUBSTITUTION_USER_ID` ‚Äî ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–æ–≥–æ –∑–∞–º—ñ—â–∞—é—Ç—å
* `P0_USER_ID` ‚Äî ID –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

---

## ‚úÖ PL/SQL –∫–æ–¥ (–≤ –ø—Ä–æ—Ü–µ—Å—ñ –∞–±–æ –¥–∏–Ω–∞–º—ñ—á–Ω—ñ–π –¥—ñ—ó):

```plsql
DECLARE
    l_uchastok          USERS.UCHASTOK%TYPE;
    l_kategoria_otiz    USERS.KATEGORIA_OTIZ%TYPE;
BEGIN
    -- –î–∞–Ω—ñ –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    SELECT UCHASTOK, KATEGORIA_OTIZ
    INTO l_uchastok, l_kategoria_otiz
    FROM USERS
    WHERE ID = :P0_USER_ID;

    :P0_UCHASTOK := l_uchastok;
    :P0_KATEGORIA_OTIZ := l_kategoria_otiz;

    -- –Ø–∫—â–æ —î –∑–∞–º—ñ—â–µ–Ω–Ω—è
    IF :P0_SUBSTITUTION_MODE = '1' AND :P0_SUBSTITUTION_USER_ID IS NOT NULL THEN
        BEGIN
            SELECT UCHASTOK, KATEGORIA_OTIZ
            INTO l_uchastok, l_kategoria_otiz
            FROM USERS
            WHERE ID = :P0_SUBSTITUTION_USER_ID;

            -- –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —î USER_ID (—Ç–æ–±—Ç–æ, —á–∏ –≤–∫–∞–∑–∞–Ω–æ uchastok)
            IF :P0_SUBSTITUTION_USER_ID IS NOT NULL THEN
                :P0_NEW_UCHASTOK := l_uchastok;
            END IF;

            :P0_NEW_KATEGORIA_OTIZ := l_kategoria_otiz;
        EXCEPTION
            WHEN NO_DATA_FOUND THEN
                NULL; -- –Ω—ñ—á–æ–≥–æ –Ω–µ –æ–Ω–æ–≤–ª—é—î–º–æ
        END;
    END IF;
END;
```

---

## üîÑ –î–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏:

* üîπ **Before Header** ‚Üí –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
* üîπ –∞–±–æ Dynamic Action ‚Üí `Page Load ‚Üí Execute PL/SQL Code`

---

## üîç –î–æ–¥–∞—Ç–∫–æ–≤–æ:

–Ø–∫—â–æ —Ç–∏ —Ö–æ—á–µ—à –¥–∏–Ω–∞–º—ñ—á–Ω–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ `P0_SUBSTITUTION_MODE`, –∑—Ä–æ–±–∏ **Dynamic Action:**

* Event: `Change` on `P0_SUBSTITUTION_MODE`
* True Action: `Execute PL/SQL` (—Ü–µ–π –∂–µ –∫–æ–¥)
* Affected Items: `P0_NEW_UCHASTOK`, `P0_NEW_KATEGORIA_OTIZ`

---

–•–æ—á–µ—à ‚Äî –º–æ–∂—É –Ω–∞–ø–∏—Å–∞—Ç–∏ –æ–∫—Ä–µ–º—ñ `SELECT` –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ `APEX_UTIL.SET_SESSION_STATE`, —è–∫—â–æ —Ç—Ä–µ–±–∞ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–æ–≤—à–µ.
