–î—É–∂–µ —Ö–æ—Ä–æ—à–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è, –¥—è–∫—É—é. –°—É–¥—è—á–∏ –∑ –æ–ø–∏—Å—É —ñ –∫–æ–¥—É, –ø—Ä–∏—á–∏–Ω–∞, —á–æ–º—É –∫–æ–ª–µ–∫—Ü—ñ—è `CONFIRM_CART_{stage_id}_{substage_id}` —ñ–Ω–æ–¥—ñ –ø–æ—Ä–æ–∂–Ω—è, –Ω–∞–π—ñ–º–æ–≤—ñ—Ä–Ω—ñ—à–µ –ø–æ–≤‚Äô—è–∑–∞–Ω–∞ –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ –º–æ–∂–ª–∏–≤–∏–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏:

---

### ‚úÖ **1. `l_query` —Ñ–æ—Ä–º—É—î—Ç—å—Å—è –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–æ**

–£ –≤–∞—à–æ–º—É –∫–æ–¥—ñ —î –∫—ñ–ª—å–∫–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫ —É —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—ñ `l_query`, —è–∫—ñ –º–æ–∂—É—Ç—å –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —Ç–æ–≥–æ, —â–æ `APEX_COLLECTION.CREATE_COLLECTION_FROM_QUERY` —Å—Ç–≤–æ—Ä—é—î –∫–æ–ª–µ–∫—Ü—ñ—é –±–µ–∑ –∂–æ–¥–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É.

#### üîç **–ü—Ä–∏–∫–ª–∞–¥–∏ –ø–æ–º–∏–ª–æ–∫:**

* –í —Ü—å–æ–º—É —Ä—è–¥–∫—É:

  ```sql
  WHERE sr.TASK_ID = '|| l_source_id ||
  ```

  –∑–Ω–∞—á–µ–Ω–Ω—è `l_source_id` –≤—Å—Ç–∞–≤–ª—è—î—Ç—å—Å—è –≤ SQL –±–µ–∑ `'` (–æ–¥–∏–Ω–∞—Ä–Ω–∏—Ö –ª–∞–ø–æ–∫) –¥–ª—è —Ä—è–¥–∫–æ–≤–æ–≥–æ —Ç–∏–ø—É –∞–±–æ `TO_NUMBER` –¥–ª—è —á–∏—Å–ª–æ–≤–æ–≥–æ, —Ç–æ–º—É –∑–∞–ø–∏—Ç –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–º –∞–±–æ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ 0 —Ä—è–¥–∫—ñ–≤.

* –í —Ü—å–æ–º—É —Ä—è–¥–∫—É:

  ```sql
  sr.TASK_ID
  sr.USER_TABNO,
  sr.POSITION_ID
  sr.DEPARTMENT_ID,
  ```

  –≤—ñ–¥—Å—É—Ç–Ω—ñ **–∫–æ–º–∏** –º—ñ–∂ –ø–æ–ª—è–º–∏ ‚Üí —Ü–µ –ø–æ–º–∏–ª–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É, —á–µ—Ä–µ–∑ —è–∫—É `CREATE_COLLECTION_FROM_QUERY` –Ω—ñ—á–æ–≥–æ –Ω–µ —Å—Ç–≤–æ—Ä—é—î (–∞–±–æ –º–æ–∂–µ –Ω–µ –≤–∏–∫–æ–Ω–∞—Ç–∏—Å—å, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, —á–∏ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è SQL —è–∫ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π).

#### ‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**:

–ü–µ—Ä–µ–¥ –≤–∏–∫–ª–∏–∫–æ–º `CREATE_COLLECTION_FROM_QUERY` –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ –≤–∏–≤–æ–¥—å—Ç–µ `l_query` —É `apex_debug` –∞–±–æ —á–µ—Ä–µ–∑ `apex_error.log_error`.

```plsql
apex_debug.message('QUERY: %s', l_query);
```

---

### ‚úÖ **2. `sr.STAGES_ID = l_substage_id` –Ω–µ –¥–∞—î –∑–±—ñ–≥—ñ–≤**

–ú–æ–∂–ª–∏–≤–æ, –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ `TASK_ID` —ñ `l_substage_id` —É —Ç–∞–±–ª–∏—Ü—ñ `SIGNATURERIGHTS` –ø—Ä–æ—Å—Ç–æ –Ω–µ–º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö –∑–∞–ø–∏—Å—ñ–≤. –•–æ—á–∞ –≤ –ë–î —î 3 –∑–∞–ø–∏—Å–∏ –∑–∞–≥–∞–ª–æ–º, –¥–ª—è —Ü—å–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—ñ–¥–µ—Ç–∞–ø—É (`l_substage_id`) ‚Äî 0.

#### ‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**:

–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—Ä—É—á–Ω—É:

```sql
SELECT * 
FROM SIGNATURERIGHTS@TO_TASKTRACKER10 
WHERE TASK_ID = :P5_TASK_ID 
  AND STAGES_ID = :l_substage_id;
```

---

### ‚úÖ **3. `STAGES_ID = l_substage_id` ‚Äì —Ç–∏–ø–∏ –Ω–µ –∑–±—ñ–≥–∞—é—Ç—å—Å—è**

–Ø–∫—â–æ `l_substage_id` –º–∞—î —Ç–∏–ø `NUMBER`, –∞ `sr.STAGES_ID` –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —è–∫ `VARCHAR2` (–∞–±–æ –Ω–∞–≤–ø–∞–∫–∏), —Ç–æ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –Ω–µ —Å–ø—Ä–∞—Ü—é—î.

#### ‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**:

–ü—Ä–∏–≤–µ–¥—ñ—Ç—å —Ç–∏–ø–∏ —è–≤–Ω–æ:

```sql
AND TO_NUMBER(sr.STAGES_ID) = l_substage_id
-- –∞–±–æ —è–∫—â–æ –Ω–∞–≤–ø–∞–∫–∏:
AND sr.STAGES_ID = TO_CHAR(l_substage_id)
```

---

### ‚úÖ **4. –ü–æ–º–∏–ª–∫–∞ –≤ `CREATE_COLLECTION_FROM_QUERY` –Ω–µ –ª–æ–≤–∏—Ç—å—Å—è**

–ú–µ—Ç–æ–¥ `CREATE_COLLECTION_FROM_QUERY` –Ω–µ –∫–∏–¥–∞—î –ø–æ–º–∏–ª–∫–∏ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É —Å–µ–Ω—Å—ñ, –∞–ª–µ —è–∫—â–æ `l_query` –º–∞—î –ø–æ–º–∏–ª–∫—É ‚Äî –∫–æ–ª–µ–∫—Ü—ñ—è —Å—Ç–≤–æ—Ä–∏—Ç—å—Å—è, –∞–ª–µ –±—É–¥–µ –ø–æ—Ä–æ–∂–Ω—è.

#### ‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**:

–£–≤—ñ–º–∫–Ω—É—Ç–∏ **Debug mode**, –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ª–æ–≥:

* **APEX > App Builder > Debug > View Debug Logs**

---

### ‚úÖ **5. –ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–µ —ñ–º‚Äô—è –∫–æ–ª–µ–∫—Ü—ñ—ó**

–¶–µ–π —Ä—è–¥–æ–∫ –º—ñ—Å—Ç–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—á–Ω—É –ø–æ–º–∏–ª–∫—É:

```plsql
'CONFIRM_CART_' || l_stage_id || ._ ' || l_substage_id || ''
```

–ü—Ä–∞–≤–∏–ª—å–Ω–æ:

```plsql
'CONFIRM_CART_' || l_stage_id || '_' || l_substage_id
```

---

## üîß –†–µ–∑—é–º–µ: –©–æ –∑—Ä–æ–±–∏—Ç–∏

1. **–í–∏–≤–µ–¥—ñ—Ç—å `l_query` –≤ debug –ø–µ—Ä–µ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º –∫–æ–ª–µ–∫—Ü—ñ—ó.**
2. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ –¥–ª—è –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó `TASK_ID` + `STAGES_ID` —î –¥–∞–Ω—ñ.**
3. **–í–∏–ø—Ä–∞–≤—Ç–µ SQL: –¥—É–∂–∫–∏, –ª–∞–ø–∫–∏, –∫–æ–º–∏ ‚Äî —â–æ–± –∑–∞–ø–∏—Ç –±—É–≤ –∫–æ—Ä–µ–∫—Ç–Ω–∏–π.**
4. **–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ `STAGES_ID` —ñ `l_substage_id` –º–∞—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤–∏–π —Ç–∏–ø.**
5. **–£–≤—ñ–º–∫–Ω—ñ—Ç—å Debug Mode —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏.**

---

–Ø–∫—â–æ —Ö–æ—á–µ—Ç–µ ‚Äî –Ω–∞–¥—ñ—à–ª—ñ—Ç—å —Ç–æ—á–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –∑–Ω–∞—á–µ–Ω—å `TASK_ID`, `l_stage_id`, `l_substage_id`, —ñ –¥–∞–º –ø—Ä–∏–∫–ª–∞–¥ SQL-–∑–∞–ø–∏—Ç—É, —è–∫–∏–π –º–∞—î –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ —Ü—ñ –¥–∞–Ω—ñ.
