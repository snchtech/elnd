–ß—É–¥–æ–≤–æ, –º–∏ –≤–∂–µ –∑–≤—É–∑–∏–ª–∏ –ø—Ä–∏—á–∏–Ω—É ‚Äî **–∫–æ–ª–µ–∫—Ü—ñ—ó —Ä–µ–∞–ª—å–Ω–æ –Ω–µ–º–∞—î –≤ APEX-—Å–µ—Å—ñ—ó**, —Ö–æ—á–∞ –≤ –±–∞–∑—ñ –¥–∞–Ω—ñ —î. –¢–µ–ø–µ—Ä –¥–∞–≤–∞–π –∫—Ä–æ–∫ –∑–∞ –∫—Ä–æ–∫–æ–º –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ –Ω–∞–π–±—ñ–ª—å—à —ñ–º–æ–≤—ñ—Ä–Ω—ñ –¥–∂–µ—Ä–µ–ª–∞ –ø—Ä–æ–±–ª–µ–º–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —Ç–≤–æ–≥–æ `PL/SQL` –∫–æ–¥—É.

---

## üîé –ô–º–æ–≤—ñ—Ä–Ω—ñ –ø—Ä–∏—á–∏–Ω–∏, —á–æ–º—É –∫–æ–ª–µ–∫—Ü—ñ—è –ù–ï –∑'—è–≤–ª—è—î—Ç—å—Å—è:

---

### ‚úÖ 1. **`l_query` —Ñ–æ—Ä–º—É—î—Ç—å—Å—è –∑ –ø–æ–º–∏–ª–∫–æ—é ‚Üí CREATE\_COLLECTION\_FROM\_QUERY —Å—Ç–≤–æ—Ä—é—î –ø–æ—Ä–æ–∂–Ω—é –∫–æ–ª–µ–∫—Ü—ñ—é –∞–±–æ –Ω–µ —Å—Ç–≤–æ—Ä—é—î —ó—ó –≤–∑–∞–≥–∞–ª—ñ**

–Ø–∫—â–æ –∑–∞–ø–∏—Ç –º–∞—î:

* –ü—Ä–æ–ø—É—â–µ–Ω—ñ –∫–æ–º–∏ –º—ñ–∂ –∫–æ–ª–æ–Ω–∫–∞–º–∏
* –í—ñ–¥—Å—É—Ç–Ω—ñ–π `FROM`
* –ù–µ–∫–æ—Ä–µ–∫—Ç–Ω—ñ `'||` –∞–±–æ `|l` –≤ —Ä—è–¥–∫–∞—Ö
* –ü—Ä–æ–±–ª–µ–º–∏ –∑ –ª–∞–ø–∫–∞–º–∏ `'` ‚Üí `WHERE sr.TASK_ID = '|| l_source_id ||'` ‚Üê –º–∞—î –±—É—Ç–∏ —Ç–∞–∫!

üõ† **–©–æ –∑—Ä–æ–±–∏—Ç–∏:**
–í—Å—Ç–∞–≤ –Ω–∞—Å—Ç—É–ø–Ω–µ —É `before header` –ø—ñ—Å–ª—è —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è `l_query`:

```plsql
apex_debug.message('DEBUG QUERY = %s', l_query);
```

–ó–∞–ø—É—Å—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤ **Debug mode**, –ø–µ—Ä–µ–≥–ª—è–Ω—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî —ñ –°–ö–û–ü–Ü–Æ–ô –∑–∞–ø–∏—Ç –∑ debug –ª–æ–≥—ñ–≤ —É SQL Developer, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –≤—ñ–Ω —Ç–æ—á–Ω–æ –ø–æ–≤–µ—Ä—Ç–∞—î –∑–∞–ø–∏—Å–∏.

---

### ‚úÖ 2. **–ü—Ä–æ–±–ª–µ–º–∞ –∑ `STAGES_ID = l_substage_id`**

–¶–µ –∫–ª—é—á–æ–≤–∞ —É–º–æ–≤–∞. –Ø–∫—â–æ –Ω–∞–≤—ñ—Ç—å —É `SIGNATURERIGHTS` —î –∑–∞–ø–∏—Å–∏ –¥–ª—è `TASK_ID`, –∞–ª–µ –Ω–µ –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ `STAGES_ID`, –∫–æ–ª–µ–∫—Ü—ñ—è –±—É–¥–µ –ø–æ—Ä–æ–∂–Ω—è.

üß™ **–¢–µ—Å—Ç–æ–≤–∏–π SQL –≤—Ä—É—á–Ω—É:**

```sql
SELECT *
FROM SIGNATURERIGHTS@TO_TASKTRACKER10
WHERE TASK_ID = :your_task_id
  AND STAGES_ID = :your_substage_id;
```

–Ø–∫—â–æ —Ç—É—Ç 0 –∑–∞–ø–∏—Å—ñ–≤ ‚Äî –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ —ñ –∫–æ–ª–µ–∫—Ü—ñ—è –±—É–¥–µ –ø–æ—Ä–æ–∂–Ω—è.

---

### ‚úÖ 3. **`CREATE_COLLECTION_FROM_QUERY` –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è, –∞–ª–µ `WHERE` –¥–∞—î 0 –∑–∞–ø–∏—Å—ñ–≤**

–ù–∞–≤—ñ—Ç—å —è–∫—â–æ `l_query` —Ç–µ—Ö–Ω—ñ—á–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π, –∞–ª–µ –Ω–µ –ø–æ–≤–µ—Ä—Ç–∞—î –∂–æ–¥–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É, –∫–æ–ª–µ–∫—Ü—ñ—è —Å—Ç–≤–æ—Ä–∏—Ç—å—Å—è –∑ 0 —Ä—è–¥–∫–∞–º–∏ ‚Üí —ñ –Ω–µ –±—É–¥–µ –≤–∏–¥–Ω–æ –≤ `APEX_COLLECTIONS`.

---

### ‚úÖ 4. **–ö–æ–ª–µ–∫—Ü—ñ—è —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è, –∞–ª–µ –æ–¥—Ä–∞–∑—É –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è**

–£ —Ç–µ–±–µ —î —Ñ—Ä–∞–≥–º–µ–Ω—Ç:

```plsql
IF APEX_COLLECTION.COLLECTION_EXISTS (...) THEN
  APEX_COLLECTION.DELETE_COLLECTION(...);
```

–¶–µ–π –±–ª–æ–∫ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è **—ñ –≤ THEN, —ñ –≤ ELSE**.

üõ† **–©–æ –º–æ–∂–µ —Å—Ç–∞—Ç–∏—Å—å:**

* –Ø–∫—â–æ `sr_count = 0`, —Ç–∏ –≤–∏–¥–∞–ª—è—î—à –∫–æ–ª–µ–∫—Ü—ñ—é:

  ```plsql
  ELSE
    IF APEX_COLLECTION.COLLECTION_EXISTS (...) THEN
      APEX_COLLECTION.DELETE_COLLECTION(...);
    END IF;
  END IF;
  ```

‚û°Ô∏è –¢–æ–±—Ç–æ: —è–∫—â–æ `SIGNATURERIGHTS` –Ω–µ –º–∞—î –∑–∞–ø–∏—Å—ñ–≤ ‚Äî —Ç–∏ –≤–∏–¥–∞–ª—è—î—à –∫–æ–ª–µ–∫—Ü—ñ—é –±–µ–∑ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è.

---

## ‚úÖ –©–æ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞—Ä–∞–∑ ‚Äî –ø–ª–∞–Ω –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:

### üîπ **1. –î–æ–¥–∞–π debug-–ª–æ–≥–∏:**

–£ `before header`:

```plsql
apex_debug.message('SOURCE_ID = %s', l_source_id);
apex_debug.message('STAGE_ID = %s, SUBSTAGE_ID = %s', l_stage_id, l_substage_id);
apex_debug.message('SR_COUNT = %s', l_sr_count);
apex_debug.message('QUERY: %s', l_query);
```

### üîπ **2. –î–æ–¥–∞–π –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ñ–∞–∫—Ç—É —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–ª–µ–∫—Ü—ñ—ó:**

```plsql
IF apex_collection.collection_exists('CONFIRM_CART_' || l_stage_id || '_' || l_substage_id) THEN
  apex_debug.message('COLLECTION CREATED: CONFIRM_CART_%s_%s', l_stage_id, l_substage_id);
ELSE
  apex_debug.message('COLLECTION NOT CREATED: CONFIRM_CART_%s_%s', l_stage_id, l_substage_id);
END IF;
```

---

## üöÄ –ü—ñ—Å–ª—è —Ü–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ ‚Äî —É —Ç–µ–±–µ –±—É–¥–µ:

1. –ü–æ–≤–Ω–∏–π `query`, —è–∫–∏–π —Ä–µ–∞–ª—å–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤—Å—è.
2. –ó—Ä–æ–∑—É–º—ñ—î—à: —á–∏ –≤—ñ–Ω –ø–æ–≤–µ—Ä—Ç–∞—î –∑–∞–ø–∏—Å–∏.
3. –ß–∏ —Å—Ç–≤–æ—Ä–∏–ª–∞—Å—å –∫–æ–ª–µ–∫—Ü—ñ—è.
4. –ß–∏ –±—É–ª–∞ –æ–¥—Ä–∞–∑—É –≤–∏–¥–∞–ª–µ–Ω–∞.

---

## üí° –ê —â–µ –∫—Ä–∞—â–µ ‚Äî –¥–æ–¥–∞–π —Ç–∏–º—á–∞—Å–æ–≤—É –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É:

–°—Ç–≤–æ—Ä–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ **–æ–∫—Ä–µ–º–∏–π –∑–≤—ñ—Ç**:

```sql
SELECT collection_name, seq_id, c001, c002, c003 
FROM apex_collections
WHERE collection_name LIKE 'CONFIRM_CART%'
```

‚Üí –¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –ø–æ–±–∞—á–∏—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ, —â–æ —Ä–µ–∞–ª—å–Ω–æ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è —É —Å–µ—Å—ñ—ó –ø—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É —Å—Ç–æ—Ä—ñ–Ω–∫–∏.

---

üîî –Ø–∫—â–æ —Å–∫–∏–Ω–µ—à —Ç–æ—á–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –∑–Ω–∞—á–µ–Ω–Ω—è `TASK_ID` —ñ –æ—á—ñ–∫—É–≤–∞–Ω—É –Ω–∞–∑–≤—É –∫–æ–ª–µ–∫—Ü—ñ—ó (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `CONFIRM_CART_2_5`) ‚Äî —è –∑–º–æ–∂—É –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–æ–±—ñ –ø–æ–≤–Ω—É –ª–æ–≥—ñ–∫—É —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è —ñ–º–µ–Ω—ñ + –∑–∞–ø–∏—Ç—É.
