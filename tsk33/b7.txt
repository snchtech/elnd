–ß—É–¥–æ–≤–æ, –∑–∞—Ä–∞–∑ –ø–æ–∫–∞–∂—É –ø–æ–≤–Ω—É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é –≤–∞—Ä—ñ–∞–Ω—Ç—É –∑ —Ç–∏–º—á–∞—Å–æ–≤–æ—é —Ç–∞–±–ª–∏—Ü–µ—é `TMP_SUBTASKS`, —è–∫—É —Ç–∏ –º–æ–∂–µ—à –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è **—à–≤–∏–¥–∫–æ–≥–æ –º–∞—Å–æ–≤–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö** —É APEX Collection —á–µ—Ä–µ–∑ `APEX_COLLECTION.CREATE_COLLECTION_FROM_QUERY`.

---

## ‚úÖ **–ö—Ä–æ–∫ 1: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∏–º—á–∞—Å–æ–≤–æ—ó —Ç–∞–±–ª–∏—Ü—ñ**

### üîπ –°—Ç–≤–æ—Ä—é—î–º–æ Global Temporary Table (GTT):

```sql
CREATE GLOBAL TEMPORARY TABLE TMP_SUBTASKS (
  TASK_ID           NUMBER,
  SUBTASK_CONTENT   VARCHAR2(4000),
  PLANNING_DATE_END DATE,
  PARENT_ID         NUMBER,
  SUBTASK_ORDER     NUMBER,
  STATUS_ID         NUMBER,
  SUBTASK_ID        NUMBER,
  MODE_ID           NUMBER
)
ON COMMIT DELETE ROWS;
```

> üîÑ `ON COMMIT DELETE ROWS` ‚Äî –¥–∞–Ω—ñ –æ—á–∏—â–∞—é—Ç—å—Å—è –ø—ñ—Å–ª—è `COMMIT`. –Ø–∫—â–æ —Ö–æ—á–µ—à –≤—Ä—É—á–Ω—É ‚Äî –∑–∞–º—ñ–Ω–∏ –Ω–∞ `PRESERVE ROWS`.

---

## ‚úÖ **–ö—Ä–æ–∫ 2: –ù–∞–ø–æ–≤–Ω–µ–Ω–Ω—è —Ç–∏–º—á–∞—Å–æ–≤–æ—ó —Ç–∞–±–ª–∏—Ü—ñ**

### üîπ PL/SQL –±–ª–æ–∫:

```plsql
BEGIN
  -- –û—á–∏—â–µ–Ω–Ω—è –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ—é (–Ω–µ –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ, —è–∫—â–æ ON COMMIT DELETE ROWS)
  DELETE FROM TMP_SUBTASKS;

  -- –ú–∞—Å–æ–≤–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å
  INSERT /*+ APPEND */ INTO TMP_SUBTASKS (
    TASK_ID,
    SUBTASK_CONTENT,
    PLANNING_DATE_END,
    PARENT_ID,
    SUBTASK_ORDER,
    STATUS_ID,
    SUBTASK_ID,
    MODE_ID
  )
  SELECT
    TASK_ID,
    SUBTASK_CONTENT,
    PLANNING_DATE_END,
    PARENT_ID,
    SUBTASK_ORDER,
    STATUS_ID,
    ID AS SUBTASK_ID,
    0 AS MODE_ID -- –∞–±–æ 1 –¥–ª—è —à–∞–±–ª–æ–Ω—É
  FROM TaskTracker.TASK_SUBTASKS@TO_TASKTRACKER10
  WHERE TASK_ID = :P6_TASK_ID;
END;
```

> ‚ö†Ô∏è `/*+ APPEND */` –ø—Ä–∏—à–≤–∏–¥—à—É—î –≤—Å—Ç–∞–≤–∫—É, –∞–ª–µ –ø—Ä–∞—Ü—é—î –ª–∏—à–µ –∑ **DIRECT PATH** —ñ –ø–æ—Ç—Ä–µ–±—É—î `COMMIT` –ø—ñ—Å–ª—è –≤—Å—Ç–∞–≤–∫–∏.

---

## ‚úÖ **–ö—Ä–æ–∫ 3: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è APEX\_COLLECTION —ñ–∑ —Ç–∞–±–ª–∏—Ü—ñ**

### üîπ PL/SQL –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–ª–µ–∫—Ü—ñ—ó:

```plsql
BEGIN
  IF APEX_COLLECTION.COLLECTION_EXISTS('TASK_SUBTASKS_COLLECTION') THEN
    APEX_COLLECTION.DELETE_COLLECTION('TASK_SUBTASKS_COLLECTION');
  END IF;

  APEX_COLLECTION.CREATE_COLLECTION_FROM_QUERY(
    p_collection_name => 'TASK_SUBTASKS_COLLECTION',
    p_query => '
      SELECT
        TASK_ID        AS c001,
        SUBTASK_CONTENT AS c002,
        PLANNING_DATE_END AS d001,
        PARENT_ID      AS c003,
        SUBTASK_ORDER  AS c004,
        STATUS_ID      AS c005,
        SYSDATE        AS d002,
        NULL           AS d003,
        :P0_CUR_USER_TABNO AS c006,
        NULL           AS c007,
        SUBTASK_ID     AS c009,
        MODE_ID        AS n001
      FROM TMP_SUBTASKS
    ',
    p_generate_md5 => 'YES'
  );
END;
```

> üîÅ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏, —è–∫—ñ —î –≤ –∑–∞–ø–∏—Ç—ñ (`:P0_CUR_USER_TABNO`), –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ **–≤ `Page Items to Submit`** —è–∫—â–æ —Ü–µ —Ä–æ–±–∏—Ç—å—Å—è –∑ AJAX –∞–±–æ DA.

---

## ‚úÖ **–ö—Ä–æ–∫ 4: –û—á–∏—Å—Ç–∫–∞ —Ç–∏–º—á–∞—Å–æ–≤–æ—ó —Ç–∞–±–ª–∏—Ü—ñ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)**

* –Ø–∫—â–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ –∑ `ON COMMIT DELETE ROWS` ‚Äî –æ—á–∏—â–∞—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
* –Ø–∫—â–æ `PRESERVE ROWS` ‚Äî —Ç–æ–¥—ñ –æ—á–∏—â–∞–π –≤—Ä—É—á–Ω—É:

```plsql
DELETE FROM TMP_SUBTASKS;
COMMIT;
```

---

## üîç –ö–æ–ª–∏ —Ü–µ –¥–∞—î –≤–∏–≥–æ–¥—É?

| –û–±—Å—è–≥ –∑–∞–ø–∏—Å—ñ–≤ | `FOR LOOP` + `ADD_MEMBER` | GTT + `CREATE_COLLECTION_FROM_QUERY` |
| ------------- | ------------------------- | ------------------------------------ |
| < 100         | —à–≤–∏–¥–∫–æ                    | —Å–∫–ª–∞–¥–Ω—ñ—à–µ, –±–µ–∑ –≤–∏–≥—Ä–∞—à—É               |
| 100‚Äì1000      | –Ω–æ—Ä–º                      | —à–≤–∏–¥—à–µ                               |
| > 1000        | –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≤—ñ–ª—å–Ω–æ        | –∑–Ω–∞—á–Ω–æ —à–≤–∏–¥—à–µ                        |

---

## üìå –ü—ñ–¥—Å—É–º–æ–∫:

* ‚úÖ –¢–∏–º—á–∞—Å–æ–≤–∞ —Ç–∞–±–ª–∏—Ü—è –∑–±–µ—Ä—ñ–≥–∞—î –º–∞—Å–∏–≤ –¥–∞–Ω–∏—Ö, –æ—Ç—Ä–∏–º–∞–Ω–∏—Ö —à–≤–∏–¥–∫–æ —á–µ—Ä–µ–∑ SQL
* ‚úÖ `CREATE_COLLECTION_FROM_QUERY` –¥–æ–∑–≤–æ–ª—è—î —ñ–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –≤—Å–µ –æ–¥—Ä–∞–∑—É
* ‚úÖ –í–∏–∫–ª—é—á–∞—î –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å `FOR LOOP` —ñ –≤–∏–∫–ª–∏–∫—ñ–≤ `ADD_MEMBER` —É —Ü–∏–∫–ª—ñ
* ‚úÖ –û—á–∏—Å—Ç–∫–∞ GTT –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ (—è–∫—â–æ `ON COMMIT DELETE ROWS`)

---

üîî –•–æ—á–µ—à ‚Äî —è –º–æ–∂—É —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–∞–∫–µ—Ç (PL/SQL procedure) –∞–±–æ AJAX-–ø—Ä–æ—Ü–µ—Å, —è–∫–∏–π –≤—Å–µ —Ü–µ –æ–±‚Äô—î–¥–Ω—É—î.
