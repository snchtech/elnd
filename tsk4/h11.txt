–î—É–∂–µ —Å–ª—É—à–Ω–µ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è! üëá  
–¢–∏ —Ä–æ–∑–≥–ª—è–¥–∞—î—à **–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É `DRAFT_ID`** ‚Äî –æ–¥—Ä–∞–∑—É —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ **–ø–æ—Ä–æ–∂–Ω—ñ–π –∑–∞–ø–∏—Å —É `TASKS`**, –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ `TASK_ID`, —ñ –∑ –Ω–∏–º —É–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ (–¥–æ–¥–∞–≤–∞—Ç–∏ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è, –∑–∞–ø–æ–≤–Ω—é–≤–∞—Ç–∏ —Ñ–æ—Ä–º—É).

---

## ‚úÖ –¢–∞–∫–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥—ñ–π—Å–Ω–æ –ø–æ–ø—É–ª—è—Ä–Ω–∏–π, —ñ –º–∞—î —Å–≤–æ—é –Ω–∞–∑–≤—É:
> **"Insert Early, Update Later" pattern**  
> (–°–ø–æ—á–∞—Ç–∫—É –≤—Å—Ç–∞–≤–∏—Ç–∏ ¬´—á–µ—Ä–Ω–µ—Ç–∫—É¬ª, –ø–æ—Ç—ñ–º –ø–æ—Å—Ç—É–ø–æ–≤–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏)

---

## üìä –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –¥–≤–æ—Ö –ø—ñ–¥—Ö–æ–¥—ñ–≤

| –ö—Ä–∏—Ç–µ—Ä—ñ–π                          | `DRAFT_ID` (—Ç–∏–º—á–∞—Å–æ–≤–æ)               | `TASK_ID` –æ–¥—Ä–∞–∑—É (—á–µ—Ä–Ω–µ—Ç–∫–∞ –≤ TASKS)     |
|----------------------------------|--------------------------------------|------------------------------------------|
| üîÑ –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á–∞                | –£ APEX: `SYS_GUID()` –∞–±–æ UUID        | –ß–µ—Ä–µ–∑ `INSERT RETURNING` –≤ `TASKS`       |
| üì¶ –î–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —á–µ—Ä–Ω–µ—Ç–∫–∞       | –í `TASK_SUBTASKS.DRAFT_ID`           | –£ —Ç–∞–±–ª–∏—Ü—ñ `TASKS`                         |
| üîê –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å rollback            | ‚úÖ –ù—ñ—á–æ–≥–æ –Ω–µ –≤—Å—Ç–∞–≤–ª—è—î—Ç—å—Å—è –¥–æ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è ¬´–ó–±–µ—Ä–µ–≥—Ç–∏¬ª | ‚ùå –ó–∞–ø–∏—Å –∑‚Äô—è–≤–ª—è—î—Ç—å—Å—è –æ–¥—Ä–∞–∑—É           |
| üßº –ü–æ—Ç—Ä–µ–±—É—î –æ—á–∏—â–µ–Ω–Ω—è              | ‚ùå –ù–µ–æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ                      | ‚úÖ –¢–∞–∫ (—ñ–Ω–∞–∫—à–µ –ë–î –∑–∞—Å–º—ñ—á—É—î—Ç—å—Å—è —á–µ—Ä–Ω–µ—Ç–∫–∞–º–∏) |
| üîÑ –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∑–≤‚Äô—è–∑–∫—É –∑ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è–º–∏ | üß† –ü–æ—Ç—Ä—ñ–±–µ–Ω –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –∑–≤‚Äô—è–∑–æ–∫ —á–µ—Ä–µ–∑ `DRAFT_ID` | ‚úÖ –ü—Ä—è–º–∏–π –∑–≤‚Äô—è–∑–æ–∫ —á–µ—Ä–µ–∑ `TASK_ID`     |
| üîç –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∑–º—ñ–Ω               | –°–∫–ª–∞–¥–Ω—ñ—à–µ                            | ‚úÖ –ú–æ–∂–Ω–∞ –ª–æ–≥—É–≤–∞—Ç–∏ –∑ —Å–∞–º–æ–≥–æ –ø–æ—á–∞—Ç–∫—É        |
| üìö –ü–æ–ø—É–ª—è—Ä–Ω—ñ—Å—Ç—å                  | üîº –í APEX –¥—É–∂–µ –ø–æ–ø—É–ª—è—Ä–Ω–∏–π             | üîº –í —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–∏—Ö CRUD —Å–∏—Å—Ç–µ–º–∞—Ö ‚Äî —Ç–∞–∫–æ–∂    |

---

## üß† –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –∑ –ø—Ä–∞–∫—Ç–∏–∫–∏:

### ‚úÖ –í —è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –∫—Ä–∞—â–µ `DRAFT_ID`:
- –Ø–∫—â–æ **"–ó–±–µ—Ä–µ–≥—Ç–∏" ‚Äî —Ü–µ —Å–µ—Ä–π–æ–∑–Ω–∏–π commit**, —ñ –Ω–µ —Ö–æ—á–µ—à –∑–∞–ª–∏—à–∫—ñ–≤ —É `TASKS`, —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—ñ–¥–º—ñ–Ω–∏–≤.
- –Ø–∫—â–æ **—Ñ–æ—Ä–º–∞ –¥–æ–≤–≥–∞**, —ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –ø–µ—Ä–µ–¥—É–º–∞—Ç–∏.

### ‚úÖ –ö–æ–ª–∏ –∫—Ä–∞—â–µ `TASK_ID –æ–¥—Ä–∞–∑—É`:
- –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –Ω–æ–º–µ—Ä—ñ–≤/—ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—ñ–≤**.
- –Ø–∫—â–æ –∑ —Å–∞–º–æ–≥–æ –ø–æ—á–∞—Ç–∫—É –º–∞—î –±—É—Ç–∏ **–ª–æ–≥—ñ–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É, –∑–≤‚Äô—è–∑–∫—ñ–≤, –ø—Ä–∞–≤**, —Ç–æ –∫—Ä–∞—â–µ –º–∞—Ç–∏ `TASK_ID`.
- –Ø–∫—â–æ —Ö–æ—á–µ—à —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **—á–µ—Ä–Ω–µ—Ç–∫–∏ / –∞–≤—Ç–æ–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è / —Ä–æ–±–æ—Ç—É –∑ —á–µ—Ä–Ω–µ—Ç–∫–∞–º–∏** ‚Äî —ñ–¥–µ–∞–ª—å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç.

---

## ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ —Ä–∏–∑–∏–∫–∏ –≤—Å—Ç–∞–≤–∫–∏ –æ–¥—Ä–∞–∑—É:

| ‚ö† –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏–∫–ª–∞–¥ |
|------------|---------|
| üìà –°–º—ñ—Ç—Ç—è –≤ —Ç–∞–±–ª–∏—Ü—ñ | –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—ñ–¥–∫—Ä–∏–≤ —Ñ–æ—Ä–º—É —ñ –∑–∞–∫—Ä–∏–≤ —ó—ó ‚Üí task –∑–∞–ª–∏—à–∏–≤—Å—è –ø—É—Å—Ç–∏–º |
| üßº –ù–µ–æ—á–∏—â–µ–Ω—ñ —á–µ—Ä–Ω–µ—Ç–∫–∏ | –ü–æ—Ç—Ä—ñ–±–µ–Ω cleanup job –∞–±–æ –¥–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è + –∞–≤—Ç–æ–∞—Ä—Ö—ñ–≤ |

---

## ‚úÖ –í–∏—Å–Ω–æ–≤–æ–∫:

| –Ø–∫—â–æ —Ç–æ–±—ñ –ø–æ—Ç—Ä—ñ–±–Ω–∞...                         | –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π... |
|-----------------------------------------------|-----------------|
| –ß–∏—Å—Ç–æ—Ç–∞ –ë–î, –≤—ñ–¥–∫–ª–∞–¥–µ–Ω–∞ –≤—Å—Ç–∞–≤–∫–∞                 | `DRAFT_ID`      |
| –†–æ–±–æ—Ç–∞ –∑ —á–µ—Ä–Ω–µ—Ç–∫–∞–º–∏, –ª–æ–≥—É–≤–∞–Ω–Ω—è, –∞–≤—Ç–æ–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è | `TASK_ID –æ–¥—Ä–∞–∑—É`|

---

## üîß –Ø–∫—â–æ –æ–±—Ä–∞—Ç–∏ –≤–∞—Ä—ñ–∞–Ω—Ç –∑ `TASK_ID` –æ–¥—Ä–∞–∑—É:

1. –ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è" ‚Äî —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∑–∞–ø–∏—Å —É `TASKS`, –æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è `ID`.
2. –ó–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —É `PXX_TASK_ID`.
3. –£—Å—ñ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è –π–¥—É—Ç—å –æ–¥—Ä–∞–∑—É –∑ —Ü–∏–º `TASK_ID`.
4. –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–∫–∞—î ¬´–°–∫–∞—Å—É–≤–∞—Ç–∏¬ª:
   ```plsql
   DELETE FROM TASKS WHERE ID = :PXX_TASK_ID AND (SELECT COUNT(*) FROM TASK_SUBTASKS WHERE TASK_ID = :PXX_TASK_ID) = 0;
   ```

---

üîß –•–æ—á–µ—à –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –æ–±–∏–¥–≤–∞ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ ‚Äî –º–æ–∂—É –¥–æ–ø–æ–º–æ–≥—Ç–∏ —Ç–æ–±—ñ –∑—Ä–æ–±–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤ APEX, —è–∫–∞ –ø–µ—Ä–µ–º–∏–∫–∞—î—Ç—å—Å—è –º—ñ–∂ `DRAFT_ID`/`TASK_ID` —Ä–µ–∂–∏–º–∞–º–∏ (debug-mode style).

–•–æ—á–µ—à –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –∑ DRAFT_ID, —á–∏ —Ö–æ—á–µ—à —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∞—Ä—ñ–∞–Ω—Ç —ñ–∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—è–º —É TASKS?