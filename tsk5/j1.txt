–¢–∞–∫, —Ç–≤—ñ–π –ø—ñ–¥—Ö—ñ–¥ —Ü—ñ–ª–∫–æ–º –ª–æ–≥—ñ—á–Ω–∏–π, —ñ –∑–∞—Ä–∞–∑ –¥–µ—Ç–∞–ª—å–Ω–æ –ø–æ—è—Å–Ω—é —è–∫ –∫—Ä–∞—â–µ –æ—Ä–≥–∞–Ω—ñ–∑—É–≤–∞—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è –≤ **–æ–¥–Ω—ñ–π —Ñ–æ—Ä–º—ñ**, –∞–ª–µ –∑ –ª–æ–≥—ñ–∫–æ—é, —è–∫–∞ **—Ä–æ–∑–≥–∞–ª—É–∂—É—î—Ç—å—Å—è –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ä–µ–∂–∏–º—É** (`STANDARD` / `PERIODIC`), + –Ω–∞–¥–∞–º **–≥–æ—Ç–æ–≤–∏–π PL/SQL –∫–æ–¥ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω—É**.

---

## ‚úÖ –í—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ —Ç–≤–æ—ó –∑–∞–ø–∏—Ç–∞–Ω–Ω—è:

### üîπ1. –©–æ –∑ –ø–æ–ª—è–º–∏ `IS_GENERATED`, `GENERATED_DATE`, `TEMPLATE_ID`?

–¢–∞–∫, –¥–ª—è **–∑–≤–∏—á–∞–π–Ω–æ–≥–æ (—Ä—É—á–Ω–æ–≥–æ)** —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å —Ü—ñ –ø–æ–ª—è:
- `IS_GENERATED` ‚Üí `'N'`
- `GENERATED_DATE`, `TEMPLATE_ID` ‚Üí `NULL`

–í–æ–Ω–∏ –∑–∞–ø–æ–≤–Ω—é—é—Ç—å—Å—è **—Ç—ñ–ª—å–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ**, –∫–æ–ª–∏ –∑–∞–≤–¥–∞–Ω–Ω—è **–≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –∑ —à–∞–±–ª–æ–Ω—É** (—á–µ—Ä–µ–∑ automation).

–¶–µ –û–ö ‚úÖ

---

### üîπ2. –Ø–∫ –æ–¥–Ω–∞ —Ñ–æ—Ä–º–∞ –ø—Ä–∞—Ü—é—î —ñ –¥–ª—è –∑–≤–∏—á–∞–π–Ω–æ–≥–æ, —ñ –¥–ª—è —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è?

–ü—Ä–∞–≤–∏–ª—å–Ω–æ:

- –ù–∞ —Ñ–æ—Ä–º—ñ —î `PXX_TASK_MODE` (–∞–±–æ –ø–µ—Ä–µ–º–∏–∫–∞—á `STANDARD` / `PERIODIC`)
- –ü–æ —Ü—å–æ–º—É –ø–æ–ª—é –≤—ñ–¥–ø—Ä–∞—Ü—å–æ–≤—É—é—Ç—å **2 –æ–∫—Ä–µ–º—ñ –ø—Ä–æ—Ü–µ—Å–∏**, –ø—Ä–∏–≤'—è–∑–∞–Ω—ñ —á–µ—Ä–µ–∑ —É–º–æ–≤—É:
  - `PXX_TASK_MODE = 'STANDARD'` ‚Äî ‚û§ `INSERT INTO TASKS`
  - `PXX_TASK_MODE = 'PERIODIC'` ‚Äî ‚û§ `INSERT INTO TASK_TEMPLATES` + `TASK_TEMPLATE_SUBTASKS`

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è —â–æ–¥–æ –ø–æ–ª—è `IS_PERIODIC`

–î–æ–¥–∞—Ç–∏ **–≤ `TASK_TEMPLATES` –∫–æ–ª–æ–Ω–∫—É `IS_PERIODIC CHAR(1)`** ‚Äì —Ü–µ –≥–∞—Ä–Ω–∞ —ñ–¥–µ—è:

```sql
ALTER TABLE TASK_TEMPLATES ADD IS_PERIODIC CHAR(1) DEFAULT 'Y' CHECK (IS_PERIODIC IN ('Y', 'N'));
```

> –¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å:
> - –ª–µ–≥–∫–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ —Å—Ç–∞–Ω –ø–µ—Ä–µ–º–∏–∫–∞—á–∞ –≤ –∫–∞—Ä—Ç—Ü—ñ;
> - —Ä–æ–∑—à–∏—Ä–∏—Ç–∏ —à–∞–±–ª–æ–Ω–∏ –≤ –º–∞–π–±—É—Ç–Ω—å–æ–º—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, ¬´–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∏–π —à–∞–±–ª–æ–Ω¬ª —á–∏ ¬´—Ä—É—á–Ω–∏–π –∑–∞–ø—É—Å–∫¬ª);
> - –∫—Ä–∞—â–µ —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏.

---

## üõ†Ô∏è PL/SQL –∫–æ–¥ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è

```plsql
DECLARE
  v_template_id TASK_TEMPLATES.ID%TYPE;
BEGIN
  -- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω—É –∑–∞–≤–¥–∞–Ω–Ω—è
  INSERT INTO TASK_TEMPLATES (
    DATE_CREATE,
    TASK_CONTENT,
    CREATOR_ID,
    STATUS_ID,
    DEPARTMENT_ID,
    UNIT_ID,
    TYPE_ID,
    PAGE_LIST_ID,
    PERIOD_MODE,
    PERIOD_INTERVAL,
    PERIOD_TIME,
    HOURLY_TIMES,
    HOURLY_OFFSET_MIN,
    NEXT_RUN_DATE,
    IS_PERIODIC
  )
  VALUES (
    SYSDATE,
    :PXX_TASK_CONTENT,
    :APP_USER_ID,
    1,
    :PXX_DEPARTMENT_ID,
    :PXX_UNIT_ID,
    :PXX_TYPE_ID,
    :PXX_PAGE_LIST_ID,
    :PXX_PERIOD_MODE,
    :PXX_PERIOD_INTERVAL,
    :PXX_PERIOD_TIME,
    :PXX_HOURLY_TIMES,
    :PXX_HOURLY_OFFSET_MIN,
    :PXX_NEXT_RUN_DATE,
    'Y'
  )
  RETURNING ID INTO v_template_id;

  -- –ü—Ä–∏–≤'—è–∑–∫–∞ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å –∑ —á–µ—Ä–Ω–µ—Ç–∫–∏ –¥–æ —à–∞–±–ª–æ–Ω—É
  UPDATE TASK_TEMPLATE_SUBTASKS
  SET TEMPLATE_ID = v_template_id,
      DRAFT_ID = NULL
  WHERE DRAFT_ID = :PXX_DRAFT_ID;

  -- –ó–∞–ø–∞–º‚Äô—è—Ç–∞—Ç–∏ id –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥—É —á–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
  :PXX_CREATED_TEMPLATE_ID := v_template_id;
END;
```

---

## ‚úÖ –Ø–∫ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –ø—Ä–æ—Ü–µ—Å —É APEX

1. **–ü—Ä–æ—Ü–µ—Å 1: "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è"**
   - –¢–∏–ø: PL/SQL
   - Condition: `PXX_TASK_MODE = 'STANDARD'`

2. **–ü—Ä–æ—Ü–µ—Å 2: "–°—Ç–≤–æ—Ä–∏—Ç–∏ —à–∞–±–ª–æ–Ω –ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è"**
   - –¢–∏–ø: PL/SQL
   - Condition: `PXX_TASK_MODE = 'PERIODIC'`

3. –û–±–∏–¥–≤–∞ –ø—Ä–æ—Ü–µ—Å–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ:
   - `PXX_CREATED_TASK_ID`
   - `PXX_CREATED_TEMPLATE_ID`

4. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π —Ü—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç—É –∞–±–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–æ—ó –∫–∞—Ä—Ç–∫–∏.

---

üîß –Ø–∫—â–æ —Ç—Ä–µ–±–∞ ‚Äî —è –º–æ–∂—É:
- –¥–æ–ø–æ–º–æ–≥—Ç–∏ –∑ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–æ—ó –∫–∞—Ä—Ç–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ `IS_PERIODIC`;
- —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∑–≤—ñ—Ç/IR –∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é –ø–æ —à–∞–±–ª–æ–Ω–∞—Ö;
- –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ Automation –Ω–∞ –æ—Å–Ω–æ–≤—ñ `NEXT_RUN_DATE`.

–ì–æ—Ç–æ–≤–∏–π –¥–æ–¥–∞—Ç–∏ `Validation`, —á–∏ –π–¥–µ–º–æ –¥–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —à–∞–±–ª–æ–Ω—É?