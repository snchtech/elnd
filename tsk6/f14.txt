–°—É–ø–µ—Ä! –î–æ–¥–∞—î–º–æ –ø–æ–≤–Ω—É –ª–æ–≥—ñ–∫—É **—Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è** –≤ —Ç—ñ–π —Å–∞–º—ñ–π —Ñ–æ—Ä–º—ñ (`P50`), —â–æ–± –≤–æ–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–ª–∞ —è–∫ **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ**, —Ç–∞–∫ —ñ **—Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ–≥–æ** –∑–∞–≤–¥–∞–Ω–Ω—è, –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º `UPDATE_TASK`.

---

## ‚úÖ –ó–∞–≥–∞–ª—å–Ω–∞ –ª–æ–≥—ñ–∫–∞:
| –î—ñ—è                | –ö–Ω–æ–ø–∫–∞             | REQUEST          | –ö–ª—é—á–æ–≤–∞ —É–º–æ–≤–∞ |
|--------------------|--------------------|------------------|----------------|
| –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è  | `–°—Ç–≤–æ—Ä–∏—Ç–∏`         | `CREATE_TASK`    | `:P50_TASK_ID IS NULL` |
| –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è| `–û–Ω–æ–≤–∏—Ç–∏`          | `UPDATE_TASK`    | `:P50_TASK_ID IS NOT NULL` |

---

## üîß –©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏:

### üîπ 1. –ö–Ω–æ–ø–∫–∞ `"–û–Ω–æ–≤–∏—Ç–∏"` –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è

- **Name**: `BTN_UPDATE_TASK`
- **Label**: `–û–Ω–æ–≤–∏—Ç–∏`
- **Action**: `Submit Page`
- **Button Name**: `UPDATE_TASK`
- **Server Condition** *(—â–æ–± –ø–æ–∫–∞–∑—É–≤–∞–ª–∞—Å—å –ª–∏—à–µ –ø—Ä–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—ñ)*:
  - Type: **PL/SQL Expression**
  - Expression:
    ```plsql
    :P50_TASK_ID IS NOT NULL
    ```

---

### üîπ 2. –ü—Ä–æ—Ü–µ—Å `Update Task` (–æ–Ω–æ–≤–ª—é—î TASK)

- **Name**: `Update Task`
- **Type**: PL/SQL Code
- **Point**: `After Submit`
- **Server-side Condition**:
  - Type: **PL/SQL Expression**
  - Expression:
    ```plsql
    :REQUEST = 'UPDATE_TASK'
    ```

**PL/SQL Code:**
```plsql
UPDATE TASKS
SET 
    TASK_CONTENT = :P50_TASK_CONTENT,
    PLANNING_DATE_START = :P50_PLANNING_DATE_START,
    PLANNING_DATE_END = :P50_PLANNING_DATE_END,
    DEPARTMENT_ID = :G_DEPARTMENT_ID,
    UNIT_ID = :G_UNIT_ID,
    PAGE_LIST_ID = :G_PAGE_LIST_ID,
    NOTE = :P50_NOTE,
    TYPE_ID = :P50_TASK_TYPE,
    IS_GENERATED = :P50_IS_GENERATED,
    GENERATED_DATE = :P50_GENERATED_DATE,
    TEMPLATE_ID = :P50_TEMPLATE_ID
WHERE ID = :P50_TASK_ID;
```

---

### üîπ 3. –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å (—Ç—ñ –∂ –ø—Ä–æ—Ü–µ—Å–∏, –∞–ª–µ –¥–æ–¥–∞—Ç–∏ `UPDATE_TASK` –≤ —É–º–æ–≤—É)

#### üõ†Ô∏è Process: `Update TASK_ID in TASK_SUBTASKS`

```plsql
:REQUEST IN ('CREATE_TASK', 'UPDATE_TASK')
```

#### üõ†Ô∏è Process: `Update PARENT_ID in TASK_SUBTASKS`

```plsql
:REQUEST IN ('CREATE_TASK', 'UPDATE_TASK')
```

#### üõ†Ô∏è Process: `–û—á–∏—Å—Ç–∫–∞ —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö –ø–æ–ª—ñ–≤`

```plsql
:REQUEST IN ('CREATE_TASK', 'UPDATE_TASK')
```

---

### üîπ 4. –ü—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ —Ñ–æ—Ä–º–∏: –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è item-—ñ–≤, —è–∫—â–æ `P50_TASK_ID` –ø–µ—Ä–µ–¥–∞–Ω–æ

**Page Load Dynamic Action**:
- Condition:
  ```plsql
  :P50_TASK_ID IS NOT NULL
  ```
- Action: `Set Value`, `SQL Query`
- SQL (–ø—Ä–∏–∫–ª–∞–¥):
  ```sql
  SELECT 
    TASK_CONTENT,
    PLANNING_DATE_START,
    PLANNING_DATE_END,
    NOTE,
    TYPE_ID,
    IS_GENERATED,
    GENERATED_DATE,
    TEMPLATE_ID
  FROM TASKS
  WHERE ID = :P50_TASK_ID
  ```
- Affected Items: `P50_TASK_CONTENT`, `P50_PLANNING_DATE_START`, ...

---

## üì¶ –¢–µ–ø–µ—Ä —É —Ç–µ–±–µ:

| –ö–Ω–æ–ø–∫–∞         | –£–º–æ–≤–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è         | –î—ñ—è                        |
|----------------|-----------------------------|-----------------------------|
| –°—Ç–≤–æ—Ä–∏—Ç–∏       | `:P50_TASK_ID IS NULL`      | INSERT ‚Üí TASK + SUBTASKS    |
| –û–Ω–æ–≤–∏—Ç–∏        | `:P50_TASK_ID IS NOT NULL`  | UPDATE ‚Üí TASK + SUBTASKS    |

---

üîÅ –Ø–∫—â–æ —Ö–æ—á–µ—à ‚Äî –¥–æ–ø–æ–º–æ–∂—É —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–µ–∂–∏–º—É `P50_MODE := 'edit'/'new'` –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º –µ–ª–µ–º–µ–Ω—Ç—ñ–≤/–∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ —Å—Ç–æ—Ä—ñ–Ω–∫–∏.