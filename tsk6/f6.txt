–ß—É–¥–æ–≤–µ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è ‚Äî –∫–ª–∞—Å–∏—á–Ω–∞ —Å–∏—Ç—É–∞—Ü—ñ—è –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ **—ñ—î—Ä–∞—Ä—Ö—ñ—á–Ω–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ —É IG**, –¥–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è `PARENT_ID` –º–∞—î –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ —ñ–Ω—à–∏–π –∑–∞–ø–∏—Å, —è–∫–∏–π **—â–µ –Ω–µ –º–∞—î ID**, –±–æ –Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π —É –ë–î. –¶–µ –º–æ–∂–Ω–∞ —Ä–æ–∑–≤‚Äô—è–∑–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **—Ç–∏–º—á–∞—Å–æ–≤–∏—Ö –ª–æ–∫–∞–ª—å–Ω–∏—Ö ID** –Ω–∞ —Ä—ñ–≤–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞ (IG model) –¥–æ –º–æ–º–µ–Ω—Ç—É –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.

---

## ‚úÖ –ó–∞–≥–∞–ª—å–Ω–∞ —ñ–¥–µ—è:

1. **–ù–∞ –∫–ª—ñ—î–Ω—Ç—ñ** (–≤ APEX IG) –∫–æ–∂–µ–Ω –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫ –æ—Ç—Ä–∏–º—É—î **–≤–ª–∞—Å–Ω–∏–π ‚Äúrow id‚Äù** ‚Äî —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π `modelId`.
2. –ú–∏ –¥–æ–¥–∞—î–º–æ –ø—Ä–∏—Ö–æ–≤–∞–Ω—É –∫–æ–ª–æ–Ω–∫—É `TEMP_ROW_ID`, —è–∫–∞ –∑–±–µ—Ä—ñ–≥–∞—î —Ü–µ–π `modelId`.
3. `PARENT_ID` –Ω–∞ –∫–ª—ñ—î–Ω—Ç—ñ –≤–∫–∞–∑—É—î –Ω–∞ `TEMP_ROW_ID`, –∞ **–ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ** ‚Äî –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –Ω–∞ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π `ID`.

---

## üîß –Ø–∫ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏:

### 1. –î–æ–¥–∞–π —É IG –∫–æ–ª–æ–Ω–∫—É `TEMP_ROW_ID`:
- –¢–∏–ø: **Hidden**
- –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: –ø–æ—Ä–æ–∂–Ω—ñ–π
- –ó–∞–¥–∞—á–∞ ‚Äî –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –Ω–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∑–∞–ø–æ–≤–Ω–∏—Ç–∏ —ó—ó —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º.

### 2. –ü—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –Ω–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –≥–µ–Ω–µ—Ä—É–π `TEMP_ROW_ID` (JS)

–£ –∫–Ω–æ–ø—Ü—ñ "–î–æ–¥–∞—Ç–∏ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è" –¥–æ–¥–∞–π —É `Execute JavaScript`:
```js
var ig$ = apex.region("subtask_ig").call("getViews", "grid");
var model = ig$.model;

var newRec = model.createRecord();
var tempId = "temp_" + new Date().getTime();

model.setValue(newRec, "TEMP_ROW_ID", tempId);
model.setValue(newRec, "SUBTASK_CONTENT", "");
model.setValue(newRec, "PLANNING_DATE_END", null);
model.addRecord(newRec);
```

---

### 3. LOV –¥–ª—è `PARENT_ID` ‚Üí –ø—Ä–∞—Ü—é—î –∑ `TEMP_ROW_ID`

LOV SQL –¥–ª—è `PARENT_ID` —É IG:
```sql
SELECT 
  TO_CHAR(SUBTASK_ROW_NUM) AS display_value,
  TEMP_ROW_ID AS return_value
FROM (
  SELECT ROWNUM AS SUBTASK_ROW_NUM,
         NVL(TEMP_ROW_ID, TO_CHAR(ID)) AS TEMP_ROW_ID
  FROM TASK_SUBTASKS
  WHERE TASK_ID = :P50_TASK_ID
)
ORDER BY SUBTASK_ROW_NUM
```

> –¢—É—Ç `TEMP_ROW_ID` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —ñ –¥–ª—è –≤–∂–µ —ñ—Å–Ω—É—é—á–∏—Ö (—è–∫ `ID`), —ñ –¥–ª—è –Ω–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤.

---

### 4. –ü–µ—Ä–µ–¥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º —É –ë–î ‚Üí –∑–∞–º—ñ–Ω–∏—Ç–∏ `PARENT_ID`

–£ –ø—Ä–æ—Ü–µ—Å—ñ `BEFORE INSERT` –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ:
- –ü—ñ—Å–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö –∑–∞–ø–∏—Å—ñ–≤ –ø–æ—Ç—Ä—ñ–±–Ω–æ **–ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ `PARENT_ID`**, —è–∫—ñ —â–µ –º—ñ—Å—Ç—è—Ç—å `TEMP_ROW_ID`, –Ω–∞ —Å–ø—Ä–∞–≤–∂–Ω—ñ `ID`.

–¶–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –≤:
- `AFTER SUBMIT` –ø—Ä–æ—Ü–µ—Å—ñ,
- –∞–±–æ —á–µ—Ä–µ–∑ `INSERT AFTER EACH ROW` –∑ –ª–æ–≥—ñ–∫–æ—é –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è.

–ê–ª–µ –Ω–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ –Ω–∞–π–∫—Ä–∞—â–µ:
- **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ç–∏–º—á–∞—Å–æ–≤—É —Ç–∞–±–ª–∏—Ü—é**, –∞–±–æ
- –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ `PARENT_TEMP_ID` –≤ –æ–∫—Ä–µ–º—É –∫–æ–ª–æ–Ω–∫—É, —ñ –ø—ñ—Å–ª—è –≤—Å—Ç–∞–≤–∫–∏ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å ‚Äî –æ–∫—Ä–µ–º–∏–º `UPDATE` –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ `PARENT_ID`, –∑—ñ—Å—Ç–∞–≤–∏–≤—à–∏ `TEMP_ID` —Ç–∞ –Ω–æ–≤—ñ `ID`.

---

## üîÅ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:

–Ø–∫—â–æ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å –Ω–µ–±–∞–≥–∞—Ç–æ ‚Äî –º–æ–∂–µ—à –ø—Ä–æ—Å—Ç–æ **–≤—Å—Ç–∞–≤–∏—Ç–∏ –≤—Å—ñ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è**, –ø–æ—Ç—ñ–º –æ–¥–Ω–∏–º `MERGE/UPDATE` –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ `PARENT_ID`:

```sql
UPDATE TASK_SUBTASKS t
SET PARENT_ID = (
  SELECT t2.ID
  FROM TASK_SUBTASKS t2
  WHERE t2.TASK_ID = t.TASK_ID
    AND t2.TEMP_ROW_ID = t.PARENT_TEMP_ID
)
WHERE t.PARENT_TEMP_ID IS NOT NULL;
```

---

## ‚úÖ –ü—ñ–¥—Å—É–º–æ–∫:

| –ü–æ–ª–µ            | –û–ø–∏—Å                                 |
|------------------|----------------------------------------|
| `TEMP_ROW_ID`     | –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID –¥–ª—è –∑–∞–ø–∏—Å—É –≤ IG         |
| `PARENT_ID`       | –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ `TEMP_ROW_ID`            |
| `PARENT_TEMP_ID`  | –û–ø—Ü—ñ–π–Ω–æ ‚Äî –æ–∫—Ä–µ–º–∞ –∫–æ–ª–æ–Ω–∫–∞, —è–∫—â–æ —Ö–æ—á–µ—à  |
| `ID`              | –°–ø—Ä–∞–≤–∂–Ω—ñ–π ID (–ø—ñ—Å–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è)       |

---

üîß –•–æ—á–µ—à ‚Äî –º–æ–∂—É –¥–æ–ø–æ–º–æ–≥—Ç–∏ –∑—Ä–æ–±–∏—Ç–∏ `INSERT`/`UPDATE` –ª–æ–≥—ñ–∫—É –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ—ó —á–∞—Å—Ç–∏–Ω–∏ (PL/SQL –∞–±–æ –ø—Ä–æ—Ü–µ—Å –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è). –ü—Ä–æ–¥–æ–≤–∂—É—î–º–æ?