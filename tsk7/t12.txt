–ß—É–¥–æ–≤–æ, —â–æ —Ç–∏ –Ω–∞–≤–æ–¥–∏—à –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –∫–æ–¥ üôå ‚Äî –ø–æ–º–∏–ª–∫–∞ `Cannot read property toString() of null` —É —Ç–≤–æ—î–º—É –≤–∏–ø–∞–¥–∫—É –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ **–º–µ—Ç–æ–¥ `getRecord(...)` –ø–æ–≤–µ—Ä—Ç–∞—î `null`**, —Ç–æ–±—Ç–æ **—Ä—è–¥–æ–∫ —É IG –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ** –∞–±–æ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∏–π.

---

## üîç –ü—Ä–∏—á–∏–Ω–∞ –ø–æ–º–∏–ª–∫–∏:

```js
.model.getRecord(...).setValue(...)
```

‚û°Ô∏è –Ø–∫—â–æ `getRecord(...)` –ø–æ–≤–µ—Ä—Ç–∞—î `null`, —Ç–æ –¥–∞–ª—ñ –π–¥–µ `null.setValue(...)`, —ñ –≤–∏–Ω–∏–∫–∞—î —Ç–≤–æ—è –ø–æ–º–∏–ª–∫–∞.

---

## ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è: –Ω–∞–¥—ñ–π–Ω–æ –∑–Ω–∞–π—Ç–∏ **–∞–∫—Ç–∏–≤–Ω–∏–π –∑–∞–ø–∏—Å** –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `TEMP_ROW_ID`

---

### üîß –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π —Å–ø–æ—Å—ñ–±: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `TEMP_ROW_ID`, —è–∫–∏–π —Ç–∏ –∑–±–µ—Ä—ñ–≥–∞—î—à —É Hidden Item, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `P50_CURRENT_TEMP_ID`

### 1. –ü—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞:

```js
const tempId = model.getValue(record, "TEMP_ROW_ID");
$s("P50_CURRENT_TEMP_ID", tempId);
```

---

### 2. –ü–æ—Ç—ñ–º –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ "–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏":

```js
const textValue = $v("P50_SUBTASK_TEXT_EDIT");
const tempId = $v("P50_CURRENT_TEMP_ID");

const ig$ = apex.region("ig_subtasks").call("getViews", "grid");
const model = ig$.model;

const record = model.getRecords().find(r => model.getValue(r, "TEMP_ROW_ID") === tempId);

if (record) {
  model.setValue(record, "SUBTASK_CONTENT", textValue);
} else {
  apex.message.alert("–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è.");
}

apex.region("SUBTASK_POPUP").hide();
```

---

### üîÅ –Ø–∫—â–æ —Ö–æ—á–µ—à –∑–∞–ª–∏—à–∏—Ç–∏—Å—è –∑ `.is-active` ‚Äî –æ—Å—å –±–µ–∑–ø–µ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:

```js
const grid = apex.region("ig_subtasks").call("getViews", "grid");
const model = grid.model;
const activeId = grid.view$.find(".is-active").first().data("id");

const record = activeId ? model.getRecord(activeId) : null;

if (record) {
  const textValue = $v("P50_SUBTASK_TEXT_EDIT");
  model.setValue(record, "SUBTASK_CONTENT", textValue);
  apex.region("SUBTASK_POPUP").hide();
} else {
  apex.message.alert("–ù–µ –≤–∏–±—Ä–∞–Ω–æ –∞–∫—Ç–∏–≤–Ω–∏–π –∑–∞–ø–∏—Å —É —Å—ñ—Ç—Ü—ñ.");
}
```

---

## üìå –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥:

| –í–∞—Ä—ñ–∞–Ω—Ç        | –°—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å | –ü—Ä–∏–º—ñ—Ç–∫–∞                              |
|----------------|--------------|----------------------------------------|
| `TEMP_ROW_ID`  | ‚úÖ –ù–∞–¥—ñ–π–Ω–æ    | –ü—Ä–∞—Ü—é—î —ñ –¥–ª—è –Ω–æ–≤–∏—Ö, —ñ –¥–ª—è —ñ—Å–Ω—É—é—á–∏—Ö     |
| `.is-active`   | ‚ö† –û–±–º–µ–∂–µ–Ω–æ   | –ü—Ä–∞—Ü—é—î –ª–∏—à–µ —è–∫—â–æ —Ä—è–¥–æ–∫ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∏–π     |
| `.apex.selected`| ‚ö† –ß–∞—Å—Ç–∫–æ–≤–æ  | –î–ª—è –º–∞—Å–æ–≤–∏—Ö –≤–∏–¥—ñ–ª–µ–Ω—å, –Ω–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å —Ç—É—Ç |

---

üîÅ –Ø–∫—â–æ —Ö–æ—á–µ—à ‚Äî —è –º–æ–∂—É –ø–æ–∫–∞–∑–∞—Ç–∏, —è–∫ –≤—Å—Ç–∞–≤–∏—Ç–∏ `data-temp-id` –ø—Ä—è–º–æ –≤ `span`, —è–∫—â–æ —Ç–∏ —Ä–µ–Ω–¥–µ—Ä–∏—à –∫–æ–Ω—Ç–µ–Ω—Ç —á–µ—Ä–µ–∑ SQL HTML. –ì–æ—Ç–æ–≤–æ?