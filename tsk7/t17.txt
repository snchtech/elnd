üîß –ß—É–¥–æ–≤–æ! –ó–∞—Ä–∞–∑ —è –ø–æ–∫–∞–∂—É **—è–∫ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≤ APEX —Ç—Ä–∏ –æ–∫—Ä–µ–º—ñ —Å–µ—Ä–≤–µ—Ä–Ω—ñ –ø—Ä–æ—Ü–µ—Å–∏ (Server Processes)** –¥–ª—è:

1. üîÅ –û–Ω–æ–≤–ª–µ–Ω–Ω—è `TASK_ID` —É –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è—Ö
2. üß≠ –û–Ω–æ–≤–ª–µ–Ω–Ω—è `PARENT_ID` —á–µ—Ä–µ–∑ `PARENT_TEMP_ID`
3. üßπ –û—á–∏—â–µ–Ω–Ω—è —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö –ø–æ–ª—ñ–≤ (`DRAFT_ID`, `TEMP_ROW_ID`, `PARENT_TEMP_ID`)

–ê —Ç–∞–∫–æ–∂ –ø–æ—è—Å–Ω—é, **—è–∫ —ó—Ö –∑–∞–ø—É—Å–∫–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è –∞–±–æ —à–∞–±–ª–æ–Ω—É**.

---

## ‚úÖ –ü–µ—Ä–µ–¥—É–º–æ–≤–∏

- –£ —Ç–µ–±–µ —î:
  - `P50_TASK_ID` ‚Äî —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –∞–±–æ –æ–Ω–æ–≤–ª–µ–Ω–∏–π `TASK` –∞–±–æ `TEMPLATE`
  - `P50_DRAFT_ID` ‚Äî —á–µ—Ä–Ω–µ—Ç–∫–æ–≤–∏–π ID –¥–ª—è –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å
  - `P50_IS_TEMPLATE` ‚Äî –ø–µ—Ä–µ–º–∏–∫–∞—á, —á–∏ —Ü–µ —à–∞–±–ª–æ–Ω

---

## ‚úÖ –°—Ç–≤–æ—Ä—é—î–º–æ 3 –ø—Ä–æ—Ü–µ—Å–∏ —É Page Designer ‚Üí **Processing**

---

### üü¢ 1. Process: `Update TASK_ID in TASK_SUBTASKS`

| –í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å         | –ó–Ω–∞—á–µ–Ω–Ω—è                       |
|----------------------|--------------------------------|
| **Name**            | `Update TASK_ID`              |
| **Type**            | PL/SQL                        |
| **Point**           | `After Submit`                |
| **Condition**       | PL/SQL Expression             |
| **Condition Value** |
```plsql
:REQUEST IN ('CREATE_TASK', 'UPDATE_TASK') 
AND :P50_IS_TEMPLATE = 'N'
```

**PL/SQL Code:**
```plsql
UPDATE TASK_SUBTASKS
SET TASK_ID = :P50_TASK_ID
WHERE DRAFT_ID = :P50_DRAFT_ID
  AND TASK_ID IS NULL;
```

---

### üü¢ 2. Process: `Update PARENT_ID in TASK_SUBTASKS`

| –í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å         | –ó–Ω–∞—á–µ–Ω–Ω—è                      |
|----------------------|-------------------------------|
| **Name**            | `Update PARENT_ID`           |
| **Type**            | PL/SQL                       |
| **Point**           | `After Submit`               |
| **Condition**       | PL/SQL Expression            |
| **Condition Value** |
```plsql
:REQUEST IN ('CREATE_TASK', 'UPDATE_TASK') 
AND :P50_IS_TEMPLATE = 'N'
```

**PL/SQL Code:**
```plsql
MERGE INTO TASK_SUBTASKS t
USING (
  SELECT
    child.ID AS CHILD_ID,
    parent.ID AS TRUE_PARENT_ID
  FROM TASK_SUBTASKS child
  JOIN TASK_SUBTASKS parent
    ON child.PARENT_TEMP_ID = parent.TEMP_ROW_ID
   AND child.DRAFT_ID = parent.DRAFT_ID
  WHERE child.DRAFT_ID = :P50_DRAFT_ID
) mapping
ON (t.ID = mapping.CHILD_ID)
WHEN MATCHED THEN
  UPDATE SET t.PARENT_ID = mapping.TRUE_PARENT_ID;
```

---

### üü¢ 3. Process: `Clear TEMP fields in TASK_SUBTASKS`

| –í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å         | –ó–Ω–∞—á–µ–Ω–Ω—è                      |
|----------------------|-------------------------------|
| **Name**            | `Clear TEMP fields`          |
| **Type**            | PL/SQL                       |
| **Point**           | `After Submit`               |
| **Condition**       | PL/SQL Expression            |
| **Condition Value** |
```plsql
:REQUEST IN ('CREATE_TASK', 'UPDATE_TASK') 
AND :P50_IS_TEMPLATE = 'N'
```

**PL/SQL Code:**
```plsql
UPDATE TASK_SUBTASKS
SET 
  DRAFT_ID = NULL,
  TEMP_ROW_ID = NULL,
  PARENT_TEMP_ID = NULL
WHERE TASK_ID = :P50_TASK_ID;
```

---

## ‚úÖ –Ø–∫ —Ü—ñ –ø—Ä–æ—Ü–µ—Å–∏ –∑–∞–ø—É—Å–∫–∞—Ç–∏?

1. –£ —Ç–µ–±–µ –≤–∂–µ —î –∫–Ω–æ–ø–∫–∞ **"–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è/—à–∞–±–ª–æ–Ω"**, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:
   - –ö–Ω–æ–ø–∫–∞: `BTN_CREATE_TASK` ‚Üí `Submit Page`
   - **Button Name (Request)**: `CREATE_TASK`

2. –£ –∫–æ–∂–Ω–æ–º—É –ø—Ä–æ—Ü–µ—Å—ñ –º–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ:
   - `:REQUEST = 'CREATE_TASK'` –∞–±–æ `'UPDATE_TASK'`
   - `:P50_IS_TEMPLATE = 'N'` (—â–æ–± –Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç–∏ –¥–ª—è —à–∞–±–ª–æ–Ω—ñ–≤)

> –¢–∞–∫–∏–º —á–∏–Ω–æ–º —Ü—ñ –ø—Ä–æ—Ü–µ—Å–∏ **–∑–∞–ø—É—Å–∫–∞—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –∫–Ω–æ–ø–∫–∏**, —è–∫—â–æ —É–º–æ–≤–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è.

---

## ‚úÖ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–ª—è —à–∞–±–ª–æ–Ω—ñ–≤?

- –ö–æ–ø—ñ—é—î—à —Ü—ñ –∂ –ø—Ä–æ—Ü–µ—Å–∏, –∞–ª–µ:
  - –ó–º—ñ–Ω—é—î—à –Ω–∞–∑–≤–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `Update TEMPLATE_ID`)
  - –¢–∞–±–ª–∏—Ü—è: `TASK_TEMPLATE_SUBTASKS`
  - –£–º–æ–≤–∞: `:P50_IS_TEMPLATE = 'Y'`

---

## üü© –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ:

| –©–æ —Ç–∏ –æ—Ç—Ä–∏–º—É—î—à                     | –ï—Ñ–µ–∫—Ç                                    |
|-------------------------------------|-------------------------------------------|
| –ü–ª–∞–≤–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è `TASK_ID`         | –ü—Ä–∏–≤'—è–∑–∫–∞ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å –¥–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É |
| –ó–∞–º—ñ–Ω–∞ `PARENT_TEMP_ID ‚Üí PARENT_ID`| –ü–æ–±—É–¥–æ–≤–∞ —ñ—î—Ä–∞—Ä—Ö—ñ—ó                         |
| –û—á–∏—Å—Ç–∫–∞ —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö –ø–æ–ª—ñ–≤           | –ù–µ –ª–∏—à–∞—î—Ç—å—Å—è "—Å–º—ñ—Ç—Ç—è" –≤ —Ç–∞–±–ª–∏—Ü—ñ           |

---

üîÅ –•–æ—á–µ—à ‚Äî –º–æ–∂—É –¥–æ–ø–æ–º–æ–≥—Ç–∏ –æ–±‚Äô—î–¥–Ω–∞—Ç–∏ —Ü–µ –≤ —à–∞–±–ª–æ–Ω —ñ–∑ –¥–∏–Ω–∞–º—ñ—á–Ω–æ—é –æ–±—Ä–æ–±–∫–æ—é —ñ –¥–ª—è —à–∞–±–ª–æ–Ω—ñ–≤ (`TEMPLATES`). –ì–æ—Ç–æ–≤–æ?