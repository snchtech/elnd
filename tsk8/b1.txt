–ß—É–¥–æ–≤–æ! üî• –¢–∏ –¥—É–∂–µ —á—ñ—Ç–∫–æ –æ–ø–∏—Å–∞–≤ –∑–∞–¥–∞—á—É.

–î–∞–≤–∞–π –∑—Ä–æ–±–∏–º–æ —Ç–æ–±—ñ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π **Before Header Process**,  
—è–∫–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø–æ–≤–Ω–∏—Ç—å –¥–∞–Ω—ñ —Ñ–æ—Ä–º–∏ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥:

- `P5_TASK_ACTION_MODE` (0 –∞–±–æ 2) ‚Äî –ø–µ—Ä–µ–≥–ª—è–¥ –∞–±–æ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
- `P5_SWITCH` (0 –∞–±–æ 1) ‚Äî –∑–∞–≤–¥–∞–Ω–Ω—è –∞–±–æ —à–∞–±–ª–æ–Ω
- `P5_TASK_ID` ‚Äî ID –∑–∞–ø–∏—Å—É

---

# üìã –Ø–∫–∏–π –±—É–¥–µ –º–µ—Ö–∞–Ω—ñ–∑–º:

1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ `P5_TASK_ACTION_MODE` = 0 –∞–±–æ 2 (–ø–µ—Ä–µ–≥–ª—è–¥ –∞–±–æ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è).
2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ `P5_SWITCH` = 0 (–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ `TASKS`) –∞–±–æ `1` (–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ `TASK_TEMPLATES`).
3. –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `SELECT ... INTO` –≤–∏—Ç—è–≥–Ω—É—Ç–∏ –¥–∞–Ω—ñ —ñ –∑–∞–ø–æ–≤–Ω–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ `Page Items`.

---

# ‚úÖ –ü—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É –ø—Ä–æ—Ü–µ—Å—É (Before Header Process)

```plsql
DECLARE
  -- –ó–º—ñ–Ω–Ω—ñ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
  v_date_create           TASKS.DATE_CREATE%TYPE;
  v_task_content          TASKS.TASK_CONTENT%TYPE;
  v_creator_id            TASKS.CREATOR_ID%TYPE;
  v_planning_date_start   TASKS.PLANNING_DATE_START%TYPE;
  v_planning_date_end     TASKS.PLANNING_DATE_END%TYPE;
  v_status_id             TASKS.STATUS_ID%TYPE;
  v_department_id         TASKS.DEPARTMENT_ID%TYPE;
  v_unit_id               TASKS.UNIT_ID%TYPE;
  v_type_id               TASKS.TYPE_ID%TYPE;
  v_page_list_id          TASKS.PAGE_LIST_ID%TYPE;
  v_is_generated          TASKS.IS_GENERATED%TYPE;
  v_generated_date        TASKS.GENERATED_DATE%TYPE;
  v_template_id           TASKS.TEMPLATE_ID%TYPE;
  v_note                  TASKS.NOTE%TYPE;
  
  v_period_mode           TASK_TEMPLATES.PERIOD_MODE%TYPE;
  v_period_interval       TASK_TEMPLATES.PERIOD_INTERVAL%TYPE;
  v_period_time           TASK_TEMPLATES.PERIOD_TIME%TYPE;
  v_hourly_times          TASK_TEMPLATES.HOURLY_TIMES%TYPE;
  v_next_run_date         TASK_TEMPLATES.NEXT_RUN_DATE%TYPE;
  v_date_end              TASK_TEMPLATES.DATE_END%TYPE;
  
BEGIN
  -- –ü—Ä–∞—Ü—é—î–º–æ —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –∞–±–æ –ø–µ—Ä–µ–≥–ª—è–¥
  IF :P5_TASK_ACTION_MODE IN (0, 2) THEN
  
    IF :P5_SWITCH = 0 THEN
      -- –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –¥–∞–Ω—ñ —ñ–∑ TASKS
      SELECT 
        DATE_CREATE,
        TASK_CONTENT,
        CREATOR_ID,
        PLANNING_DATE_START,
        PLANNING_DATE_END,
        STATUS_ID,
        DEPARTMENT_ID,
        UNIT_ID,
        TYPE_ID,
        PAGE_LIST_ID,
        IS_GENERATED,
        GENERATED_DATE,
        TEMPLATE_ID,
        NOTE
      INTO
        v_date_create,
        v_task_content,
        v_creator_id,
        v_planning_date_start,
        v_planning_date_end,
        v_status_id,
        v_department_id,
        v_unit_id,
        v_type_id,
        v_page_list_id,
        v_is_generated,
        v_generated_date,
        v_template_id,
        v_note
      FROM TASKS
      WHERE ID = :P5_TASK_ID;
      
      -- –ü—Ä–∏—Å–≤–æ—é—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è Page Items
      :P5_DATE_CREATE           := v_date_create;
      :P5_TASK_CONTENT          := v_task_content;
      :P5_CREATOR_ID            := v_creator_id;
      :P5_PLANNING_DATE_START   := v_planning_date_start;
      :P5_PLANNING_DATE_END     := v_planning_date_end;
      :P5_STATUS_ID             := v_status_id;
      :P5_DEPARTMENT_ID         := v_department_id;
      :P5_UNIT_ID               := v_unit_id;
      :P5_TYPE_ID               := v_type_id;
      :P5_PAGE_LIST_ID          := v_page_list_id;
      :P5_IS_GENERATED          := v_is_generated;
      :P5_GENERATED_DATE        := v_generated_date;
      :P5_TEMPLATE_ID           := v_template_id;
      :P5_NOTE                  := v_note;
    
    ELSIF :P5_SWITCH = 1 THEN
      -- –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –¥–∞–Ω—ñ —ñ–∑ TASK_TEMPLATES
      SELECT 
        DATE_CREATE,
        TASK_CONTENT,
        CREATOR_ID,
        STATUS_ID,
        DEPARTMENT_ID,
        UNIT_ID,
        TYPE_ID,
        PAGE_LIST_ID,
        PERIOD_MODE,
        PERIOD_INTERVAL,
        PERIOD_TIME,
        HOURLY_TIMES,
        NEXT_RUN_DATE,
        DATE_END
      INTO
        v_date_create,
        v_task_content,
        v_creator_id,
        v_status_id,
        v_department_id,
        v_unit_id,
        v_type_id,
        v_page_list_id,
        v_period_mode,
        v_period_interval,
        v_period_time,
        v_hourly_times,
        v_next_run_date,
        v_date_end
      FROM TASK_TEMPLATES
      WHERE ID = :P5_TASK_ID;
      
      -- –ü—Ä–∏—Å–≤–æ—é—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è Page Items
      :P5_DATE_CREATE           := v_date_create;
      :P5_TASK_CONTENT          := v_task_content;
      :P5_CREATOR_ID            := v_creator_id;
      :P5_STATUS_ID             := v_status_id;
      :P5_DEPARTMENT_ID         := v_department_id;
      :P5_UNIT_ID               := v_unit_id;
      :P5_TYPE_ID               := v_type_id;
      :P5_PAGE_LIST_ID          := v_page_list_id;
      :P5_PERIOD_MODE           := v_period_mode;
      :P5_PERIOD_INTERVAL       := v_period_interval;
      :P5_PERIOD_TIME           := v_period_time;
      :P5_HOURLY_TIMES          := v_hourly_times;
      :P5_NEXT_RUN_DATE         := v_next_run_date;
      :P5_DATE_END              := v_date_end;
    
    END IF;
    
  END IF;
END;
```

---

# üìà –ö–æ—Ä–æ—Ç–∫–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º:

1. **–Ø–∫—â–æ** `P5_TASK_ACTION_MODE = 0` –∞–±–æ `2`
2. **–¢–æ–¥—ñ**:
   - **–Ø–∫—â–æ** `P5_SWITCH = 0` ‚Üí —Ç—è–≥–Ω–µ–º–æ –¥–∞–Ω—ñ –∑ `TASKS`
   - **–Ø–∫—â–æ** `P5_SWITCH = 1` ‚Üí —Ç—è–≥–Ω–µ–º–æ –¥–∞–Ω—ñ –∑ `TASK_TEMPLATES`
3. –ó–∞–ø–æ–≤–Ω—é—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ Page Items –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ

---

# üìå –ü–æ—Ä–∞–¥–∏:

- –ù–∞–∑–≤–∏ `P5_*` Item –ø–æ–≤–∏–Ω–Ω—ñ —á—ñ—Ç–∫–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ —Ç–æ–º—É, —â–æ —Ç–∏ —Ö–æ—á–µ—à –∑–∞–ø–æ–≤–Ω–∏—Ç–∏.
- –Ø–∫—â–æ —è–∫–∏—Ö–æ—Å—å Item –Ω–µ–º–∞—î –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ ‚Äî –º–æ–∂–Ω–∞ –∞–±–æ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ –ø—Ä–∏—Å–≤–æ—î–Ω–Ω—è, –∞–±–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ü—ñ –ø–æ–ª—è.
- –Ø–∫—â–æ —Ç—Ä–µ–±–∞ ‚Äî –º–æ–∂–Ω–∞ –æ–∫—Ä–µ–º–æ —Ä–æ–±–∏—Ç–∏ `NULL` –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è Item'—ñ–≤, —è–∫–∏—Ö –Ω–µ–º–∞—î –≤ –æ–¥–Ω—ñ–π —ñ–∑ —Ç–∞–±–ª–∏—Ü—å.

---

# ‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞–∫–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É:

| –ü–µ—Ä–µ–≤–∞–≥–∞ | –û–ø–∏—Å |
|----------|------|
| üî• –û–¥–∏–Ω Before Header –ø—Ä–æ—Ü–µ—Å –¥–ª—è –≤—Å—ñ—Ö —Ä–µ–∂–∏–º—ñ–≤ | –ù–µ —Ç—Ä–µ–±–∞ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –æ–∫—Ä–µ–º—ñ –ø—Ä–æ—Ü–µ—Å–∏ –¥–ª—è –∑–∞–≤–¥–∞–Ω–Ω—è —ñ —à–∞–±–ª–æ–Ω–∞ |
| üî• –í—Å–µ –ø—Ä–∞—Ü—é—î –Ω–∞ Page Items –±–µ–∑ –∑–∞–π–≤–∏—Ö refresh | –î–∞–Ω—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ —â–µ –¥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É —Å—Ç–æ—Ä—ñ–Ω–∫–∏ |
| üî• –ü–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è–º –ø–æ–ª—ñ–≤ |

---

# üöÄ –•–æ—á–µ—à ‚Äî —è —â–µ –ø–æ–∫–∞–∂—É, —è–∫ –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ —Ü–µ–π –∫–æ–¥ —Ç—Ä–æ—Ö–∏ –∫–æ—Ä–æ—Ç—à–µ —á–µ—Ä–µ–∑ `CASE` –∞–±–æ `EXECUTE IMMEDIATE`?  
(–ú–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ —â–µ –∞–∫—É—Ä–∞—Ç–Ω—ñ—à–µ –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö —Å–∏—Å—Ç–µ–º.) üöÄ

–°–∫–∞–∑–∞—Ç–∏ "—Ç–∞–∫"? ‚úÖ