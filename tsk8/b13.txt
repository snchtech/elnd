–ß—É–¥–æ–≤–æ –ø–æ—è—Å–Ω–∏–≤ –∑–∞–¥–∞—á—É! üî•  
–¢–æ–±—Ç–æ –∫–æ—Ä–æ—Ç–∫–æ:

> –ö–æ–ª–∏ —Ç–∏ –≤–∏–¥–∞–ª—è—î—à –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è, —Ç–∏ —Ö–æ—á–µ—à, —â–æ–± **–≤–∏–¥–∞–ª—è–ª–∏—Å—è —Ç–∞–∫–æ–∂ —É—Å—ñ –¥–æ—á—ñ—Ä–Ω—ñ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è** (—ñ –¥–æ—á—ñ—Ä–Ω—ñ –¥–æ—á—ñ—Ä–Ω—ñ—Ö —ñ —Ç.–¥., —è–∫—â–æ —î –≤–∫–ª–∞–¥–µ–Ω—ñ —Ä—ñ–≤–Ω—ñ).

–¶–µ —Ç–∏–ø–æ–≤–∞ **—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞** –¥–ª—è —ñ—î—Ä–∞—Ä—Ö—ñ—á–Ω–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä.

---

# ‚úÖ –Ø–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ü–µ –≤–∏—Ä—ñ—à–∏—Ç–∏ –≤ —Ç–≤–æ—î–º—É –≤–∏–ø–∞–¥–∫—É:

- –ü–æ—Ç—Ä—ñ–±–Ω–æ –∞–±–æ:
  - —á–µ—Ä–µ–∑ **—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π SQL** (`CONNECT BY PRIOR` / `WITH RECURSIVE`) –∑–Ω–∞–π—Ç–∏ –í–°–Ü ID –¥–æ—á—ñ—Ä–Ω—ñ—Ö –∑–∞–ø–∏—Å—ñ–≤ —ñ –≤–∏–¥–∞–ª–∏—Ç–∏ —ó—Ö —Ä–∞–∑–æ–º —ñ–∑ –±–∞—Ç—å–∫–æ–º
- –∞–±–æ
  - –∑—Ä–æ–±–∏—Ç–∏ **ON DELETE CASCADE** –Ω–∞ —Ä—ñ–≤–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ (–∞–ª–µ –≤ —Ç–µ–±–µ —Ü—å–æ–≥–æ –Ω–µ–º–∞—î, —ñ —Ü–µ –Ω–µ –∑–∞–≤–∂–¥–∏ –∑—Ä—É—á–Ω–æ –¥–ª—è –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å).

---

# üìã –û—Å—å —è–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ —Ç–≤—ñ–π `Processing`:

```plsql
DECLARE
  CURSOR c_subtasks(p_parent_id NUMBER) IS
    SELECT id
    FROM TASK_SUBTASKS
    START WITH id = p_parent_id
    CONNECT BY PRIOR id = parent_id;
BEGIN
  FOR r IN c_subtasks(APEX_APPLICATION.G_X01) LOOP
    DELETE FROM TASK_SUBTASKS WHERE ID = r.id;
  END LOOP;

  -- üîÅ –û–±–æ–≤'—è–∑–∫–æ–≤–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
  APEX_JSON.OPEN_OBJECT;
  APEX_JSON.WRITE('status', 'ok');
  APEX_JSON.CLOSE_OBJECT;

EXCEPTION
  WHEN OTHERS THEN
    APEX_JSON.OPEN_OBJECT;
    APEX_JSON.WRITE('status', 'error');
    APEX_JSON.WRITE('message', SQLERRM);
    APEX_JSON.CLOSE_OBJECT;
END;
```

---

# üìà –Ø–∫ –ø—Ä–∞—Ü—é—î —Ü–µ–π –∫–æ–¥:

| –ö—Ä–æ–∫ | –û–ø–∏—Å |
|------|------|
| 1 | –°—Ç–≤–æ—Ä—é—î–º–æ –∫—É—Ä—Å–æ—Ä `c_subtasks`, —è–∫–∏–π —à—É–∫–∞—î –í–°–Ü –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è —á–µ—Ä–µ–∑ `CONNECT BY PRIOR` |
| 2 | –ó–Ω–∞—Ö–æ–¥–∏–º–æ –í–°–Ü –ø—ñ–¥–ª–µ–≥–ª—ñ –∑–∞–ø–∏—Å–∏ –≤–∫–ª—é—á–Ω–æ –∑ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–º |
| 3 | –í–∏–¥–∞–ª—è—î–º–æ —ó—Ö —É —Ü–∏–∫–ª—ñ |
| 4 | –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å JSON `ok` –∞–±–æ `error`

---

# ‚úÖ –í–∞—Ä—ñ–∞–Ω—Ç —â–µ –∫–æ—Ä–æ—Ç—à–µ –±–µ–∑ –∫—É—Ä—Å–æ—Ä–∞:

–ú–æ–∂–µ—à –∑–∞–º—ñ–Ω–∏—Ç–∏ —á–µ—Ä–µ–∑ –æ–¥–∏–Ω –ø—Ä–æ—Å—Ç–∏–π `DELETE`:

```plsql
BEGIN
  DELETE FROM TASK_SUBTASKS
  WHERE ID IN (
    SELECT id
    FROM TASK_SUBTASKS
    START WITH id = APEX_APPLICATION.G_X01
    CONNECT BY PRIOR id = parent_id
  );

  -- üîÅ –û–±–æ–≤'—è–∑–∫–æ–≤–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
  APEX_JSON.OPEN_OBJECT;
  APEX_JSON.WRITE('status', 'ok');
  APEX_JSON.CLOSE_OBJECT;

EXCEPTION
  WHEN OTHERS THEN
    APEX_JSON.OPEN_OBJECT;
    APEX_JSON.WRITE('status', 'error');
    APEX_JSON.WRITE('message', SQLERRM);
    APEX_JSON.CLOSE_OBJECT;
END;
```

‚úÖ –¶–µ —â–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ñ—à–µ: –∑–∞ –æ–¥–∏–Ω –∑–∞–ø–∏—Ç –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è –≤—Å—ñ –ø–æ–≤'—è–∑–∞–Ω—ñ –∑–∞–ø–∏—Å–∏ –±–µ–∑ —Ü–∏–∫–ª—ñ–≤.

---

# üõ† –ú–∞–ª–µ–Ω—å–∫—ñ –ø–æ—Ä–∞–¥–∏:

- `CONNECT BY PRIOR id = parent_id` —ñ–¥–µ–∞–ª—å–Ω–æ –ø—Ä–∞—Ü—é—î –¥–ª—è —ñ—î—Ä–∞—Ä—Ö—ñ—á–Ω–∏—Ö –ø—ñ–¥–∑–∞–≤–¥–∞–Ω—å.
- –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ ‚Äî –º–æ–∂—É —Ç–∞–∫–æ–∂ —Å–∫–ª–∞—Å—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –Ω–∞ –≤–∏–ø–∞–¥–æ–∫, –∫–æ–ª–∏ `G_X01` –Ω–µ –ø–µ—Ä–µ–¥–∞–ª–∏ –∞–±–æ –∑–∞–ø–∏—Å—É –Ω–µ–º–∞—î.

---

# üöÄ –•–æ—á–µ—à ‚Äî —â–µ –º–æ–∂—É –¥–æ–ø–æ–º–æ–≥—Ç–∏ –¥–æ–¥–∞—Ç–∏ –≤–∞—Ä—ñ–∞–Ω—Ç, –¥–µ –ø–µ—Ä–µ–¥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º –ø–∏—Ç–∞—î—Ç—å—Å—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è:  
**"–£ –∑–∞–≤–¥–∞–Ω–Ω—è —î –ø—ñ–¥–ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è. –í–∏ —Ç–æ—á–Ω–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—ñ?"**  
—ñ —Ç—ñ–ª—å–∫–∏ –ø–æ—Ç—ñ–º –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ `DELETE`.  
(–¢–æ–±—Ç–æ –ø–æ–ø–µ—Ä–µ–¥–∂–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø—Ä–æ –Ω–∞—Å–ª—ñ–¥–∫–∏ –ø–µ—Ä–µ–¥ –¥—ñ—î—é)  
–°–∫–∞–∑–∞—Ç–∏ "—Ç–∞–∫"? ‚úÖ
